<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>LaTeXソースファイル</title><link rel="stylesheet" type="text/css" href="../style.css" /><meta name="generator" content="DocBook XSL Stylesheets V1.76.1" /><link rel="home" href="index.html" title="Auto Multiple Choice" /><link rel="up" href="index.html" title="Auto Multiple Choice" /><link rel="prev" href="AMC-TXT.html" title="AMC-TXT構文" /><link rel="next" href="graphical-interface.html" title="GUIの使用方法" /></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">LaTeXソースファイル</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="AMC-TXT.html">戻る</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="graphical-interface.html">次へ</a></td></tr></table><hr /></div><div class="sect1" title="LaTeXソースファイル"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="latex"></a>LaTeXソースファイル</h2></div></div></div><p>この節では、LaTeXソースファイルから試験問題をデザインできるようにするためのLaTeXコマンドを説明します。別の形式をソースファイルにする場合は、この節はスキップしてください。選択式試験問題は、<span class="package">automultiplechoice</span>パッケージを用いてLaTeXファイルで記述できます。LaTeXファイルは、<span class="command"><strong>latex</strong></span>コマンドでコンパイルして生成されたdviファイルを表示することで、いつでも確認することができます。</p><p>選択式試験問題用のLaTeXファイルをどのように作ればいいかを簡潔に示すいくつかの例から始めます。それぞれのLaTeXファイルはテンプレートとして用意されているので、これらのテンプレートの一つを用いて選択式試験問題プロジェクトを作ることができます。</p><div class="sect2" title="簡単な例"><div class="titlepage"><div><div><h3 class="title"><a id="idp6169616"></a>簡単な例</h3></div></div></div><p><a id="modeles-simple.tex"></a></p><pre class="programlisting">\documentclass[a4paper]{article}

\usepackage[utf8x]{inputenc}    <a class="co" id="simple.latin1" href="latex.html#simple.latin1.exp"><img src="../images/callouts/1.png" alt="1" border="0" /></a>
\usepackage[T1]{fontenc}

\usepackage[box,completemulti,lang=JA]{automultiplechoice}    <a class="co" id="simple.amc" href="latex.html#simple.amc.exp"><img src="../images/callouts/2.png" alt="2" border="0" /></a>
\begin{document}

\onecopy{10}{    <a class="co" id="simple.exemplaire" href="latex.html#simple.exemplaire.exp"><img src="../images/callouts/3.png" alt="3" border="0" /></a>

%%% 試験問題用紙ヘッダー開始:    <a class="co" id="simple.entete" href="latex.html#simple.entete.exp"><img src="../images/callouts/4.png" alt="4" border="0" /></a>

\noindent{\bf QCM  \hfill TEST}

\vspace*{.5cm}
\begin{minipage}{.4\linewidth}
\centering\large\bf テスト\\ 試験日 2008年1月1日\end{minipage}
\namefield{\fbox{    <a class="co" id="simple.champnom" href="latex.html#simple.champnom.exp"><img src="../images/callouts/5.png" alt="5" border="0" /></a>
                \begin{minipage}{.5\linewidth}
                  氏名:

                  \vspace*{.5cm}\dotfill
                  \vspace*{1mm}
                \end{minipage}
         }}

\begin{center}
試験時間 : 10 分。

  資料の持込みと電子計算機の使用は禁じます。

  \multiSymbole{}の記号のある設問の正解は1個とは限りません。
  0個の場合と複数の場合もあります。

  それ以外の設問には正解が1個だけあります。

  \emph{非常に悪い解答}にはマイナス点がつくことがあります。
\end{center}
\vspace{1ex}

%%% ヘッダー終了

\begin{question}{総理大臣}    <a class="co" id="simple.qr" href="latex.html#simple.qr.exp"><img src="../images/callouts/6.png" alt="6" border="0" /></a>
  次のうち、日本の総理大臣になったことがある人を一人選びなさい。
  \begin{choices}
    \correctchoice{大隈重信}
    \wrongchoice{湯川秀樹}
    \wrongchoice{聖徳太子}
    \wrongchoice{徳川家康}
  \end{choices}
\end{question}

\begin{questionmult}{都道府県}    <a class="co" id="simple.qrmult" href="latex.html#simple.qrmult.exp"><img src="../images/callouts/7.png" alt="7" border="0" /></a>
  次のうち、日本の都道府県はどれか、すべて選びなさい。
  \begin{choices}
    \correctchoice{石川}
    \wrongchoice{山田}
    \correctchoice{宮崎}
  \end{choices}
\end{questionmult}

\clearpage    <a class="co" id="simple.clear" href="latex.html#simple.clear.exp"><img src="../images/callouts/8.png" alt="8" border="0" /></a>

}   <a class="co" id="simple.fin" href="latex.html#simple.fin.exp"><img src="../images/callouts/9.png" alt="9" border="0" /></a>

\end{document}
</pre><p>この例題の解説:</p><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a id="simple.latin1.exp"></a><a href="#simple.latin1"><img src="../images/callouts/1.png" alt="1" border="0" /></a> </p></td><td valign="top" align="left"><p><span class="package">inputenc</span>および<span class="package">fontenc</span>パッケージにより、試験問題の文章にUTF-8エンコーディングを用いることができます。当然、利用したいエンコーディングに合わせて修正することができます。（訳注: 日本語の試験問題において、後述する最近の<span class="command"><strong>platex</strong></span>を使用する場合は、なくてもUTF-8で動作します。）</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a id="simple.amc.exp"></a><a href="#simple.amc"><img src="../images/callouts/2.png" alt="2" border="0" /></a> </p></td><td valign="top" align="left"><p>ここで使われている<span class="package">automultiplechoice</span>パッケージのオプションは、設問が2ページにまたがるのを防ぎ（<code class="option">box</code>）、複数選択問題にどの選択肢も該当しないことを示すもう一つの選択肢を自動追加します（<code class="option">completemulti</code>）。</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a id="simple.exemplaire.exp"></a><a href="#simple.exemplaire"><img src="../images/callouts/3.png" alt="3" border="0" /></a> </p></td><td valign="top" align="left"><p><span class="command"><strong>onecopy</strong></span>コマンドは（異なる）試験問題を必要数（ここでは10）実体化します。LaTeXの環境を用いた代替の構文については<a class="xref" href="latex.html#sec.unecopie" title="試験問題数の記述">「試験問題数の記述」</a>を参照してください。</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a id="simple.entete.exp"></a><a href="#simple.entete"><img src="../images/callouts/4.png" alt="4" border="0" /></a> </p></td><td valign="top" align="left"><p>この行以降は、試験問題用紙のヘッダーを記述します。</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a id="simple.champnom.exp"></a><a href="#simple.champnom"><img src="../images/callouts/5.png" alt="5" border="0" /></a> </p></td><td valign="top" align="left"><p><span class="command"><strong>namefield</strong></span>コマンドは受験者が氏名を記入する欄を指定します。</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a id="simple.qr.exp"></a><a href="#simple.qr"><img src="../images/callouts/6.png" alt="6" border="0" /></a> </p></td><td valign="top" align="left"><p><span class="command"><strong>question</strong></span>および<span class="command"><strong>choices</strong></span>環境は、単一の正解のある選択式問題を作成します。固有の識別名（ここでは<span class="emphasis"><em>総理大臣</em></span>）を指定する必要があります。</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a id="simple.qrmult.exp"></a><a href="#simple.qrmult"><img src="../images/callouts/7.png" alt="7" border="0" /></a> </p></td><td valign="top" align="left"><p><span class="command"><strong>questionmult</strong></span>および<span class="command"><strong>choices</strong></span>環境は、任意個数の正解のある選択式問題を作成します。受験者は、正解と思われるすべてのボックスにマークするか、（6行目のパッケージ読込みでの<code class="option">completemulti</code>オプションで自動的に追加された）最後のボックスにマークすることになります。</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a id="simple.clear.exp"></a><a href="#simple.clear"><img src="../images/callouts/8.png" alt="8" border="0" /></a> </p></td><td valign="top" align="left"><p><span class="command"><strong>clearpage</strong></span>は試験問題の次の実体を次のページから開始させるのに用います。
            </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a id="simple.fin.exp"></a><a href="#simple.fin"><img src="../images/callouts/9.png" alt="9" border="0" /></a> </p></td><td valign="top" align="left"><p>（9行目で始まった）<span class="command"><strong>onecopy</strong></span>コマンドの終わりを表します。</p></td></tr></table></div></div><div class="sect2" title="設問グループとシャフルの例"><div class="titlepage"><div><div><h3 class="title"><a id="idp6202800"></a>設問グループとシャフルの例</h3></div></div></div><p>この例では、設問の順序は試験問題の実体ごとに変えたいけれど、同じ分野の設問どうしはいっしょにまとめておきたい場合を考えます。この目的のためには、設問グループを二つ作成し、各グループ内で設問をランダムにシャフルします。</p><p><a id="modeles-groups.tex"></a></p><pre class="programlisting">\documentclass[a4paper]{article}

\usepackage[box,completemulti,lang=JA]{automultiplechoice}
\begin{document}

%%% グループの準備

\element{地理}{
  \begin{question}{パリ}
    パリはどの大陸にありますか？
    \begin{choices}
      \correctchoice{ヨーロッパ}
      \wrongchoice{アフリカ}
      \wrongchoice{アジア}
      \wrongchoice{火星}
    \end{choices}
  \end{question}
}

\element{地理}{
  \begin{question}{カメルーン}
    カメルーンの首都はどれですか？
    \begin{choices}
      \correctchoice{ヤウンデ}
      \wrongchoice{ドゥアラ}
      \wrongchoice{アブダビ}
    \end{choices}
  \end{question}
}

\element{歴史}{
  \begin{question}{応仁}
    応仁の乱はいつ始まりましたか？
    \begin{choiceshoriz}
      \correctchoice{1467年}
      \wrongchoice{1967年}
      \wrongchoice{1419年}
    \end{choiceshoriz}
  \end{question}
}

\element{歴史}{
  \begin{questionmult}{Nantes}
    \emph{ナントの勅令}について正しいのはどれですか？
    \begin{choices}
      \correctchoice{1598年に発布された}
      \correctchoice{ルイ14世により破棄された}
      \wrongchoice{ヘンリ2世により発布された}
    \end{choices}
  \end{questionmult}
}

%%% copies

\onecopy{10}{

%%% 試験問題用紙ヘッダー開始:

\noindent{\bf QCM  \hfill TEST}

\vspace*{.5cm}
\begin{minipage}{.4\linewidth}
  \centering\large\bf 歴史と地理\\ 試験日 2008年1月1日
\end{minipage}
\namefield{\fbox{\begin{minipage}{.5\linewidth}
氏名::

\vspace*{.5cm}\dotfill
\vspace*{1mm}
\end{minipage}}}

%%% ヘッダー終了

\begin{center}
  \hrule\vspace{2mm}
  \bf\Large 地理
  \vspace{1mm}\hrule
\end{center}

\shufflegroup{地理}
\insertgroup{地理}

\begin{center}
  \hrule\vspace{2mm}
  \bf\Large 歴史
  \vspace{2mm}\hrule
\end{center}

\shufflegroup{歴史}
\insertgroup{歴史}

\clearpage

}

\end{document}
</pre></div><div class="sect2" title="別紙答案用紙を用いた例"><div class="titlepage"><div><div><h3 class="title"><a id="secensemble"></a>別紙答案用紙を用いた例</h3></div></div></div><p>この例では、マーク用のボックスをすべて別紙に集めて配置したい場合を考えます。こうすれば、不正行為はさらに難しくなり、また重要なのは、受験者一人につき用紙を1枚だけスキャンすればいいので、スキャンを手動で行う場合の手間が軽減されます。この例は設問数が少なく1枚に収まるため、このような配置はこの特定の場合ではあまり有用ではないかもしれません。多数の設問でこの配置を利用できるようにこの例を修正するのはおまかせします！</p><p><a id="modeles-separate.tex"></a></p><pre class="programlisting">\documentclass[a4paper]{article}

\usepackage[box,completemulti,separateanswersheet,lang=JA]{automultiplechoice}    <a class="co" id="ensemble.opt" href="latex.html#ensemble.opt.exp"><img src="../images/callouts/1.png" alt="1" border="0" /></a>
\begin{document}

\AMCrandomseed{1237893}

\def\AMCformQuestion#1{\vspace{\AMCformVSpace}\par {\sc 問 #1:} }    <a class="co" id="ensemble.fq" href="latex.html#ensemble.fq.exp"><img src="../images/callouts/2.png" alt="2" border="0" /></a>


\element{general}{
  \begin{question}{総理大臣}
    次のうち、日本の総理大臣になったことがある人を一人選びなさい。
    \begin{choices}
      \correctchoice{大隈重信}
      \wrongchoice{湯川秀樹}
      \wrongchoice{聖徳太子}
      \wrongchoice{徳川家康}
    \end{choices}
  \end{question}
}

\element{general}{
  \begin{questionmult}{都道府県}
    次のうち、日本の都道府県はどれか、すべて選びなさい。
    \begin{choices}
      \correctchoice{石川}
      \wrongchoice{山田}
      \correctchoice{宮崎}
    \end{choices}
  \end{questionmult}
}

\element{general}{
  \begin{question}{EU}
    欧州連合には2009年1月現在、何ヶ国が加盟していますか？
    \begin{choiceshoriz}[o]
      \wrongchoice{15}
      \wrongchoice{21}
      \wrongchoice{25}
      \correctchoice{27}
      \wrongchoice{31}
    \end{choiceshoriz}
  \end{question}
}

\onecopy{5}{    

%%% 試験問題用紙ヘッダー開始:

\noindent{\bf QCM  \hfill TEST}

\vspace*{.5cm}
\begin{minipage}{.4\linewidth}
  \centering\large\bf テスト\\ 試験日 2008年1月1日
\end{minipage}

\begin{center}\em
試験時間 : 10 分。

  資料の持込みと電子計算機の使用は禁じます。

  \multiSymbole{}の記号のある設問の正解は1個とは限りません。
  0個の場合と複数の場合もあります。

  それ以外の設問には正解が1個だけあります。

  \emph{非常に悪い解答}にはマイナス点がつくことがあります。

\end{center}
\vspace{1ex}

%%% ヘッダー終了

\shufflegroup{general}
\insertgroup{general}

\AMCcleardoublepage    <a class="co" id="ensemble.cp" href="latex.html#ensemble.cp.exp"><img src="../images/callouts/3.png" alt="3" border="0" /></a>

\AMCformBegin    <a class="co" id="debut.form" href="latex.html#debut.form.exp"><img src="../images/callouts/4.png" alt="4" border="0" /></a>

%%% 答案用紙ヘッダー開始

{\large\bf Answer sheet:}
\hfill \namefield{\fbox{    <a class="co" id="ensemble.nom" href="latex.html#ensemble.nom.exp"><img src="../images/callouts/5.png" alt="5" border="0" /></a>
    \begin{minipage}{.5\linewidth}
      氏名:
      
      \vspace*{.5cm}\dotfill
      \vspace*{1mm}
    \end{minipage}
  }}

\begin{center}
  \bf\em 解答はこの用紙にのみ行わなければなりません:
  他の用紙に行った解答は無視されます。
\end{center}

%%% 答案用紙ヘッダー終了

\AMCform    <a class="co" id="ensemble.formulaire" href="latex.html#ensemble.formulaire.exp"><img src="../images/callouts/6.png" alt="6" border="0" /></a>

\clearpage    

}  

\end{document}</pre><p>以下の解説により、上の例がより明確になるでしょう:</p><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a id="ensemble.opt.exp"></a><a href="#ensemble.opt"><img src="../images/callouts/1.png" alt="1" border="0" /></a> </p></td><td valign="top" align="left"><p><code class="option">separateanswersheet</code>オプションにより、所望の配置ができるようになります。</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a id="ensemble.fq.exp"></a><a href="#ensemble.fq"><img src="../images/callouts/2.png" alt="2" border="0" /></a> </p></td><td valign="top" align="left"><p>別紙答案用紙上での設問番号の表示方法をこのように変更することができます（この行はなくてもかまいません）。</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a id="ensemble.cp.exp"></a><a href="#ensemble.cp"><img src="../images/callouts/3.png" alt="3" border="0" /></a> </p></td><td valign="top" align="left"><p>この改ページはマーク用ボックスを集めた答案専用の用紙の前に置きます。両面印刷を行う場合は、このページが次の用紙に印刷されるように<span class="command"><strong>\AMCcleardoublepage</strong></span>を使用してください。片面印刷の場合は、単純に<span class="command"><strong>\clearpage</strong></span>が使えます。</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a id="debut.form.exp"></a><a href="#debut.form"><img src="../images/callouts/4.png" alt="4" border="0" /></a> </p></td><td valign="top" align="left"><p>このコマンドは答案用紙部の開始を示します。答案用紙側にしか現れない設問（例えば<span class="command"><strong>AMCcode</strong></span>で生成される擬似的な設問）を適切に扱うために必要です。</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a id="ensemble.nom.exp"></a><a href="#ensemble.nom"><img src="../images/callouts/5.png" alt="5" border="0" /></a> </p></td><td valign="top" align="left"><p>受験者の氏名は答案用紙側に記入しないと意味がありません！</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a id="ensemble.formulaire.exp"></a><a href="#ensemble.formulaire"><img src="../images/callouts/6.png" alt="6" border="0" /></a> </p></td><td valign="top" align="left"><p><span class="command"><strong>AMCform</strong></span>コマンドにより、マーク用ボックスがすべて出力されます。</p></td></tr></table></div><div class="warning" title="警告" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Warning"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[警告]" src="../images/warning.png" /></td><th align="left">警告</th></tr><tr><td align="left" valign="top"><p>別紙答案用紙を用いる場合、アルファベット（あるいは<code class="option">digits</code>オプションを使用した場合は数字。<a class="xref" href="latex.html#sec.package.options" title="パッケージオプション">「パッケージオプション」</a>参照）がマーク用ボックス内に印刷されます。マーク有無を正確に検出するために、受験者にはボックスをしっかり塗りつぶすように（単純にチェックマークだけでは不十分）指示する必要があります。また、マーク判定閾値（マークのあるボックス内での黒ピクセルの割合で定義）を0.5付近に調整する必要があります。</p></td></tr></table></div></div><div class="sect2" title="LaTeXコマンドの説明"><div class="titlepage"><div><div><h3 class="title"><a id="idp6234432"></a>LaTeXコマンドの説明</h3></div></div></div><div class="sect3" title="パッケージオプション"><div class="titlepage"><div><div><h4 class="title"><a id="sec.package.options"></a>パッケージオプション</h4></div></div></div><p><span class="package">automultiplechoice</span>パッケージを使用するには、</p><pre class="programlisting">\usepackage[...]{automultiplechoice}</pre><p>という行を用い、<code class="option">...</code>部分はカンマで区切ったオプションのリストを指定します。指定できるオプションは以下のとおりです:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p><code class="option">lang=<em class="replaceable"><code>XX</code></em></code>: 試験問題の言語を<em class="replaceable"><code>XX</code></em>に設定します。現時点では、DE（ドイツ語）、ES（スペイン語）、FR（フランス語）、IT（イタリア語）、JA（日本語）、NL（オランダ語）のみ指定可能です。<span class="package">automultiplechoice</span>が<code class="option">completemulti</code>オプションで挿入する「該当なし」のような数種類の文字列も翻訳されます。</p></li><li class="listitem"><p><code class="option">box</code>: 各設問をブロックに入れ、改ページで分割されないようにします。</p></li><li class="listitem"><p><code class="option">completemulti</code>: 「該当なし」の選択肢を複数選択問題の最後に自動的に付け足します。これにより、複数選択問題において、解答がされない場合とどの選択肢も該当しないという解答とが区別できるようになります。この動作は、個別の設問において、<span class="command"><strong>questionmult</strong></span>環境の内部で
<span class="command"><strong>\AMCcompleteMulti</strong></span>あるいは<span class="command"><strong>\AMCnoCompleteMulti</strong></span>コマンドを用いることで、強制あるいはキャンセルすることができます。</p></li><li class="listitem"><p><code class="option">noshuffle</code>: 各設問で選択肢を自動シャフルしないようにします。</p></li><li class="listitem"><p><code class="option">answers</code>: 試験問題用紙ではなく、模範解答を生成します。</p></li><li class="listitem"><p><code class="option">separateanswersheet</code>: マーク用ボックスをすべてまとめて試験問題用紙の最後に配置するようにします（通常このオプションは、受験者一人あたり用紙を1枚だけスキャンしたいときに使用します。使用例は<a class="xref" href="latex.html#secensemble" title="別紙答案用紙を用いた例">「別紙答案用紙を用いた例」</a>を参照してください）。</p></li><li class="listitem"><p><code class="option">digits</code>: <code class="option">separateanswersheet</code>オプションを用いる場合に、<code class="option">digits</code>オプションにより選択肢を（デフォルトの）アルファベットではなく数字で識別します。このオプションを用いる場合は選択肢の数が9を越えないように注意する必要があります。</p></li><li class="listitem"><p><code class="option">outsidebox</code>: <code class="option">separateanswersheet</code>を用いる場合に、このオプションによりアルファベット（あるいは数字）を答案用紙のボックスの外側に印刷します。</p></li><li class="listitem"><p><code class="option">insidebox</code>: <code class="option">separateanswersheet</code>を用いない場合に、このオプションによりアルファベット（あるいは数字）を受験者がマークするボックス内に印刷します。</p></li><li class="listitem"><p><code class="option">catalog</code>: 将来の試験で組み合わせて使えるように設問のカタログを作成します。設問は番号ではなく識別名で区別されます。このレイアウトには<span class="command"><strong>\onecopy</strong></span>を使用する必要はありません。</p></li><li class="listitem"><p><code class="option">postcorrect</code>: スキャンデータの解析を終えてから（採点時）、出題者が作成した答案用紙を正解として与えたい場合にこのオプションを用います。詳細は<a class="xref" href="ar01s07.html#postcorrect" title="採点時正解提示">「採点時正解提示」</a>を参照してください。</p></li></ul></div></div><div class="sect3" title="試験問題数の記述"><div class="titlepage"><div><div><h4 class="title"><a id="sec.unecopie"></a>試験問題数の記述</h4></div></div></div><p>試験問題用紙の内容を記述したLaTeXソースコードは<span class="command"><strong>\onecopy</strong></span>コマンドの呼出しに含まれている必要があります。これの最初の引数は生成する実体の部数、2番目が実体を生成するコードです。</p><pre class="programlisting">\onecopy{50}{ ... }</pre><p><span class="package">environ</span>パッケージを<span class="package">automultiplechoice</span>の<span class="emphasis"><em>前</em></span>に読み込んだ場合は、代替構文として<span class="command"><strong>examcopy</strong></span>環境が使用可能で、部数はそのオプションで与えます（デフォルトは5）。</p><pre class="programlisting">\begin{examcopy}[50]
...
\end{examcopy}</pre><div class="note" title="注記" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[注記]" src="../images/note.png" /></td><th align="left">注記</th></tr><tr><td align="left" valign="top"><p><span class="package">environ</span>パッケージは、Ubuntuディストリビューション9.10（Karmic Koala）までで用いられているTeX Live 2007ディストリビューションでは使用できません。</p></td></tr></table></div></div><div class="sect3" title="設問と選択肢"><div class="titlepage"><div><div><h4 class="title"><a id="latex.qr"></a>設問と選択肢</h4></div></div></div><p>単一選択問題（正解が1個）では、次のようなモデルを用います: </p><pre class="programlisting">\begin{question}{識別名}
  ここに問題文...
  \begin{choices}
    \correctchoice{正しい選択肢}
    \wrongchoice{誤った選択肢}
    \wrongchoice{別の誤った選択肢}
  \end{choices}
\end{question}</pre><div class="important" title="重要" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[重要]" src="../images/important.png" /></td><th align="left">重要</th></tr><tr><td align="left" valign="top"><p>各設問には異なる識別名を用いなければなりません。識別名には、数字、アルファベットと、単純な文字（ただし波括弧や角括弧などを除く）が使えます。設問識別名はピリオドとそれに続く数字で終わらないようにしてください。この形式は受験番号記入欄用に予約されています。</p></td></tr></table></div><div class="note" title="注記" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[注記]" src="../images/note.png" /></td><th align="left">注記</th></tr><tr><td align="left" valign="top"><p>各設問の選択肢の数は199個までです。</p></td></tr></table></div><p>特定の設問について選択肢をシャフルせず順序を保つには、<code class="option">choices</code>環境の<code class="option">o</code>オプションを利用することができます。3行目を次のようにしてください:</p><pre class="programlisting">\begin{choices}[o]</pre><p>選択肢を2カラムに配置するには、<span class="package">multicol</span>パッケージを使用できます。</p><pre class="programlisting">\usepackage{multicol}</pre><p>を用いてプリアンブル部（<span class="package">automultiplechoice</span>への参照の直後など）でロードし、以下に示すようにmulticols環境の中にchoices環境を入れてください:</p><pre class="programlisting">  \begin{multicols}{2}
    \begin{choices}
      \correctchoice{正しい選択肢}
      \wrongchoice{誤った選択肢}
      \wrongchoice{別の誤った選択肢}
    \end{choices}
  \end{multicols}</pre><p>選択肢がさらに短い場合、<code class="option">choices</code>環境のかわりに<code class="option">choiceshoriz</code>を用いることで、選択肢を横に並べていくことができます。</p><p>（正解が任意個あるような）複数選択問題には、<code class="option">question</code>環境のかわりに<code class="option">questionmult</code>を使用します。</p><p>どの選択肢を選んだかが成績に無関係な設問には、次の例のように<code class="code">\QuestionIndicative</code>コマンドが使用できます。</p><pre class="programlisting">\begin{question}{難易度}\QuestionIndicative
  \scoring{auto=0,v=-1,e=-2}
  この授業は易しいですか難しいですか？0（非常に難しい）から5（非常に易しい）の範囲で選んでください。
  \begin{choiceshoriz}[o]
    \correctchoice{0}
    \correctchoice{1}
    \correctchoice{2}
    \correctchoice{3}
    \correctchoice{4}
    \correctchoice{5}
  \end{choiceshoriz}
\end{question}</pre></div><div class="sect3" title="選択肢を複数カラムに配置"><div class="titlepage"><div><div><h4 class="title"><a id="idp6281536"></a>選択肢を複数カラムに配置</h4></div></div></div><p>選択肢を複数のカラムに置く（そしてスペースを節約する）には、LaTeXの<span class="package">multicol</span>パッケージを用いて、<code class="option">multicols</code>環境内に<code class="option">choices</code>環境を入れることができます。</p><p>選択肢がカラムの1行におさまらない場合、その一部が次のカラムに分割されてしまうことがあり、これは受験者を混乱させるかもしれません。この現象を避けるには、<span class="command"><strong>\AMCBoxedAnswers</strong></span>コマンドを使用して、各選択肢をボックスに入れてしまうことができます。使用例を示します:</p><pre class="programlisting">\begin{question}{2カラム}
  鳥とは何ですか？
  \begin{multicols}{2}\AMCBoxedAnswers
    \begin{choices}
      \correctchoice{翼をもった動物で、卵を産みます。あらゆる種類の色をもった鳥がいます。}
      \wrongchoice{木製の大きな家具で、多くの場合、家庭用の衣類を保管するのに使われます。}
      \wrongchoice{蒸気で動く機械で、高速に缶を密封することができます。}
    \end{choices}
  \end{multicols}
\end{question}</pre><p>選択肢ブロック間の垂直スペースはパラメータになっており、寸法<em class="parameter"><code>AMCinterBrep</code></em>により変更することができます:</p><pre class="programlisting">\AMCinterBrep=.5ex</pre></div><div class="sect3" title="設問のグループ"><div class="titlepage"><div><div><h4 class="title"><a id="idp6288624"></a>設問のグループ</h4></div></div></div><p>設問をグループに入れることにより、グループ内の設問をシャフルして試験問題の実体ごとに順序を変えることができます。それぞれの設問グループは通常文字によるグループ名をもたなければなりません。</p><p>設問を一つ一つグループに入れるには、次の例のようにします。</p><pre class="programlisting">\element{マイグループ}{
  \begin{question}{簡単}
    では、1足す1はいくつですか？
    \begin{choiceshoriz}
      \correctchoice{2}
      \wrongchoice{0}
      \wrongchoice{3}
    \end{choiceshoriz}
  \end{question}
}</pre><div class="important" title="重要" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[重要]" src="../images/important.png" /></td><th align="left">重要</th></tr><tr><td align="left" valign="top"><p><span class="command"><strong>element</strong></span>を用いたグループの構築は1回しか行ってはいけません。そのため、これらは、試験問題の実体ごとに内容を繰り返す<span class="command"><strong>onecopy</strong></span>コマンドの<span class="emphasis"><em>前に</em></span>置かなければなりません。</p></td></tr></table></div><p>グループを構築すると、<span class="command"><strong>shufflegroup</strong></span>コマンドを次のように用いてグループ内の設問をシャフルすることができます:</p><pre class="programlisting">\shufflegroup{マイグループ}</pre><p>そして、<span class="command"><strong>insertgroup</strong></span>コマンドを次のように用いてグループの内容を試験問題用紙に出力することができます:</p><pre class="programlisting">\insertgroup{マイグループ}</pre><div class="note" title="注記" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[注記]" src="../images/note.png" /></td><th align="left">注記</th></tr><tr><td align="left" valign="top"><p>最後の二つのコマンド（<span class="command"><strong>shufflegroup</strong></span>と<span class="command"><strong>insertgroup</strong></span>）は<span class="command"><strong>onecopy</strong></span>の引数内部で使用されるべきものです。これによって、それぞれの実体化の前にシャフルが行われます。</p></td></tr></table></div><p>設問グループは、次のようなコマンドによって、より細かく操作することができます:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p><code class="code">\insertgroup[n]{マイグループ}</code> は、（オプションのパラメータ<em class="replaceable"><code>n</code></em>を使用することにより）グループ内の最初の<em class="replaceable"><code>n</code></em>要素だけ出力します。</p></li><li class="listitem"><p><code class="code">\cleargroup{マイグループ}</code> は、グループの中身を空にします。</p></li><li class="listitem"><p><code class="code">\copygroup{グループA}{グループB}</code> は、<em class="replaceable"><code>グループA</code></em>の全要素を<em class="replaceable"><code>グループB</code></em>の最後にコピーします。オプション引数<em class="replaceable"><code>n</code></em>を用いると、最初の<em class="replaceable"><code>n</code></em>要素だけコピーされます: <code class="code">\copygroup[n]{グループA}{グループB}</code></p></li></ul></div><p>これらのコマンドを用いれば、例えば次のコードにより、GAグループからランダムに4個、GBグループからランダムに5個、GOグループから全設問を取り出して、それらをシャフルするということができます（<span class="command"><strong>onecopy</strong></span>コマンドの引数内部で使用します）:</p><pre class="programlisting">\cleargroup{all}
\shufflegroup{GA}\copygroup[4]{GA}{all}
\shufflegroup{GB}\copygroup[5]{GB}{all}
\copygroup{GO}{all}
\shufflegroupe{all}
\insertgroup{all}</pre></div><div class="sect3" title="用紙サイズと余白"><div class="titlepage"><div><div><h4 class="title"><a id="idp6309728"></a>用紙サイズと余白</h4></div></div></div><p>LaTeXの<span class="command"><strong>automultiplechoice</strong></span>パッケージは<span class="command"><strong>geometry</strong></span>を用いて余白とページレイアウトを設定しています。その設定を上書きするには、<code class="code">\begin{document}</code>の直前で<span class="command"><strong>\geometry</strong></span>コマンドを用いてください。詳細はgeometryパッケージのドキュメントを参照してください。AMCが設定する初期値は次のとおりです:</p><pre class="programlisting">\geometry{hmargin=3cm,headheight=2cm,headsep=.3cm,footskip=1cm,top=3.5cm,bottom=2.5cm}</pre><p>スペースを広げるために余白を縮めるときは、以下に注意してください:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>四隅のマーカーは完全に印刷されていなければなりません（プリンタの印刷可能範囲により欠けてしまう可能性があります）。</p></li><li class="listitem"><p>四隅のマーカーはスキャン画像上で完全に見えなければなりません（マーカーが用紙の端ぎりぎりのとき、用紙がずれたり傾いたりすると、画像からはみ出してしまいます）。</p></li></ul></div><p><span class="command"><strong>\geometry</strong></span>コマンドの引数リストの一つのオプションとして用紙サイズを設定することもできます。可能な値は、<code class="code">a4paper</code>、<code class="code">a5paper</code>、<code class="code">a6paper</code>, <code class="code">b4paper</code>、<code class="code">b5paper</code>、<code class="code">ansibpaper</code>、<code class="code">ansicpaper</code>、<code class="code">ansidpaper</code>、<code class="code">letterpaper</code>、<code class="code">executivepaper</code>、<code class="code">legalpaper</code>などです。</p><p>用紙サイズが小さいときは、（<code class="code">+1/1/53+</code>のような）目視用の用紙IDの位置を変更したい場合があるかもしれません。これは次のような形式で、<span class="command"><strong>\AMCidsPosition</strong></span>コマンドを用いることでできます:</p><pre class="programlisting">\AMCidsPosition{pos=<em class="replaceable"><code>p</code></em>,width=<em class="replaceable"><code>w</code></em>,height=<em class="replaceable"><code>h</code></em>}</pre><p>ここで、<em class="replaceable"><code>p</code></em>は<code class="code">none</code>、<code class="code">top</code>、<code class="code">side</code>のいずれかで、<em class="replaceable"><code>w</code></em>、<em class="replaceable"><code>h</code></em>はIDを含む（見えない）ボックスの寸法です。デフォルト値は次の値です:</p><pre class="programlisting">\AMCidsPosition{pos=side,width=4cm,height=3ex}</pre><p>最後に、A5用紙のための設定例を示します:</p><pre class="programlisting">\geometry{a5paper,hmargin=1.6cm,top=2.5cm}
\AMCidsPosition{pos=top}</pre></div><div class="sect3" title="マーク用ボックスの外見スタイル"><div class="titlepage"><div><div><h4 class="title"><a id="idp6330224"></a>マーク用ボックスの外見スタイル</h4></div></div></div><p><span class="command"><strong>\AMCboxDimensions</strong></span>コマンドにより、マーク用ボックスの寸法を変えることができます。</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p><code class="option">size</code> はボックスのサイズです。</p></li><li class="listitem"><p><code class="option">rule</code> はボックスの枠の太さです。</p></li><li class="listitem"><p><code class="option">down</code> はボックスをどれだけ下に下げるかを制御します。</p></li></ul></div><p>小さめのボックスを作るには、例えば次のようなコマンドを使ってください:</p><pre class="programlisting">\AMCboxDimensions{size=1.7ex,down=.2ex}</pre><p>パッケージの<code class="option">separateanswersheet</code>オプションを使用しているときは、ボックスのラベルをカスタマイズすることもできます。デフォルトの動作はアルファベットの大文字によるラベルで、<code class="option">digits</code>オプションを用いると数字になります。独自のラベルを用いるには、<span class="command"><strong>\AMCchoiceLabel</strong></span>コマンドを再定義する必要があります。このコマンドは、選択肢を数えるカウンタ名を引数にとります。例えば以下のコードにより、ボックスのラベルにアルファベットの小文字を用いるようになります:</p><pre class="programlisting">\def\AMCchoiceLabel#1{\alph{#1}}</pre><p>別の例として、<span class="package">arabxetex</span>パッケージを使用している場合、以下のコードが便利かもしれません:</p><pre class="programlisting">\def\AMCchoiceLabel#1{\textLR{\Alph{#1}}}</pre><p>さらに、受験者がマークするボックスの色も、次のように設定することもできます:</p><pre class="programlisting">\AMCboxColor{red}</pre><p><code class="code">red</code>は任意の色に置き換えられます（ただし<span class="command"><strong>xcolor</strong></span>パッケージが認識できなければなりません）。例えば、淡緑色にするには次のようにしてください:</p><pre class="programlisting">\definecolor{amcboxcolor}{rgb}{0.67,0.88,0.5}
\AMCboxColor{amcboxcolor}</pre></div><div class="sect3" title="設問の外見スタイル"><div class="titlepage"><div><div><h4 class="title"><a id="idp6344688"></a>設問の外見スタイル</h4></div></div></div><p>LaTeXの<span class="command"><strong>AMCbeginQuestion</strong></span>コマンドを再定義することにより、各設問の外見を変更することができます。デフォルトの定義は次のとおりです:</p><pre class="programlisting">\def\AMCbeginQuestion#1#2{\par\noindent{\bf Question #1} #2\hspace*{1em}}</pre><p>このコマンドに与えられる最初のパラメータは表示する設問の番号です。2番目は複数選択問題の場合に<code class="code">\multiSymbole</code>を含み、それ以外の場合は空です。<code class="code">\multiSymbole</code>コマンドは複数選択問題を他と区別できるようにするためのものであり、これも変更することができます。デフォルトではトランプのクラブ記号です。</p><pre class="programlisting">\def\multiSymbole{$\clubsuit$}</pre><p>最後に、<code class="code">\AMCnumero</code>コマンドにより、次の設問の番号を変更できます。試験問題の各実体化において、最初に</p><pre class="programlisting">\AMCnumero{1}</pre><p>の呼出しが実行されますが、どこで用いてもかまいません。</p><p>選択肢の外見も、<code class="option">choices</code>や<code class="option">choiceshoriz</code>のかわりに<code class="option">choicescustom</code>を用いれば、次の三つのLaTeXマクロを再定義して同様に変更できます:</p><pre class="programlisting">\def\AMCbeginAnswer{}
\def\AMCendAnswer{}
\def\AMCanswer#1#2{#1 #2}
</pre></div><div class="sect3" title="別紙答案用紙方式"><div class="titlepage"><div><div><h4 class="title"><a id="idp6354400"></a>別紙答案用紙方式</h4></div></div></div><p><code class="option">separateanswersheet</code>オプション（<a class="xref" href="latex.html#secensemble" title="別紙答案用紙を用いた例">「別紙答案用紙を用いた例」</a>参照）で生成される別紙答案用紙のレイアウトを変更することも可能です。</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>マーク用ボックスの水平間隔を変更したり、設問間の垂直間隔を変更したりするだけならば、以下の寸法を再定義するだけです:</p><pre class="programlisting">\AMCformHSpace=.3em
\AMCformVSpace=1.2ex
</pre></li><li class="listitem"><p>表示設定をもっと細かく変更したい場合は、各設問と選択肢の開始に使われるコマンドを再定義することができます（以下はデフォルトの定義を示します）:</p><pre class="programlisting">\def\AMCformQuestion#1{\vspace{\AMCformVSpace}\par{\bf Question #1:}}
\def\AMCformAnswer#1{\hspace{\AMCformHSpace} #1}
</pre></li></ol></div><p>これらの定義は、LaTeXファイルの<code class="code">\begin{document}</code>の直後に挿入しなければなりません。</p></div><div class="sect3" title="受験番号取得"><div class="titlepage"><div><div><h4 class="title"><a id="latex.codes"></a>受験番号取得</h4></div></div></div><p>受験番号の取得はLaTeXの<span class="command"><strong>AMCcode</strong></span>コマンドを使用して、受験者に答案用紙上に自分の受験番号を記入してもらうことで、容易に行うことができます。このコマンドの二つの引数は、設問識別名と、番号に用いる桁数です。例えば次のようなヘッダーを用いることができます:</p><pre class="programlisting">{\setlength{\parindent}{0pt}\hspace*{\fill}\AMCcode{受験番号}{8}\hspace*{\fill}
\begin{minipage}[b]{6.5cm}
$\longleftarrow{}$\hspace{0pt plus 1cm} 受験番号を以下にマークし、その下に氏名を記入してください。

\vspace{3ex}

\hfill\namefield{\fbox{    
    \begin{minipage}{.9\linewidth}
      氏名:
      
      \vspace*{.5cm}\dotfill
      
      \vspace*{.5cm}\dotfill
      \vspace*{1mm}
    \end{minipage}
  }}\hfill\vspace{5ex}\end{minipage}\hspace*{\fill}

}
</pre><p><code class="option">separateanswersheet</code>オプションを用いている場合は、
<span class="command"><strong>AMCcode</strong></span>コマンドは<span class="command"><strong>AMCformBegin</strong></span>コマンドの後に置く必要があります。</p><p><span class="command"><strong>\AMCcode</strong></span>の出力は、
長さ<span class="command"><strong>\AMCcodeHspace</strong></span>、<span class="command"><strong>\AMCcodeVspace</strong></span>、<span class="command"><strong>\AMCcodeBoxSep</strong></span>を設定することで変更することができます。それぞれ、ボックス間の水平および垂直の間隔、ボックスとラベルの間隔（ラベルがボックスの外に印刷される場合）です。デフォルト値は次のように設定されています:</p><pre class="programlisting">\AMCcodeHspace=.5em
\AMCcodeVspace=.5em
\AMCcodeBoxSep=.1em</pre><p>水平バージョン<span class="command"><strong>AMCcodeH</strong></span>も使用することができ、桁数が少ない場合に便利です。</p></div><div class="sect3" title="記述式設問"><div class="titlepage"><div><div><h4 class="title"><a id="idp6372272"></a>記述式設問</h4></div></div></div><p>試験問題に記述式設問を加えたい場合があるかもしれません。一つの方法は、そういった設問のマーク用ボックスを採点者用に予約しておくことです。試験実施後、記入された答案を読んで、採点者が評価に該当するボックスにマークをつけます。そして答案をスキャンしてAMCで採点すれば、その点数を得点に組み入れることができます。</p><pre class="programlisting">\begin{question}{記述}
  \emph{インフレーション}の定義を述べよ。
  \AMCOpen{lines=5}{\wrongchoice[W]{誤}\scoring{0}\wrongchoice[P]{部}\scoring{1}\correctchoice[C]{正}\scoring{2}}
\end{question}
</pre><p>この例では、採点用にボックスが3個作成されます。最初の（誤りの「誤」のラベルのついた）ボックスをマークすると、受験者は0点を獲得します。2番目の（部分点の「部」のラベルのついた）ボックスをマークすると、受験者は1点を獲得します。3番目の（正解の「正」のラベルのついた）ボックスをマークすると、受験者は2点を獲得します。</p><p><span class="command"><strong>\AMCOpen</strong></span>の最初の引数はカンマで区切ったオプションです。使用できるオプションは次のとおりです:</p><div class="variablelist"><dl><dt><span class="term">lineup=<em class="replaceable"><code>bool</code></em></span></dt><dd><p><code class="code">true</code>なら、解答欄と採点用ボックスを同じ行に並べます。<code class="code">false</code>（デフォルト）なら、解答欄を枠で囲み、採点用ボックスの下に配置します。</p></dd><dt><span class="term">lines=<em class="replaceable"><code>num</code></em></span></dt><dd><p>解答の行数を設定します。デフォルト値は<code class="code">1</code>です。</p></dd><dt><span class="term">lineheight=<em class="replaceable"><code>dim</code></em></span></dt><dd><p>各行の高さを設定します。デフォルト値は<code class="code">1cm</code>です。</p></dd><dt><span class="term">dots=<em class="replaceable"><code>bool</code></em></span></dt><dd><p><code class="code">true</code>（デフォルト）なら、各行に点線を引きます。</p></dd><dt><span class="term">hspace=<em class="replaceable"><code>dim</code></em></span></dt><dd><p>採点用ボックスの間隔を設定します。</p></dd><dt><span class="term">backgroundcol=<em class="replaceable"><code>color</code></em></span></dt><dd><p>採点領域の背景色を設定します。</p></dd><dt><span class="term">foregroundcol=<em class="replaceable"><code>color</code></em></span></dt><dd><p>採点用ボックスの枠の色を設定します。</p></dd><dt><span class="term">scan=<em class="replaceable"><code>bool</code></em></span></dt><dd><p><code class="code">false</code>なら、採点用ボックスをスキャンしません（これは、この設問のみ手動マーク認識して、受験者がボックスに何を記入しても無視したい場合に便利です）。デフォルトは<code class="code">true</code>です。</p></dd><dt><span class="term">annotate=<em class="replaceable"><code>bool</code></em></span></dt><dd><p><code class="code">false</code>（デフォルト）なら、答案に採点記入する際、ボックスに記号をつけません（素点のみ記入されます）。</p></dd><dt><span class="term">question=<em class="replaceable"><code>text</code></em></span></dt><dd><p>採点者が設問を識別しやすくするための短いテキストを設定します。このテキストは、別紙答案用紙を用いる場合のみ、採点用ボックスの前に記載されます。</p></dd><dt><span class="term">answer=<em class="replaceable"><code>text</code></em></span></dt><dd><p>模範解答用紙の解答欄に記入される短いテキストを設定します。</p></dd><dt><span class="term">width=<em class="replaceable"><code>dim</code></em></span></dt><dd><p><code class="code">lineup=false</code>のときの、解答欄を囲む枠の幅を設定します。デフォルト値は<code class="code">.95\linewidth</code>です。</p></dd><dt><span class="term">framerule=<em class="replaceable"><code>dim</code></em></span></dt><dd><p>解答欄を囲む枠の線幅を設定します。</p></dd><dt><span class="term">framerulecol=<em class="replaceable"><code>color</code></em></span></dt><dd><p>解答欄を囲む枠の色を設定します。</p></dd><dt><span class="term">boxmargin=<em class="replaceable"><code>dim</code></em></span></dt><dd><p>採点用ボックスの周囲の余白を設定します。</p></dd><dt><span class="term">boxframerule=<em class="replaceable"><code>dim</code></em></span></dt><dd><p>採点用ボックスの周囲枠の線幅を設定します。</p></dd><dt><span class="term">boxframerulecol=<em class="replaceable"><code>color</code></em></span></dt><dd><p>採点用ボックスの周囲枠の色を設定します。</p></dd></dl></div><p>これらのパラメータの（試験全体での）デフォルト値は、次のようにして<span class="command"><strong>\AMCopenOpts</strong></span>コマンドで設定できます</p><pre class="programlisting">\AMCopenOpts{boxframerule=2pt,boxframerulecol=red}</pre><p>さらに、<span class="command"><strong>\AMCotextReserved</strong></span>コマンドを次のように再定義すると、受験者にマークしないように指示するテキストを採点領域に書くことができます:</p><pre class="programlisting">\def\AMCotextReserved{\emph{この欄には記入しないこと}}</pre><p>別紙答案用紙を用いている場合は、各設問に付け加えるテキストを次のように定義できます:</p><pre class="programlisting">\def\AMCotextGoto{\par{\bf\emph{解答は別紙答案用紙に記入してください。}}}</pre></div><div class="sect3" title="シャフルパラメータの選択"><div class="titlepage"><div><div><h4 class="title"><a id="idp6418272"></a>シャフルパラメータの選択</h4></div></div></div><p>シャフルの生成に用いる乱数生成器のシードは、以下のコマンドで変更することができます（documentの最初の方で、少なくとも<span class="command"><strong>onecopy</strong></span>コマンドの外で使わなければなりません）:</p><pre class="programlisting">\AMCrandomseed{1527384}</pre><p>割り当てた値（1から4194303までの中から選びます）が変更されると、シャフルが変わります。もちろん、試験問題用紙を印刷した後は、この値を変更してはいけません。</p></div><div class="sect3" title="試験問題内での参照"><div class="titlepage"><div><div><h4 class="title"><a id="idp6421696"></a>試験問題内での参照</h4></div></div></div><p>LaTeXのコマンド<span class="command"><strong>\label</strong></span>、<span class="command"><strong>\ref</strong></span>、<span class="command"><strong>\pageref</strong></span>コマンドを設問や選択肢で用いると、試験問題の実体化ごとに同じ引数で呼び出され、毎回参照する番号が変わるので、問題を起こします。これを解決するには、それぞれ<span class="command"><strong>\AMClabel</strong></span>、<span class="command"><strong>\AMCref</strong></span>、<span class="command"><strong>\AMCpageref</strong></span>を用いてください。これらは、<span class="command"><strong>\label</strong></span>、<span class="command"><strong>\ref</strong></span>、<span class="command"><strong>\pageref</strong></span>を呼び出す前に、引数に実体の番号を付加します。</p><p>また、各実体化の最初に、カウンタを0にリセットする必要があります。一例として、別の用紙にまとめて配置された図への参照を行いたいとき、次のように書けます:</p><pre class="programlisting">\element{動物}{
  \begin{figure}[p]
    \centering
    \includegraphics[width=.6\linewidth]{tiger}
    \caption{とある動物}
    \AMClabel{虎}
  \end{figure}
    
  \begin{question}{tiger}
    図\AMCref{虎}（\AMCpageref{tiger}ページ）の動物は何ですか？
    \begin{choices}
      \correctchoice{トラ}
      \wrongchoice{キリン}
      \wrongchoice{ゾウ}
      \wrongchoice{ネコ}
    \end{choices}
  \end{question}
}</pre><p>そして重要なのは、<span class="command"><strong>\onecopy</strong></span>コマンドの直後に</p><pre class="programlisting">\setcounter{figure}{0}</pre><p>を挿入して、図の番号がどの実体でも1から始まるようにすることです。これを行わないと、実体ごとに番号が増加してしまい、意図した動作ではなくなってしまいます。</p></div><div class="sect3" title="AMCが挿入するテキストのカスタマイズ"><div class="titlepage"><div><div><h4 class="title"><a id="idp6432928"></a>AMCが挿入するテキストのカスタマイズ</h4></div></div></div><p>以下のカスタマイズには<span class="command"><strong>\AMCtext</strong></span>を使用してください:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p><code class="code">\AMCtext{none}{<em class="replaceable"><code>sentence</code></em>}</code> は、<code class="option">completemulti</code>オプションを使用した場合の「該当なし。」（日本語でのデフォルトテキスト）を、与えられた<em class="replaceable"><code>sentence</code></em>に置換します。</p></li><li class="listitem"><p><code class="code">\AMCtext{corrected}{<em class="replaceable"><code>title</code></em>}</code> は、模範解答用紙に表示される「模範解答」（日本語でのデフォルトテキスト）を、与えられた<em class="replaceable"><code>title</code></em>に置換します。</p></li><li class="listitem"><p><code class="code">\AMCtext{catalog}{<em class="replaceable"><code>title</code></em>}</code> は、<code class="option">catalog</code>オプションで生成される設問カタログに表示される「設問カタログ」（日本語でのデフォルトテキスト）を、与えられた<em class="replaceable"><code>title</code></em>に置換します。</p></li><li class="listitem"><p>同様に、以下のようなコマンドも検討できます（2番目の引数は日本語でのデフォルトテキストです）:</p><pre class="programlisting">\AMCtext{draft}{ドラフト}
\AMCtext{message}{試験の実施には、auto-multiple-choiceでコンパイルされた文書を印刷してください。}</pre></li></ul></div></div></div><div class="sect2" title="乱数を用いた数学設問"><div class="titlepage"><div><div><h3 class="title"><a id="idp6443952"></a>乱数を用いた数学設問</h3></div></div></div><div class="sect3" title="fpパッケージの使用"><div class="titlepage"><div><div><h4 class="title"><a id="idp6444592"></a>fpパッケージの使用</h4></div></div></div><p><span class="package">automultiplechoice</span>の前に</p><pre class="programlisting">\usepackage{fp}</pre><p>として<span class="package">fp</span>パッケージを使用すると、乱数データを用いた練習問題を作ることができます。<span class="package">fp</span>パッケージのドキュメントは<a class="ulink" href="http://mirrors.ctan.org/macros/latex/contrib/fp/README" target="_top">http://mirrors.ctan.org/macros/latex/contrib/fp/README</a>にあります。以下では単純な例から見てみます。</p><pre class="programlisting">\begin{question}{加算}
  \FPeval\VQa{trunc(1+random*8,0)}  <a class="co" id="alea.random" href="latex.html#alea.random.exp"><img src="../images/callouts/1.png" alt="1" border="0" /></a>
  \FPeval\VQb{trunc(4+random*5,0)}
  \FPeval\VQsomme{clip(VQa+VQb)}  <a class="co" id="alea.result" href="latex.html#alea.result.exp"><img src="../images/callouts/2.png" alt="2" border="0" /></a>
  \FPeval\VQnonA{clip(VQa+VQb-1)}  <a class="co" id="alea.fausse" href="latex.html#alea.fausse.exp"><img src="../images/callouts/3.png" alt="3" border="0" /></a>
  \FPeval\VQnonB{clip(VQa*VQb)}
  \FPeval\VQnonC{clip(VQa-VQb)}

  \VQa{} と \VQb{} の和はいくつですか？
  \begin{choiceshoriz}
    \correctchoice{\VQsomme}
    \wrongchoice{\VQnonA}
    \wrongchoice{\VQnonB}
    \wrongchoice{\VQnonC}
  \end{choiceshoriz}
\end{question}</pre><p><span class="command"><strong>\FPeval</strong></span>コマンドは計算を実行するのに使います:</p><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a id="alea.random.exp"></a><a href="#alea.random"><img src="../images/callouts/1.png" alt="1" border="0" /></a> </p></td><td valign="top" align="left"><p><span class="command"><strong>random</strong></span>は[0,1]の実数を返すので、このコマンドによりVQaには1から8までの乱数の整数値が設定されます。次の行では、VQbに4から8までの乱数の整数値が設定されます。</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a id="alea.result.exp"></a><a href="#alea.result"><img src="../images/callouts/2.png" alt="2" border="0" /></a> </p></td><td valign="top" align="left"><p>正しい値をVQsomme変数に入れています。</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a id="alea.fausse.exp"></a><a href="#alea.fausse"><img src="../images/callouts/3.png" alt="3" border="0" /></a> </p></td><td valign="top" align="left"><p>誤った値をVQnonA、VQnonB、VQnonCに入れています。</p></td></tr></table></div><p>変数名のVQは他のLaTeXコマンドと干渉しないように選んであります。</p><div class="sect4" title="区間の選択"><div class="titlepage"><div><div><h5 class="title"><a id="latex.intervals"></a>区間の選択</h5></div></div></div><p><span class="command"><strong>automultiplechoice</strong></span>パッケージは、さらに、この種の設問の作成が容易になるように<span class="command"><strong>\AMCIntervals</strong></span>コマンドを定義しています。以下に例を示します:</p><pre class="programlisting">\begin{question}{inf-expo-indep}
  \FPeval\VQa{trunc(2 + random * 4,0)}
  \FPeval\VQb{trunc(6 + random * 5,0)}
  \FPeval\VQr{VQa/(VQa+VQb)}
  
  $X$と$Y$を互いに独立な指数分布に従う乱数変数とし、それぞれのパラメータを\VQa{}と\VQb{}とします。確率 $\mathbb{P}[X&lt;Y]$ は、次のどの区間に属しますか？

  \begin{multicols}{5}
    \begin{choices}[o]
      \AMCIntervals{\VQr}{0}{1}{0.1}  <a class="co" id="choix.intervalles" href="latex.html#choix.intervalles.exp"><img src="../images/callouts/1.png" alt="1" border="0" /></a>
    \end{choices}
  \end{multicols}
\end{question}</pre><p>（訳注: \mathbbを使用するにはamsfontsパッケージが必要です。）</p><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a id="choix.intervalles.exp"></a><a href="#choix.intervalles"><img src="../images/callouts/1.png" alt="1" border="0" /></a> </p></td><td valign="top" align="left"><p>この行は、各区間 [0,0.1[ [0.1,0.2[ ... [0.9,1[ に対応した10個の選択肢を挿入し、正解の選択肢は VQr を含んだ区間であることを指示します。<span class="command"><strong>\AMCIntervals</strong></span>の引数は次のとおりです:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>正解の値</p></li><li class="listitem"><p>最初の区間の左端の値</p></li><li class="listitem"><p>最後の区間の右端の値</p></li><li class="listitem"><p>各区間の長さ</p></li></ol></div></td></tr></table></div><p>区間の書式は、ローカルな（例えば、よくあるのは [a,b[ ではなく [a,b) と書くなどの）慣行に合わせて、<span class="command"><strong>\AMCIntervalFormat</strong></span>コマンドを再定義して変更できます。オリジナルは</p><pre class="programlisting">\def\AMCIntervalFormat#1#2{[#1,\,#2[}</pre><p>と定義されています。</p></div><div class="sect4" title="数値での解答"><div class="titlepage"><div><div><h5 class="title"><a id="latex.numeric"></a>数値での解答</h5></div></div></div><p><span class="command"><strong>\AMCnumericChoices</strong></span>コマンドを用いれば、次の例のように、受験者に数値での解答をマークで記入させることもできます:</p><pre class="programlisting">\begin{questionmultx}{sqrt}
  \FPeval\VQa{trunc(5+random*15,0)}
  \FPeval\VQs{VQa^0.5}
  $\sqrt{\VQa}$ を計算して、小数点以下2桁で丸めよ。

  \AMCnumericChoices{\VQs}{digits=3,decimals=2,sign=true,
                 borderwidth=0pt,backgroundcol=lightgray,approx=5}
\end{questionmultx}</pre><p><code class="code">questionmultx</code>環境に注意してください。この設問は複数のボックスをマークする必要があるので複数選択問題にしなければなりませんが、複数の正解があると言うことはできません。なので複数選択問題の記号を表示しません。</p><p><span class="command"><strong>\AMCnumericChoices</strong></span>コマンドの2番目の引数で用いられるオプションは次のとおりです（<em class="replaceable"><code>bool</code></em>は<code class="code">true</code>か<code class="code">false</code>で、<em class="replaceable"><code>color</code></em>は<span class="command"><strong>xcolor</strong></span>で認識できる色でなければなりません）:</p><div class="variablelist"><dl><dt><span class="term">digits=<em class="replaceable"><code>num</code></em></span></dt><dd><p>は、必要な有効桁数（デフォルトは3）を指定します。</p></dd><dt><span class="term">decimals=<em class="replaceable"><code>num</code></em></span></dt><dd><p>は、小数点以下の桁数（デフォルトは0）を指定します。</p></dd><dt><span class="term">base=<em class="replaceable"><code>num</code></em></span></dt><dd><p>は、数字の基数（進法）（デフォルトは10）を指定します。</p></dd><dt><span class="term">sign=<em class="replaceable"><code>bool</code></em></span></dt><dd><p>は、符号の有無（デフォルトはtrue）を指定します。</p></dd><dt><span class="term">strict=<em class="replaceable"><code>bool</code></em></span></dt><dd><p>が<code class="code">true</code>なら、符号とすべての桁のボックスがマークされなければなりません。<code class="code">false</code>なら、マークしていない桁は0として扱います。デフォルトは<code class="code">false</code>です。</p></dd><dt><span class="term">vertical=<em class="replaceable"><code>bool</code></em></span></dt><dd><p>が<code class="code">true</code>なら、1桁分のボックスを縦に配置します。<code class="code">false</code>（デフォルト）なら、1桁分のボックスを横に配置します。</p></dd><dt><span class="term">reverse=<em class="replaceable"><code>bool</code></em></span></dt><dd><p>が<code class="code">true</code>なら、<code class="code">vertical</code>モードにおいて、大きい数字を上に配置します（デフォルトは<code class="code">true</code>）。</p></dd><dt><span class="term">vhead=<em class="replaceable"><code>bool</code></em></span></dt><dd><p>が<code class="code">true</code>なら、<code class="code">vertical</code>モードにおいて、各桁の上部に<span class="command"><strong>\AMCntextVHead</strong></span>コマンドを使用して作成されるヘッダーを置きます。<span class="command"><strong>\AMCntextVHead</strong></span>はもともと次のように定義されています。</p><pre class="programlisting">\def\AMCntextVHead#1{\emph{b#1}}</pre><p>このデフォルト値は、2進数の桁に番号をつけるのに便利です。</p><p>デフォルト値は<code class="code">false</code>です。</p></dd><dt><span class="term">hspace=<em class="replaceable"><code>space</code></em></span></dt><dd><p>は、ボックス間の水平間隔（デフォルトは<code class="code">.5em</code>）を設定します。</p></dd><dt><span class="term">vspace=<em class="replaceable"><code>space</code></em></span></dt><dd><p>は、ボックス間の垂直間隔（デフォルトは<code class="code">1ex</code>）を設定します。</p></dd><dt><span class="term">borderwidth=<em class="replaceable"><code>space</code></em></span></dt><dd><p>は、全ボックスを囲む枠線の太さ（デフォルトは<code class="code">1mm</code>）を設定します。</p></dd><dt><span class="term">bordercol=<em class="replaceable"><code>color</code></em></span></dt><dd><p>は、枠線の色（デフォルトは<code class="code">lightgray</code>）を設定します。</p></dd><dt><span class="term">backgroundcol=<em class="replaceable"><code>color</code></em></span></dt><dd><p>は、背景色（デフォルトは<code class="code">white</code>）を設定します。</p></dd><dt><span class="term">Tsign=<em class="replaceable"><code>text</code></em></span></dt><dd><p>は、符号をマークするボックスの上に表示するテキスト（デフォルトは空で、<code class="code">\def\AMCntextSign{<em class="replaceable"><code>text</code></em>}</code>で再定義も可能）を設定します。</p></dd><dt><span class="term">Tpoint=<em class="replaceable"><code>text</code></em></span></dt><dd><p>は、小数点のテキストを設定します。デフォルトは<code class="code">\raisebox{1ex}{\bf .}</code>で、<code class="code">\def\AMCdecimalPoint{<em class="replaceable"><code>text</code></em>}</code>で再定義も可能です。</p></dd><dt><span class="term">scoring=<em class="replaceable"><code>bool</code></em></span></dt><dd><p>が<code class="code">true</code>なら、AMCにこの設問の採点基準を指定します。デフォルトは<code class="code">true</code>です。</p></dd><dt><span class="term">scoreexact=<em class="replaceable"><code>num</code></em></span></dt><dd><p>は、正解に対する素点（デフォルトは2）を指定します。</p></dd><dt><span class="term">scoreapprox=<em class="replaceable"><code>num</code></em></span></dt><dd><p>は、<span class="emphasis"><em>近似解</em></span>に対する素点（デフォルトは1）を指定します。</p></dd><dt><span class="term">approx=<em class="replaceable"><code>num</code></em></span></dt><dd><p>は、<span class="emphasis"><em>近似解</em></span>として認めて<code class="code">scoreapprox</code>を与える誤差（正解の整数値（小数点を除いた値）との差）を設定します。</p></dd></dl></div><p><span class="command"><strong>\AMCnumericOpts</strong></span>コマンドを使えば、これらのパラメータに対して、（試験全体用の）デフォルト値を別の値に設定することができます:</p><pre class="programlisting">\AMCnumericOpts{scoreexact=3,borderwidth=2pt}</pre><p>さらに、（<code class="code">separateanswersheet</code>オプションで別紙答案用紙を使用していて）別紙答案用紙の外で<span class="command"><strong>\AMCnumericChoices</strong></span>を用いた設問に付加するテキストを、<span class="command"><strong>\AMCntextGoto</strong></span>コマンドを再定義して設定することができます:</p><pre class="programlisting">\def\AMCntextGoto{\par{\bf\emph{Please code the answer on
                           the separate answer sheet.}}}</pre></div></div><div class="sect3" title="pgf/tikzパッケージの使用"><div class="titlepage"><div><div><h4 class="title"><a id="idp7323408"></a>pgf/tikzパッケージの使用</h4></div></div></div><p>LaTeXの<span class="package">pgf/tikz</span>パッケージ（<a class="ulink" href="http://www.ctan.org/tex-archive/graphics/pgf/base" target="_top">http://www.ctan.org/tex-archive/graphics/pgf/base</a>を参照）は、</p><pre class="programlisting">\usepackage{tikz}</pre><p>とともに利用可能な数学関数を提供します。</p><p>latexを走らせて試験問題をコンパイルするたびに常に同じ結果が得られるよう、最初に乱数シードを設定しなければなりません:</p><pre class="programlisting">\pgfmathsetseed{2056}</pre><div class="sect4" title="単純な計算"><div class="titlepage"><div><div><h5 class="title"><a id="idp7327712"></a>単純な計算</h5></div></div></div><p>これは単純な計算を用いた例です</p><pre class="programlisting">\begin{question}{inverse}
  \pgfmathrandominteger{\x}{1}{50}
       
  $x=\x$ の逆数はいくつですか？

  \begin{choices}
    \correctchoice{\pgfmathparse{1/\x}\pgfmathresult }
    \wrongchoice{\pgfmathparse{1/(\x +1))}\pgfmathresult}
    \wrongchoice{\pgfmathparse{cos(\x)} \pgfmathresult}
    \wrongchoice{\pgfmathparse{\x^(-0.5)}\pgfmathresult}
  \end{choices}
\end{question}
</pre><p><span class="command"><strong>\pgfmathparse</strong></span>コマンドが計算を行い、<span class="command"><strong>\pgfmathresult</strong></span>が結果を出力します。</p><p>出力の書式は、次の例（小数点以下3桁、小数点としてカンマを使用）に示すように、<span class="command"><strong>\pgfmathprintnumber</strong></span>を用いて調整することができます。</p><pre class="programlisting">\begin{question}{inverse3}
  \pgfmathrandominteger{\x}{1}{50}
  \pgfkeys{/pgf/number format/.cd,fixed,fixed zerofill,precision=3,use comma}
  $x=\pgfmathprintnumber{\x}$ の逆数はいくつですか？

  \begin{choices}
    \correctchoice{\pgfmathparse{1/\x}\pgfmathprintnumber{\pgfmathresult}} 
    \wrongchoice{\pgfmathparse{1/(\x +1))} \pgfmathprintnumber{\pgfmathresult}}
    \wrongchoice{\pgfmathparse{cos(\x)} \pgfmathprintnumber{\pgfmathresult}}
    \wrongchoice{\pgfmathparse{\x^(-0.5)} \pgfmathprintnumber{\pgfmathresult}}
  \end{choices}
\end{question}
</pre><div class="note" title="注記" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[注記]" src="../images/note.png" /></td><th align="left">注記</th></tr><tr><td align="left" valign="top"><p><span class="command"><strong>\AMCIntervals</strong></span>コマンドと<span class="command"><strong>\AMCnumericChoices</strong></span>コマンドを使用することもできます（<a class="xref" href="latex.html#latex.intervals" title="区間の選択">「区間の選択」</a>および<a class="xref" href="latex.html#latex.numeric" title="数値での解答">「数値での解答」</a>参照）。</p></td></tr></table></div></div><div class="sect4" title="グラフ"><div class="titlepage"><div><div><h5 class="title"><a id="idp7337488"></a>グラフ</h5></div></div></div><p>tkizパッケージはグラフを（ランダムなものもそうでないものも）作成することもできます。</p><pre class="programlisting">\begin{questionmult}{graph}
  以下にグラフが示された三つの関数を考えます:
  \pgfmathrandominteger{\a}{2}{4}  
  \begin{center}
    \begin{tikzpicture}[domain=0:4]
      \draw[very thin,color=gray] (-0.1,-4.1) grid (3.9,3.9);
      \draw[-&gt;] (-0.2,0) -- (4.2,0) node[right] {$x$};
      \draw[-&gt;] (0,-4.2) -- (0,4.2) node[above] {$f(x)$};
      \draw[color=red] plot (\x,{(1+\a/4)*\x-\a}) node[right] {$f_{1} (x)$};
      \draw[color=blue] plot (\x,{\a*sin(\x r)}) node[right] {$f_{2}(x)$};
      \draw[color=orange] plot (\x,{\a*cos(\x r)}) node[right] {$f_{3}(x)$};
    \end{tikzpicture}
  \end{center}
  以下のうち正しいものはどれですか？
  \begin{choices}
    \pgfmathrandominteger{\x0}{2}{4}  
    \correctchoice{$f_{2}(\x0)$=\pgfmathparse{\a*sin(\x0 r)} \pgfmathprintnumber{\pgfmathresult}.}
    \correctchoice{$f_{3}(\x0)$=\pgfmathparse{\a*cos(\x0 r)} \pgfmathprintnumber{\pgfmathresult}.}
    \wrongchoice{関数 $f_{1}(x)$ は線形関数である。}
  \end{choices}
\end{questionmult}
</pre><p>きれいなグラフを作成するには、<span class="package">pgfplots</span>も有用です。</p><p>pgfmathでは精度が有限なので、"算術オーバーフロー" を考慮に入れる必要があるかもしれません。<span class="package">tikz</span>と<span class="package">pgfplots</span>は、バックエンドに<span class="command"><strong>gnuplot</strong></span>を用いることで、この問題を克服しています。これには、<span class="command"><strong>gnuplot</strong></span>をシステムにインストールし、LaTeXの<code class="option">--shell-escape</code>オプションを用いる必要があります。このためには、AMCの設定ウィンドウで、プロジェクト用のLaTeXエンジンとして "<code class="option">pdflatex --shell-escape</code>" （引用符なし）を設定してください。</p></div></div><div class="sect3" title="LuaLaTeXの使用"><div class="titlepage"><div><div><h4 class="title"><a id="idp7346080"></a>LuaLaTeXの使用</h4></div></div></div><p><span class="command"><strong>lualatex</strong></span>コマンドを用いれば、LaTeX文書内でLUA言語を使用できます。これを用いる場合は、文書はUTF-8でエンコードされている必要があり、<span class="package">inputenc</span>パッケージはロードできません。これに関する情報は <a class="ulink" href="http://www.luatex.org/documentation.html" target="_top">http://www.luatex.org/documentation.html</a> を参照してください。</p><p>LUAのコマンドは、<span class="command"><strong>\directlua</strong></span>の引数として与えます。最も便利なLUA関数は<span class="command"><strong>tex.print</strong></span>で、結果をLaTeXに戻して出力します。</p><p>これも同じように、乱数を用いる場合は、コンパイルごとに同じ結果が得られるように常に乱数シードを固定してください:</p><pre class="programlisting">\directlua{math.randomseed (2048)}</pre><p>これはとても単純なソースファイルです:</p><pre class="programlisting">\documentclass[a4paper]{article}
%\usepackage[utf8x]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[box,completemulti,lang=JA]{automultiplechoice}
\begin{document}

\onecopy{10}{

%%% head

\noindent{\bf QCM  \hfill TEST}

\vspace*{.5cm}
\begin{minipage}{.4\linewidth}
  \centering\large\bf LuaLaTeXサンプル試験
\end{minipage}
\namefield{\fbox{\begin{minipage}{.5\linewidth}
Name :

\vspace*{.5cm}\dotfill
\vspace*{1mm}
\end{minipage}}}

%%%

\directlua{math.randomseed (2048)}
\directlua{a=math.random()}

\begin{question}{平方根}
  \directlua{tex.print(a)}の平方根はいくつですか？

  \begin{choices}
    \correctchoice{\directlua{tex.print(math.sqrt(a))}} 
    \wrongchoice{\directlua{tex.print(math.sqrt(2*a))}} 
    \wrongchoice{\directlua{tex.print(math.sqrt(a*1.001))}} 
  \end{choices}
\end{question}

\clearpage
}

\end{document}      </pre><p>出力の書式調整はluaの関数で行うか、<span class="package">siunitx</span>で行うことができます。</p><div class="note" title="注記" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[注記]" src="../images/note.png" /></td><th align="left">注記</th></tr><tr><td align="left" valign="top"><p><span class="command"><strong>\AMCIntervals</strong></span>コマンドと<span class="command"><strong>\AMCnumericChoices</strong></span>コマンドを使用することもできます（<a class="xref" href="latex.html#latex.intervals" title="区間の選択">「区間の選択」</a>および<a class="xref" href="latex.html#latex.numeric" title="数値での解答">「数値での解答」</a>参照）。</p></td></tr></table></div></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="AMC-TXT.html">戻る</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="graphical-interface.html">次へ</a></td></tr><tr><td width="40%" align="left" valign="top">AMC-TXT構文 </td><td width="20%" align="center"><a accesskey="h" href="index.html">ホーム</a></td><td width="40%" align="right" valign="top"> GUIの使用方法</td></tr></table></div></body></html>
