<?xml version="1.0" encoding="US-ASCII"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta content="text/html; charset=US-ASCII" http-equiv="Content-Type" />

  <title>Class: Asciidoctor::PathResolver</title>

  <link rel="stylesheet" href="../rdoc.css" type="text/css" media="screen" />

  <script src="../js/jquery.js" type="text/javascript" charset="utf-8"></script>
  <script src="../js/thickbox-compressed.js" type="text/javascript" charset="utf-8"></script>
  <script src="../js/quicksearch.js" type="text/javascript" charset="utf-8"></script>
  <script src="../js/darkfish.js" type="text/javascript" charset="utf-8"></script>

</head>
<body id="top" class="class">

  <div id="metadata">
    <div id="home-metadata">
      <div id="home-section" class="section">
        <h3 class="section-header">
          <a href="../index.html">Home</a>
          <a href="../index.html#classes">Classes</a>
          <a href="../index.html#methods">Methods</a>
        </h3>
      </div>
    </div>

    <div id="file-metadata">
      <div id="file-list-section" class="section">
        <h3 class="section-header">In Files</h3>
        <div class="section-body">
          <ul>
          
            <li><a href="../lib/asciidoctor/path_resolver_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
              class="thickbox" title="lib/asciidoctor/path_resolver.rb">lib/asciidoctor/path_resolver.rb</a></li>
          
          </ul>
        </div>
      </div>

      
    </div>

    <div id="class-metadata">
      
      <!-- Parent Class -->
      <div id="parent-class-section" class="section">
        <h3 class="section-header">Parent</h3>
        
        <p class="link">Object</p>
        
      </div>
      

      

      

      
      <!-- Method Quickref -->
      <div id="method-list-section" class="section">
        <h3 class="section-header">Methods</h3>
        <ul class="link-list">
          
          <li><a href="#method-c-new">::new</a></li>
          
          <li><a href="#method-i-expand_path">#expand_path</a></li>
          
          <li><a href="#method-i-is_root-3F">#is_root?</a></li>
          
          <li><a href="#method-i-is_web_root-3F">#is_web_root?</a></li>
          
          <li><a href="#method-i-join_path">#join_path</a></li>
          
          <li><a href="#method-i-partition_path">#partition_path</a></li>
          
          <li><a href="#method-i-posixfy">#posixfy</a></li>
          
          <li><a href="#method-i-system_path">#system_path</a></li>
          
          <li><a href="#method-i-web_path">#web_path</a></li>
          
        </ul>
      </div>
      

      
    </div>

    <div id="project-metadata">
      
      

      <div id="classindex-section" class="section project-section">
        <h3 class="section-header">Class/Module Index
          <span class="search-toggle"><img src="../images/find.png"
            height="16" width="16" alt="[+]"
            title="show/hide quicksearch" /></span></h3>
        <form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
        <fieldset>
          <legend>Quicksearch</legend>
          <input type="text" name="quicksearch" value=""
            class="quicksearch-field" />
        </fieldset>
        </form>

        <ul class="link-list">
        
          <li><a href="../Asciidoctor.html">Asciidoctor</a></li>
        
          <li><a href="../Asciidoctor/AbstractBlock.html">Asciidoctor::AbstractBlock</a></li>
        
          <li><a href="../Asciidoctor/AbstractNode.html">Asciidoctor::AbstractNode</a></li>
        
          <li><a href="../Asciidoctor/AttributeList.html">Asciidoctor::AttributeList</a></li>
        
          <li><a href="../Asciidoctor/BaseTemplate.html">Asciidoctor::BaseTemplate</a></li>
        
          <li><a href="../Asciidoctor/Block.html">Asciidoctor::Block</a></li>
        
          <li><a href="../Asciidoctor/Callouts.html">Asciidoctor::Callouts</a></li>
        
          <li><a href="../Asciidoctor/Cli.html">Asciidoctor::Cli</a></li>
        
          <li><a href="../Asciidoctor/Cli/Invoker.html">Asciidoctor::Cli::Invoker</a></li>
        
          <li><a href="../Asciidoctor/Cli/Options.html">Asciidoctor::Cli::Options</a></li>
        
          <li><a href="../Asciidoctor/Debug.html">Asciidoctor::Debug</a></li>
        
          <li><a href="../Asciidoctor/DocBook45.html">Asciidoctor::DocBook45</a></li>
        
          <li><a href="../Asciidoctor/DocBook45/BlockAdmonitionTemplate.html">Asciidoctor::DocBook45::BlockAdmonitionTemplate</a></li>
        
          <li><a href="../Asciidoctor/DocBook45/BlockAudioTemplate.html">Asciidoctor::DocBook45::BlockAudioTemplate</a></li>
        
          <li><a href="../Asciidoctor/DocBook45/BlockColistTemplate.html">Asciidoctor::DocBook45::BlockColistTemplate</a></li>
        
          <li><a href="../Asciidoctor/DocBook45/BlockDlistTemplate.html">Asciidoctor::DocBook45::BlockDlistTemplate</a></li>
        
          <li><a href="../Asciidoctor/DocBook45/BlockExampleTemplate.html">Asciidoctor::DocBook45::BlockExampleTemplate</a></li>
        
          <li><a href="../Asciidoctor/DocBook45/BlockFloatingTitleTemplate.html">Asciidoctor::DocBook45::BlockFloatingTitleTemplate</a></li>
        
          <li><a href="../Asciidoctor/DocBook45/BlockImageTemplate.html">Asciidoctor::DocBook45::BlockImageTemplate</a></li>
        
          <li><a href="../Asciidoctor/DocBook45/BlockListingTemplate.html">Asciidoctor::DocBook45::BlockListingTemplate</a></li>
        
          <li><a href="../Asciidoctor/DocBook45/BlockLiteralTemplate.html">Asciidoctor::DocBook45::BlockLiteralTemplate</a></li>
        
          <li><a href="../Asciidoctor/DocBook45/BlockOlistTemplate.html">Asciidoctor::DocBook45::BlockOlistTemplate</a></li>
        
          <li><a href="../Asciidoctor/DocBook45/BlockOpenTemplate.html">Asciidoctor::DocBook45::BlockOpenTemplate</a></li>
        
          <li><a href="../Asciidoctor/DocBook45/BlockPageBreakTemplate.html">Asciidoctor::DocBook45::BlockPageBreakTemplate</a></li>
        
          <li><a href="../Asciidoctor/DocBook45/BlockParagraphTemplate.html">Asciidoctor::DocBook45::BlockParagraphTemplate</a></li>
        
          <li><a href="../Asciidoctor/DocBook45/BlockPassTemplate.html">Asciidoctor::DocBook45::BlockPassTemplate</a></li>
        
          <li><a href="../Asciidoctor/DocBook45/BlockPreambleTemplate.html">Asciidoctor::DocBook45::BlockPreambleTemplate</a></li>
        
          <li><a href="../Asciidoctor/DocBook45/BlockQuoteTemplate.html">Asciidoctor::DocBook45::BlockQuoteTemplate</a></li>
        
          <li><a href="../Asciidoctor/DocBook45/BlockRulerTemplate.html">Asciidoctor::DocBook45::BlockRulerTemplate</a></li>
        
          <li><a href="../Asciidoctor/DocBook45/BlockSidebarTemplate.html">Asciidoctor::DocBook45::BlockSidebarTemplate</a></li>
        
          <li><a href="../Asciidoctor/DocBook45/BlockTableTemplate.html">Asciidoctor::DocBook45::BlockTableTemplate</a></li>
        
          <li><a href="../Asciidoctor/DocBook45/BlockTocTemplate.html">Asciidoctor::DocBook45::BlockTocTemplate</a></li>
        
          <li><a href="../Asciidoctor/DocBook45/BlockUlistTemplate.html">Asciidoctor::DocBook45::BlockUlistTemplate</a></li>
        
          <li><a href="../Asciidoctor/DocBook45/BlockVerseTemplate.html">Asciidoctor::DocBook45::BlockVerseTemplate</a></li>
        
          <li><a href="../Asciidoctor/DocBook45/BlockVideoTemplate.html">Asciidoctor::DocBook45::BlockVideoTemplate</a></li>
        
          <li><a href="../Asciidoctor/DocBook45/DocumentTemplate.html">Asciidoctor::DocBook45::DocumentTemplate</a></li>
        
          <li><a href="../Asciidoctor/DocBook45/EmbeddedTemplate.html">Asciidoctor::DocBook45::EmbeddedTemplate</a></li>
        
          <li><a href="../Asciidoctor/DocBook45/InlineAnchorTemplate.html">Asciidoctor::DocBook45::InlineAnchorTemplate</a></li>
        
          <li><a href="../Asciidoctor/DocBook45/InlineBreakTemplate.html">Asciidoctor::DocBook45::InlineBreakTemplate</a></li>
        
          <li><a href="../Asciidoctor/DocBook45/InlineButtonTemplate.html">Asciidoctor::DocBook45::InlineButtonTemplate</a></li>
        
          <li><a href="../Asciidoctor/DocBook45/InlineCalloutTemplate.html">Asciidoctor::DocBook45::InlineCalloutTemplate</a></li>
        
          <li><a href="../Asciidoctor/DocBook45/InlineFootnoteTemplate.html">Asciidoctor::DocBook45::InlineFootnoteTemplate</a></li>
        
          <li><a href="../Asciidoctor/DocBook45/InlineImageTemplate.html">Asciidoctor::DocBook45::InlineImageTemplate</a></li>
        
          <li><a href="../Asciidoctor/DocBook45/InlineIndextermTemplate.html">Asciidoctor::DocBook45::InlineIndextermTemplate</a></li>
        
          <li><a href="../Asciidoctor/DocBook45/InlineKbdTemplate.html">Asciidoctor::DocBook45::InlineKbdTemplate</a></li>
        
          <li><a href="../Asciidoctor/DocBook45/InlineMenuTemplate.html">Asciidoctor::DocBook45::InlineMenuTemplate</a></li>
        
          <li><a href="../Asciidoctor/DocBook45/InlineQuotedTemplate.html">Asciidoctor::DocBook45::InlineQuotedTemplate</a></li>
        
          <li><a href="../Asciidoctor/DocBook45/SectionTemplate.html">Asciidoctor::DocBook45::SectionTemplate</a></li>
        
          <li><a href="../Asciidoctor/Document.html">Asciidoctor::Document</a></li>
        
          <li><a href="../Asciidoctor/EmptyTemplate.html">Asciidoctor::EmptyTemplate</a></li>
        
          <li><a href="../Asciidoctor/HTML5.html">Asciidoctor::HTML5</a></li>
        
          <li><a href="../Asciidoctor/HTML5/BlockAdmonitionTemplate.html">Asciidoctor::HTML5::BlockAdmonitionTemplate</a></li>
        
          <li><a href="../Asciidoctor/HTML5/BlockAudioTemplate.html">Asciidoctor::HTML5::BlockAudioTemplate</a></li>
        
          <li><a href="../Asciidoctor/HTML5/BlockColistTemplate.html">Asciidoctor::HTML5::BlockColistTemplate</a></li>
        
          <li><a href="../Asciidoctor/HTML5/BlockDlistTemplate.html">Asciidoctor::HTML5::BlockDlistTemplate</a></li>
        
          <li><a href="../Asciidoctor/HTML5/BlockExampleTemplate.html">Asciidoctor::HTML5::BlockExampleTemplate</a></li>
        
          <li><a href="../Asciidoctor/HTML5/BlockFloatingTitleTemplate.html">Asciidoctor::HTML5::BlockFloatingTitleTemplate</a></li>
        
          <li><a href="../Asciidoctor/HTML5/BlockImageTemplate.html">Asciidoctor::HTML5::BlockImageTemplate</a></li>
        
          <li><a href="../Asciidoctor/HTML5/BlockListingTemplate.html">Asciidoctor::HTML5::BlockListingTemplate</a></li>
        
          <li><a href="../Asciidoctor/HTML5/BlockLiteralTemplate.html">Asciidoctor::HTML5::BlockLiteralTemplate</a></li>
        
          <li><a href="../Asciidoctor/HTML5/BlockOlistTemplate.html">Asciidoctor::HTML5::BlockOlistTemplate</a></li>
        
          <li><a href="../Asciidoctor/HTML5/BlockOpenTemplate.html">Asciidoctor::HTML5::BlockOpenTemplate</a></li>
        
          <li><a href="../Asciidoctor/HTML5/BlockPageBreakTemplate.html">Asciidoctor::HTML5::BlockPageBreakTemplate</a></li>
        
          <li><a href="../Asciidoctor/HTML5/BlockParagraphTemplate.html">Asciidoctor::HTML5::BlockParagraphTemplate</a></li>
        
          <li><a href="../Asciidoctor/HTML5/BlockPassTemplate.html">Asciidoctor::HTML5::BlockPassTemplate</a></li>
        
          <li><a href="../Asciidoctor/HTML5/BlockPreambleTemplate.html">Asciidoctor::HTML5::BlockPreambleTemplate</a></li>
        
          <li><a href="../Asciidoctor/HTML5/BlockQuoteTemplate.html">Asciidoctor::HTML5::BlockQuoteTemplate</a></li>
        
          <li><a href="../Asciidoctor/HTML5/BlockRulerTemplate.html">Asciidoctor::HTML5::BlockRulerTemplate</a></li>
        
          <li><a href="../Asciidoctor/HTML5/BlockSidebarTemplate.html">Asciidoctor::HTML5::BlockSidebarTemplate</a></li>
        
          <li><a href="../Asciidoctor/HTML5/BlockTableTemplate.html">Asciidoctor::HTML5::BlockTableTemplate</a></li>
        
          <li><a href="../Asciidoctor/HTML5/BlockTocTemplate.html">Asciidoctor::HTML5::BlockTocTemplate</a></li>
        
          <li><a href="../Asciidoctor/HTML5/BlockUlistTemplate.html">Asciidoctor::HTML5::BlockUlistTemplate</a></li>
        
          <li><a href="../Asciidoctor/HTML5/BlockVerseTemplate.html">Asciidoctor::HTML5::BlockVerseTemplate</a></li>
        
          <li><a href="../Asciidoctor/HTML5/BlockVideoTemplate.html">Asciidoctor::HTML5::BlockVideoTemplate</a></li>
        
          <li><a href="../Asciidoctor/HTML5/DocumentTemplate.html">Asciidoctor::HTML5::DocumentTemplate</a></li>
        
          <li><a href="../Asciidoctor/HTML5/EmbeddedTemplate.html">Asciidoctor::HTML5::EmbeddedTemplate</a></li>
        
          <li><a href="../Asciidoctor/HTML5/InlineAnchorTemplate.html">Asciidoctor::HTML5::InlineAnchorTemplate</a></li>
        
          <li><a href="../Asciidoctor/HTML5/InlineBreakTemplate.html">Asciidoctor::HTML5::InlineBreakTemplate</a></li>
        
          <li><a href="../Asciidoctor/HTML5/InlineButtonTemplate.html">Asciidoctor::HTML5::InlineButtonTemplate</a></li>
        
          <li><a href="../Asciidoctor/HTML5/InlineCalloutTemplate.html">Asciidoctor::HTML5::InlineCalloutTemplate</a></li>
        
          <li><a href="../Asciidoctor/HTML5/InlineFootnoteTemplate.html">Asciidoctor::HTML5::InlineFootnoteTemplate</a></li>
        
          <li><a href="../Asciidoctor/HTML5/InlineImageTemplate.html">Asciidoctor::HTML5::InlineImageTemplate</a></li>
        
          <li><a href="../Asciidoctor/HTML5/InlineIndextermTemplate.html">Asciidoctor::HTML5::InlineIndextermTemplate</a></li>
        
          <li><a href="../Asciidoctor/HTML5/InlineKbdTemplate.html">Asciidoctor::HTML5::InlineKbdTemplate</a></li>
        
          <li><a href="../Asciidoctor/HTML5/InlineMenuTemplate.html">Asciidoctor::HTML5::InlineMenuTemplate</a></li>
        
          <li><a href="../Asciidoctor/HTML5/InlineQuotedTemplate.html">Asciidoctor::HTML5::InlineQuotedTemplate</a></li>
        
          <li><a href="../Asciidoctor/HTML5/SectionTemplate.html">Asciidoctor::HTML5::SectionTemplate</a></li>
        
          <li><a href="../Asciidoctor/Helpers.html">Asciidoctor::Helpers</a></li>
        
          <li><a href="../Asciidoctor/Inline.html">Asciidoctor::Inline</a></li>
        
          <li><a href="../Asciidoctor/Lexer.html">Asciidoctor::Lexer</a></li>
        
          <li><a href="../Asciidoctor/ListItem.html">Asciidoctor::ListItem</a></li>
        
          <li><a href="../Asciidoctor/PathResolver.html">Asciidoctor::PathResolver</a></li>
        
          <li><a href="../Asciidoctor/Reader.html">Asciidoctor::Reader</a></li>
        
          <li><a href="../Asciidoctor/Renderer.html">Asciidoctor::Renderer</a></li>
        
          <li><a href="../Asciidoctor/SafeMode.html">Asciidoctor::SafeMode</a></li>
        
          <li><a href="../Asciidoctor/Section.html">Asciidoctor::Section</a></li>
        
          <li><a href="../Asciidoctor/Substituters.html">Asciidoctor::Substituters</a></li>
        
          <li><a href="../Asciidoctor/Table.html">Asciidoctor::Table</a></li>
        
          <li><a href="../Asciidoctor/Table/Cell.html">Asciidoctor::Table::Cell</a></li>
        
          <li><a href="../Asciidoctor/Table/Column.html">Asciidoctor::Table::Column</a></li>
        
          <li><a href="../Asciidoctor/Table/ParserContext.html">Asciidoctor::Table::ParserContext</a></li>
        
        </ul>
        <div id="no-class-search-results" style="display: none;">No matching classes.</div>
      </div>

      
    </div>
  </div>

  <div id="documentation">
    <h1 class="class">Asciidoctor::PathResolver</h1>

    <div id="description" class="description">
      
<p>Public: Handles all operations for resolving, cleaning and joining paths.
This class includes operations for handling both web paths (request URIs)
and system paths.</p>

<p>The main emphasis of the class is on creating clean and secure paths. Clean
paths are void of duplicate parent and current directory references in the
path name. Secure paths are paths which are restricted from accessing
directories outside of a jail root, if specified.</p>

<p>Since joining two paths can result in an insecure path, this class also
handles the task of joining a parent (start) and child (target) path.</p>

<p>This class makes no use of path utilities from the Ruby libraries. Instead,
it handles all aspects of path manipulation. The main benefit of
internalizing these operations is that the class is able to handle both
posix and windows paths independent of the operating system on which it
runs. This makes the class both deterministic and easier to test.</p>

<p>Examples</p>

<pre>resolver = PathResolver.new

# Web Paths

resolver.web_path('images')
=&gt; 'images'

resolver.web_path('./images')
=&gt; './images'

resolver.web_path('/images')
=&gt; '/images'

resolver.web_path('./images/../assets/images')
=&gt; './assets/images'

resolver.web_path('/../images')
=&gt; '/images'

resolver.web_path('images', 'assets')
=&gt; 'assets/images'

resolver.web_path('tiger.png', '../assets/images')
=&gt; '../assets/images/tiger.png'

# System Paths

resolver.working_dir
=&gt; '/path/to/docs'

resolver.system_path('images')
=&gt; '/path/to/docs/images'

resolver.system_path('../images')
=&gt; '/path/to/images'

resolver.system_path('/etc/images')
=&gt; '/etc/images'

resolver.system_path('images', '/etc')
=&gt; '/etc/images'

resolver.system_path('', '/etc/images')
=&gt; '/etc/images'

resolver.system_path(nil, nil, '/path/to/docs')
=&gt; '/path/to/docs'

resolver.system_path('..', nil, '/path/to/docs')
=&gt; '/path/to/docs'

resolver.system_path('../../../css', nil, '/path/to/docs')
=&gt; '/path/to/docs/css'

resolver.system_path('../../../css', '../../..', '/path/to/docs')
=&gt; '/path/to/docs/css'

resolver.system_path('..', 'C:\\data\\docs\\assets', 'C:\\data\\docs')
=&gt; 'C:/data/docs'

resolver.system_path('..\\..\\css', 'C:\\data\\docs\\assets', 'C:\\data\\docs')
=&gt; 'C:/data/docs/css'

begin
  resolver.system_path('../../../css', '../../..', '/path/to/docs', :recover =&gt; false)
rescue SecurityError =&gt; e
  puts e.message
end
=&gt; 'path ../../../../../../css refers to location outside jail: /path/to/docs (disallowed in safe mode)'

resolver.system_path('/path/to/docs/images', nil, '/path/to/docs')
=&gt; '/path/to/docs/images'

begin
  resolver.system_path('images', '/etc', '/path/to/docs')
rescue SecurityError =&gt; e
  puts e.message 
end
=&gt; Start path /etc is outside of jail: /path/to/docs'</pre>

    </div><!-- description -->

    
    
    
    <div id="5Buntitled-5D" class="documentation-section">
      

      

      
      <!-- Constants -->
      <div id="constants-list" class="section">
        <h3 class="section-header">Constants</h3>
        <dl>
        
          <dt><a name="BACKSLASH">BACKSLASH</a></dt>
          
          <dd class="description"></dd>
          
        
          <dt><a name="DOT">DOT</a></dt>
          
          <dd class="description"></dd>
          
        
          <dt><a name="DOT_DOT">DOT_DOT</a></dt>
          
          <dd class="description"></dd>
          
        
          <dt><a name="SLASH">SLASH</a></dt>
          
          <dd class="description"></dd>
          
        
          <dt><a name="WIN_ROOT_RE">WIN_ROOT_RE</a></dt>
          
          <dd class="description"></dd>
          
        
        </dl>
      </div>
      

      
      <!-- Attributes -->
      <div id="attribute-method-details" class="method-section section">
        <h3 class="section-header">Attributes</h3>

        
        <div id="file_separator-attribute-method" class="method-detail">
          <a name="file_separator"></a>
          
          <a name="file_separator="></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">file_separator</span><span
              class="attribute-access-type">[RW]</span>
          </div>

          <div class="method-description">
          
          
          
          </div>
        </div>
        
        <div id="working_dir-attribute-method" class="method-detail">
          <a name="working_dir"></a>
          
          <a name="working_dir="></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">working_dir</span><span
              class="attribute-access-type">[RW]</span>
          </div>

          <div class="method-description">
          
          
          
          </div>
        </div>
        
      </div><!-- attribute-method-details -->
      

      <!-- Methods -->
      
      <div id="public-class-method-details" class="method-section section">
        <h3 class="section-header">Public Class Methods</h3>

      
        <div id="new-method" class="method-detail ">
          <a name="method-c-new"></a>

          
          <div class="method-heading">
            <span class="method-name">new</span><span
              class="method-args">(file_separator = nil, working_dir = nil)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Public: Construct a new instance of <a
href="PathResolver.html">PathResolver</a>, optionally specifying the file
separator (to override the system default) and the working directory (to
override the present working directory). The working directory will be
expanded to an absolute path inside the constructor.</p>

<p><a href="PathResolver.html#attribute-i-file_separator">file_separator</a> -
the String file separator to use for path operations</p>

<pre>(optional, default: File::FILE_SEPARATOR)</pre>

<p><a href="PathResolver.html#attribute-i-working_dir">working_dir</a>    -
the String working directory (optional, default: Dir.pwd)</p>
            

            
            <div class="method-source-code" id="new-source">
<pre>
<span class="ruby-comment"># File lib/asciidoctor/path_resolver.rb, line 121</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">file_separator</span> = <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">working_dir</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-ivar">@file_separator</span> = <span class="ruby-identifier">file_separator</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">?</span> (<span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-constant">ALT_SEPARATOR</span> <span class="ruby-operator">||</span> <span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-constant">SEPARATOR</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">file_separator</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">working_dir</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-ivar">@working_dir</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span>(<span class="ruby-constant">Dir</span>.<span class="ruby-identifier">pwd</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@working_dir</span> = <span class="ruby-identifier">is_root?</span>(<span class="ruby-identifier">working_dir</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">working_dir</span> <span class="ruby-operator">:</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span>(<span class="ruby-identifier">working_dir</span>) 
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- new-source -->
            
          </div>

          

          
        </div><!-- new-method -->

      
      </div><!-- public-class-method-details -->
    
      <div id="public-instance-method-details" class="method-section section">
        <h3 class="section-header">Public Instance Methods</h3>

      
        <div id="expand_path-method" class="method-detail ">
          <a name="method-i-expand_path"></a>

          
          <div class="method-heading">
            <span class="method-name">expand_path</span><span
              class="method-args">(path)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Public: Expand the path by resolving any parent references (..) and
cleaning self references (.).</p>

<p>The result will be relative if the path is relative and absolute if the
path is absolute. The file separator used in the expanded path is the one
specified when the class was constructed.</p>

<p>path - the String path to expand</p>

<p>returns a String path with any parent or self references resolved.</p>
            

            
            <div class="method-source-code" id="expand_path-source">
<pre>
<span class="ruby-comment"># File lib/asciidoctor/path_resolver.rb, line 176</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">expand_path</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-identifier">path_segments</span>, <span class="ruby-identifier">path_root</span>, <span class="ruby-identifier">_</span> = <span class="ruby-identifier">partition_path</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-identifier">join_path</span> <span class="ruby-identifier">path_segments</span>, <span class="ruby-identifier">path_root</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- expand_path-source -->
            
          </div>

          

          
        </div><!-- expand_path-method -->

      
        <div id="is_root-3F-method" class="method-detail ">
          <a name="method-i-is_root-3F"></a>

          
          <div class="method-heading">
            <span class="method-name">is_root?</span><span
              class="method-args">(path)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Public: Check if the specified path is an absolute root path This operation
correctly handles both posix and windows paths.</p>

<p>path - the String path to check</p>

<p>returns a Boolean indicating whether the path is an absolute root path</p>
            

            
            <div class="method-source-code" id="is_root-3F-source">
<pre>
<span class="ruby-comment"># File lib/asciidoctor/path_resolver.rb, line 136</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">is_root?</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@file_separator</span> <span class="ruby-operator">==</span> <span class="ruby-constant">BACKSLASH</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">path</span>.<span class="ruby-identifier">match</span>(<span class="ruby-constant">WIN_ROOT_RE</span>)
    <span class="ruby-keyword">true</span>
  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">path</span>.<span class="ruby-identifier">start_with?</span> <span class="ruby-constant">SLASH</span>
    <span class="ruby-keyword">true</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">false</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- is_root-3F-source -->
            
          </div>

          

          
        </div><!-- is_root-3F-method -->

      
        <div id="is_web_root-3F-method" class="method-detail ">
          <a name="method-i-is_web_root-3F"></a>

          
          <div class="method-heading">
            <span class="method-name">is_web_root?</span><span
              class="method-args">(path)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Public: Determine if the path is an absolute (root) web path</p>

<p>path - the String path to check</p>

<p>returns a Boolean indicating whether the path is an absolute (root) web
path</p>
            

            
            <div class="method-source-code" id="is_web_root-3F-source">
<pre>
<span class="ruby-comment"># File lib/asciidoctor/path_resolver.rb, line 151</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">is_web_root?</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-identifier">path</span>.<span class="ruby-identifier">start_with?</span> <span class="ruby-constant">SLASH</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- is_web_root-3F-source -->
            
          </div>

          

          
        </div><!-- is_web_root-3F-method -->

      
        <div id="join_path-method" class="method-detail ">
          <a name="method-i-join_path"></a>

          
          <div class="method-heading">
            <span class="method-name">join_path</span><span
              class="method-args">(segments, root = nil)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Public: Join the segments using the posix file separator (since Ruby knows
how to work with paths specified this way, regardless of OS). Use the root,
if specified, to construct an absolute path. Otherwise join the segments as
a relative path.</p>

<p>segments - a String Array of path segments root     - a String path root
(optional, default: nil)</p>

<p>returns a String path formed by joining the segments using the posix file
separator and prepending the root, if specified</p>
            

            
            <div class="method-source-code" id="join_path-source">
<pre>
<span class="ruby-comment"># File lib/asciidoctor/path_resolver.rb, line 214</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">join_path</span>(<span class="ruby-identifier">segments</span>, <span class="ruby-identifier">root</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">root</span>
    <span class="ruby-node">&quot;#{root}#{SLASH}#{segments * SLASH}&quot;</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">segments</span> * <span class="ruby-constant">SLASH</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- join_path-source -->
            
          </div>

          

          
        </div><!-- join_path-method -->

      
        <div id="partition_path-method" class="method-detail ">
          <a name="method-i-partition_path"></a>

          
          <div class="method-heading">
            <span class="method-name">partition_path</span><span
              class="method-args">(path, web_path = false)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Public: Partition the path into path segments and remove any empty segments
or segments that are self references (.). The path is split on either posix
or windows file separators.</p>

<p>path     - the String path to partition <a
href="PathResolver.html#method-i-web_path">web_path</a> - a Boolean
indicating whether the path should be handled</p>

<pre>as a web path (optional, default: false)</pre>

<p>returns a 3-item Array containing the Array of String path segments, the
path root, if the path is absolute, and the posix version of the path.</p>
            

            
            <div class="method-source-code" id="partition_path-source">
<pre>
<span class="ruby-comment"># File lib/asciidoctor/path_resolver.rb, line 191</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">partition_path</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">web_path</span> = <span class="ruby-keyword">false</span>)
  <span class="ruby-identifier">posix_path</span> = <span class="ruby-identifier">posixfy</span> <span class="ruby-identifier">path</span>
  <span class="ruby-identifier">is_root</span> = <span class="ruby-identifier">web_path</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">is_web_root?</span>(<span class="ruby-identifier">posix_path</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">is_root?</span>(<span class="ruby-identifier">posix_path</span>)
  <span class="ruby-identifier">path_segments</span> = <span class="ruby-identifier">posix_path</span>.<span class="ruby-identifier">tr_s</span>(<span class="ruby-constant">SLASH</span>, <span class="ruby-constant">SLASH</span>).<span class="ruby-identifier">split</span>(<span class="ruby-constant">SLASH</span>)
  <span class="ruby-comment"># capture relative root</span>
  <span class="ruby-identifier">root</span> = <span class="ruby-identifier">path_segments</span>.<span class="ruby-identifier">first</span> <span class="ruby-operator">==</span> <span class="ruby-constant">DOT</span> <span class="ruby-operator">?</span> <span class="ruby-constant">DOT</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">path_segments</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-constant">DOT</span>)
  <span class="ruby-comment"># capture absolute root, preserving relative root if set</span>
  <span class="ruby-identifier">root</span> = <span class="ruby-identifier">is_root</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">path_segments</span>.<span class="ruby-identifier">shift</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">root</span>

  [<span class="ruby-identifier">path_segments</span>, <span class="ruby-identifier">root</span>, <span class="ruby-identifier">posix_path</span>]
<span class="ruby-keyword">end</span></pre>
            </div><!-- partition_path-source -->
            
          </div>

          

          
        </div><!-- partition_path-method -->

      
        <div id="posixfy-method" class="method-detail ">
          <a name="method-i-posixfy"></a>

          
          <div class="method-heading">
            <span class="method-name">posixfy</span><span
              class="method-args">(path)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Public: Normalize path by converting any backslashes to forward slashes</p>

<p>path - the String path to normalize</p>

<p>returns a String path with any backslashes replaced with forward slashes</p>
            

            
            <div class="method-source-code" id="posixfy-source">
<pre>
<span class="ruby-comment"># File lib/asciidoctor/path_resolver.rb, line 160</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">posixfy</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-string">''</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">path</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">empty?</span>
  <span class="ruby-identifier">path</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-constant">BACKSLASH</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">path</span>.<span class="ruby-identifier">tr</span>(<span class="ruby-constant">BACKSLASH</span>, <span class="ruby-constant">SLASH</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">path</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- posixfy-source -->
            
          </div>

          

          
        </div><!-- posixfy-method -->

      
        <div id="system_path-method" class="method-detail ">
          <a name="method-i-system_path"></a>

          
          <div class="method-heading">
            <span class="method-name">system_path</span><span
              class="method-args">(target, start, jail = nil, opts = {})</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Public: Resolve a system path from the target and start paths. If a jail
path is specified, enforce that the resolved directory is contained within
the jail path. If a jail path is not provided, the resolved path may be any
location on the system. If the resolved path is absolute, use it as is. If
the resolved path is relative, resolve it relative to the <a
href="PathResolver.html#attribute-i-working_dir">working_dir</a> specified
in the constructor.</p>

<p>target - the String target path start  - the String start (i.e., parent)
path jail   - the String jail path to confine the resolved path opts   - an
optional Hash of options to control processing (default: {}):</p>

<pre>* :recover is used to control whether the processor should auto-recover
    when an illegal path is encountered
* :target_name is used in messages to refer to the path being resolved</pre>

<p>returns a String path that joins the target path with the start path with
any parent references resolved and self references removed and enforces
that the resolved path be contained within the jail, if provided</p>
            

            
            <div class="method-source-code" id="system_path-source">
<pre>
<span class="ruby-comment"># File lib/asciidoctor/path_resolver.rb, line 240</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">system_path</span>(<span class="ruby-identifier">target</span>, <span class="ruby-identifier">start</span>, <span class="ruby-identifier">jail</span> = <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">opts</span> = {})
  <span class="ruby-identifier">recover</span> = <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-value">:recover</span>, <span class="ruby-keyword">true</span>)
  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">jail</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-keyword">unless</span> <span class="ruby-identifier">is_root?</span> <span class="ruby-identifier">jail</span>
      <span class="ruby-identifier">raise</span> <span class="ruby-constant">SecurityError</span>, <span class="ruby-node">&quot;Jail is not an absolute path: #{jail}&quot;</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">jail</span> = <span class="ruby-identifier">posixfy</span> <span class="ruby-identifier">jail</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">target</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">empty?</span>
    <span class="ruby-identifier">target_segments</span> = []
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">target_segments</span>, <span class="ruby-identifier">target_root</span>, <span class="ruby-identifier">_</span> = <span class="ruby-identifier">partition_path</span>(<span class="ruby-identifier">target</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">target_segments</span>.<span class="ruby-identifier">empty?</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">start</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">empty?</span>
      <span class="ruby-keyword">return</span> <span class="ruby-identifier">jail</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">?</span> <span class="ruby-ivar">@working_dir</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">jail</span>
    <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">is_root?</span> <span class="ruby-identifier">start</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">jail</span>.<span class="ruby-identifier">nil?</span>
        <span class="ruby-keyword">return</span> <span class="ruby-identifier">expand_path</span> <span class="ruby-identifier">start</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-keyword">return</span> <span class="ruby-identifier">system_path</span>(<span class="ruby-identifier">start</span>, <span class="ruby-identifier">jail</span>, <span class="ruby-identifier">jail</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">target_root</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">target_root</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">DOT</span>
    <span class="ruby-identifier">resolved_target</span> = <span class="ruby-identifier">join_path</span> <span class="ruby-identifier">target_segments</span>, <span class="ruby-identifier">target_root</span>
    <span class="ruby-comment"># if target is absolute and a sub-directory of jail, or</span>
    <span class="ruby-comment"># a jail is not in place, let it slide</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">jail</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">resolved_target</span>.<span class="ruby-identifier">start_with?</span>(<span class="ruby-identifier">jail</span>)
      <span class="ruby-keyword">return</span> <span class="ruby-identifier">resolved_target</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">start</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">empty?</span>
    <span class="ruby-identifier">start</span> = <span class="ruby-identifier">jail</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">?</span> <span class="ruby-ivar">@working_dir</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">jail</span>
  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">is_root?</span> <span class="ruby-identifier">start</span>
    <span class="ruby-identifier">start</span> = <span class="ruby-identifier">posixfy</span> <span class="ruby-identifier">start</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">start</span> = <span class="ruby-identifier">system_path</span>(<span class="ruby-identifier">start</span>, <span class="ruby-identifier">jail</span>, <span class="ruby-identifier">jail</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># both jail and start have been posixfied at this point</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">jail</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">start</span>
    <span class="ruby-identifier">jail_segments</span>, <span class="ruby-identifier">jail_root</span>, <span class="ruby-identifier">_</span> = <span class="ruby-identifier">partition_path</span>(<span class="ruby-identifier">jail</span>)
    <span class="ruby-identifier">start_segments</span> = <span class="ruby-identifier">jail_segments</span>.<span class="ruby-identifier">dup</span>
  <span class="ruby-keyword">elsif</span> <span class="ruby-operator">!</span><span class="ruby-identifier">jail</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">start</span>.<span class="ruby-identifier">start_with?</span>(<span class="ruby-identifier">jail</span>)
      <span class="ruby-identifier">raise</span> <span class="ruby-constant">SecurityError</span>, <span class="ruby-node">&quot;#{opts[:target_name] || 'Start path'} #{start} is outside of jail: #{jail} (disallowed in safe mode)&quot;</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">start_segments</span>, <span class="ruby-identifier">start_root</span>, <span class="ruby-identifier">_</span> = <span class="ruby-identifier">partition_path</span>(<span class="ruby-identifier">start</span>)
    <span class="ruby-identifier">jail_segments</span>, <span class="ruby-identifier">jail_root</span>, <span class="ruby-identifier">_</span> = <span class="ruby-identifier">partition_path</span>(<span class="ruby-identifier">jail</span>)

    <span class="ruby-comment"># Already checked for this condition</span>
    <span class="ruby-comment">#if start_root != jail_root</span>
    <span class="ruby-comment">#  raise SecurityError, &quot;Jail root #{jail_root} does not match root of #{opts[:target_name] || 'start path'}: #{start_root}&quot;</span>
    <span class="ruby-comment">#end</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">start_segments</span>, <span class="ruby-identifier">start_root</span>, <span class="ruby-identifier">_</span> = <span class="ruby-identifier">partition_path</span>(<span class="ruby-identifier">start</span>)
    <span class="ruby-identifier">jail_root</span> = <span class="ruby-identifier">start_root</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">resolved_segments</span> = <span class="ruby-identifier">start_segments</span>.<span class="ruby-identifier">dup</span>
  <span class="ruby-identifier">warned</span> = <span class="ruby-keyword">false</span>
  <span class="ruby-identifier">target_segments</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">segment</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">segment</span> <span class="ruby-operator">==</span> <span class="ruby-constant">DOT_DOT</span>
      <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">jail</span>.<span class="ruby-identifier">nil?</span>
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">resolved_segments</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">jail_segments</span>.<span class="ruby-identifier">length</span>
          <span class="ruby-identifier">resolved_segments</span>.<span class="ruby-identifier">pop</span>
        <span class="ruby-keyword">elsif</span> <span class="ruby-operator">!</span><span class="ruby-identifier">recover</span>
          <span class="ruby-identifier">raise</span> <span class="ruby-constant">SecurityError</span>, <span class="ruby-node">&quot;#{opts[:target_name] || 'path'} #{target} refers to location outside jail: #{jail} (disallowed in safe mode)&quot;</span>
        <span class="ruby-keyword">elsif</span> <span class="ruby-operator">!</span><span class="ruby-identifier">warned</span>
          <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;asciidoctor: WARNING: #{opts[:target_name] || 'path'} has illegal reference to ancestor of jail, auto-recovering&quot;</span>
          <span class="ruby-identifier">warned</span> = <span class="ruby-keyword">true</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">resolved_segments</span>.<span class="ruby-identifier">pop</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">resolved_segments</span>.<span class="ruby-identifier">push</span> <span class="ruby-identifier">segment</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">join_path</span> <span class="ruby-identifier">resolved_segments</span>, <span class="ruby-identifier">jail_root</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- system_path-source -->
            
          </div>

          

          
        </div><!-- system_path-method -->

      
        <div id="web_path-method" class="method-detail ">
          <a name="method-i-web_path"></a>

          
          <div class="method-heading">
            <span class="method-name">web_path</span><span
              class="method-args">(target, start = nil)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Public: Resolve a web path from the target and start paths. The main
function of this operation is to resolve any parent references and remove
any self references.</p>

<p>target - the String target path start  - the String start (i.e., parent)
path</p>

<p>returns a String path that joins the target path with the start path with
any parent references resolved and self references removed</p>
            

            
            <div class="method-source-code" id="web_path-source">
<pre>
<span class="ruby-comment"># File lib/asciidoctor/path_resolver.rb, line 339</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">web_path</span>(<span class="ruby-identifier">target</span>, <span class="ruby-identifier">start</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">target</span> = <span class="ruby-identifier">posixfy</span>(<span class="ruby-identifier">target</span>)
  <span class="ruby-identifier">start</span> = <span class="ruby-identifier">posixfy</span>(<span class="ruby-identifier">start</span>)

  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">is_web_root?</span>(<span class="ruby-identifier">target</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">start</span>.<span class="ruby-identifier">empty?</span>
    <span class="ruby-identifier">target</span> = <span class="ruby-node">&quot;#{start}#{SLASH}#{target}&quot;</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">target_segments</span>, <span class="ruby-identifier">target_root</span>, <span class="ruby-identifier">_</span> = <span class="ruby-identifier">partition_path</span>(<span class="ruby-identifier">target</span>, <span class="ruby-keyword">true</span>)
  <span class="ruby-identifier">resolved_segments</span> = <span class="ruby-identifier">target_segments</span>.<span class="ruby-identifier">inject</span>([]) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">accum</span>, <span class="ruby-identifier">segment</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">segment</span> <span class="ruby-operator">==</span> <span class="ruby-constant">DOT_DOT</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">accum</span>.<span class="ruby-identifier">empty?</span>
        <span class="ruby-identifier">accum</span>.<span class="ruby-identifier">push</span> <span class="ruby-identifier">segment</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">target_root</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">target_root</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">DOT</span>
      <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">accum</span>[<span class="ruby-value">-1</span>] <span class="ruby-operator">==</span> <span class="ruby-constant">DOT_DOT</span>
        <span class="ruby-identifier">accum</span>.<span class="ruby-identifier">push</span> <span class="ruby-identifier">segment</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">accum</span>.<span class="ruby-identifier">pop</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">accum</span>.<span class="ruby-identifier">push</span> <span class="ruby-identifier">segment</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">accum</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">join_path</span> <span class="ruby-identifier">resolved_segments</span>, <span class="ruby-identifier">target_root</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- web_path-source -->
            
          </div>

          

          
        </div><!-- web_path-method -->

      
      </div><!-- public-instance-method-details -->
    
    </div><!-- 5Buntitled-5D -->
  

  </div><!-- documentation -->

  <div id="validator-badges">
    <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
    <p><small>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish
      Rdoc Generator</a> 2</small>.</p>
  </div>

</body>
</html>

