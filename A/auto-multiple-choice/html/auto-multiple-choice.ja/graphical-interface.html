<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>GUIの使用方法</title><link rel="stylesheet" type="text/css" href="../style.css" /><meta name="generator" content="DocBook XSL Stylesheets V1.76.1" /><link rel="home" href="index.html" title="Auto Multiple Choice" /><link rel="up" href="index.html" title="Auto Multiple Choice" /><link rel="prev" href="latex.html" title="LaTeXソースファイル" /><link rel="next" href="ar01s07.html" title="非標準の使用方法" /></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">GUIの使用方法</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="latex.html">戻る</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="ar01s07.html">次へ</a></td></tr></table><hr /></div><div class="sect1" title="GUIの使用方法"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="graphical-interface"></a>GUIの使用方法</h2></div></div></div><p>ここでは、選択式試験問題の作成から受験者の得点の編集まで、GUIによる使用例を解説します。</p><div class="sect2" title="プロジェクトの新規作成"><div class="titlepage"><div><div><h3 class="title"><a id="idp7359536"></a>プロジェクトの新規作成</h3></div></div></div><p>GUIを開きましょう。通常は、Gnomeの一般メニュー（あるいは、KDEなどの対応するメニュー）から<span class="guimenu">アプリケーション</span> → <span class="guisubmenu">教育</span> → <span class="guimenuitem">Auto Multiple Choice</span>を選んで開きます。<strong class="userinput"><code>auto-multiple-choice</code></strong>コマンドを直接使うこともできます。</p><p><span class="guimenu">プロジェクト</span> → <span class="guimenuitem">新規</span>を選んで、プロジェクトを作成しましょう。ウィンドウが開いて、既存のプロジェクトがあればその一覧が表示され、これから作成するプロジェクトの名前（単純な文字で。今回のテスト用に「test」でもOKです）を<span class="guilabel">プロジェクト名</span>欄に記入することができます。そして、<span class="guibutton">新規プロジェクト</span>ボタンを押します。</p><p>ここで、選択式試験問題用のAMC-TXTファイルあるいはLaTeXソースファイルを選ばなければなりません。オプションがいくつか示されます:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p><span class="guilabel">テンプレート</span>: これを選択すると、AMCに付属するいくつかのテンプレートの中から一つを選び、後から試験問題をカスタマイズしていくことができます。</p></li><li class="listitem"><p><span class="guilabel">ファイル</span>: これを選択すると、この試験用に既に準備されたLaTeXファイルを選ぶことができます。誰か他の人が既に準備してくれたか、AMCの外で好みのエディタを使ってあなたが準備したものかもしれません。</p></li><li class="listitem"><p><span class="guilabel">空</span>: これを選択すると、空のLaTeXファイルが作成されます。ゼロから試験問題を作成しなければいけません。</p></li><li class="listitem"><p><span class="guilabel">アーカイブ</span>: 試験問題の記述（LaTeXソースファイル、画像ファイル、パラメータファイルなど）を含んだzipあるいはtgzのアーカイブがある場合は、これを選択してください。このアーカイブは外部のソフトウェアによって作成することができます。既存のAMCプロジェクトのバックアップかもしれません。</p></li></ul></div><p>ここでは、<span class="guilabel">テンプレート</span>を選択します。次のウィンドウがテンプレートを示します。例えば、<span class="guilabel">[JA] ドキュメント</span>グループから、<span class="guilabel">単純な例</span>を選びます。これで、<span class="guibutton">ソースファイル編集</span>ボタンによりデフォルトのエディタが起動し、編集してレイアウトや設問を変更できるようになります。</p></div><div class="sect2" title="試験問題の作成"><div class="titlepage"><div><div><h3 class="title"><a id="idp7378304"></a>試験問題の作成</h3></div></div></div><p>試験問題の作成は二つのステップからなります。最初にLaTeXソースファイルから、参照用の文書を作成しなければなりません。これは<span class="guibutton">文書更新</span>をクリックすることにより行われ、以下の文書が生成されます</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p><span class="emphasis"><em>試験問題</em></span>: このファイルはそのまま印刷して受験者に配布することができます（下記参照）。</p></li><li class="listitem"><p><span class="emphasis"><em>解答</em></span>: 試験問題に間違いがないかどうかチェックすることができます。受験者に配布することもできます。</p></li></ul></div><p>これらの文書が作成されると、対応するボタンをクリックして表示（そして必要なら印刷）することができます。</p><p>以上で、試験問題作成の最後のステップを始められます。レイアウトの解析です。これは、<span class="guibutton">レイアウト検出</span>ボタンをクリックすることにより起動されます。この解析処理は、試験問題の各ページにおいて、受験者の答案用紙で解析しなければならない全要素の正確な位置を検出します。</p><p>レイアウトが正しく検出されているか検証するには、<span class="guibutton">レイアウト確認</span>ボタンを使います。結果をさっと見て、試験問題の各ボックス上に赤いチェックボックスが正しく乗っているかを調べます。</p></div><div class="sect2" title="印刷と試験実施"><div class="titlepage"><div><div><h3 class="title"><a id="printing"></a>印刷と試験実施</h3></div></div></div><p>2種類のワークフローが検討可能です:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>最も堅牢なモードでは、受験者全員分の試験問題用紙を別々の試験問題番号で作成し、全部印刷します。各ページはその番号と上部にあるボックスで完全に識別でき、同じ答案用紙を特に注意せず何度もマーク認識させてかまいません。</p></li><li class="listitem"><p>2番目のモードでは、少数の試験問題だけ（あるいは希望なら1部のみ）を印刷し、受験者全員分はコピーで作成することができます。設問のシャフル効果は若干低下します。誤って、同じページを何度かマーク認識させてしまうと、AMCはそれを検知できないので望まない重複を作成してしまいます。</p></li></ul></div><div class="warning" title="警告" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Warning"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[警告]" src="../images/warning.png" /></td><th align="left">警告</th></tr><tr><td align="left" valign="top"><p>2番目のコピーを用いたワークフローを使うには、受験者が記入するページは1枚だけでなければなりません（場合によっては別紙答案方式が役に立ちます）。でなければ、AMCでこの先を続けることはできません！AMCは、同じ受験生が記入した二つのページをリンクすることができないのです。</p></td></tr></table></div><p>試験問題の作成が完了すれば、試験問題を印刷して受験者に配布することができます... 単純な場合には、（作業文書の<span class="guilabel">問題</span>ボタンをクリックしたあと）ビューアから直接印刷できます。用紙を別々に（それぞれ複数ページからなり、それらをステープルできるようなプリンタを使う場合など）印刷する場合、レイアウト検出後に<span class="guibutton">試験問題印刷</span>ボタンを使うといいでしょう。</p><div class="important" title="重要" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[重要]" src="../images/important.png" /></td><th align="left">重要</th></tr><tr><td align="left" valign="top"><p>試験問題を印刷し配布したら、それらと完全に同一にしておく必要があるので<span class="emphasis"><em>作業文書</em></span>を修正してはいけません。</p></td></tr></table></div></div><div class="sect2" title="答案のスキャン"><div class="titlepage"><div><div><h3 class="title"><a id="idp7396304"></a>答案のスキャン</h3></div></div></div><p>ここでは、受験者の答案からの入力を説明します。これは、自動あるいは手動で行うことができます。</p><p>GUIの<span class="guilabel">マーク認識</span>タブに行きます。</p><div class="sect3" title="自動入力"><div class="titlepage"><div><div><h4 class="title"><a id="idp7398496"></a>自動入力</h4></div></div></div><p>受験者が記入したマークを自動認識するには、事前に答案をデジタル化しておかなければなりません。私の場合は、その作業を（私の操作なしに束にした全ページに対して）自動でやってくれるコピー機/スキャナを使い、300dpi、OCRモード（文字認識向き、グレースケールでないモノクロモードのことで、文字認識をしてくれるわけではありません）の設定で行って、各ページが一つのTIFFファイルとしてスキャンデータが得られます。（訳注: 訳者の場合、300dpi、グレースケールを使用しています。）</p><div class="note" title="注記" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[注記]" src="../images/note.png" /></td><th align="left">注記</th></tr><tr><td align="left" valign="top"><p>スキャンデータを解析するには、それらを一つあるいは複数の画像ファイル（TIFF、JPG、PNG等）として持つ必要があります。ベクターグラフィックス形式（PDF、PS、EPS）でもかまいません。この場合はスキャンデータは解析前にPNGに変換されます（訳注: 多数のページを含むファイルを変換すると、ImageMagickが /var/tmp を多量に消費するので、ファイルを適度に分けた方がいいでしょう）。</p></td></tr></table></div><div class="note" title="注記" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[注記]" src="../images/note.png" /></td><th align="left">注記</th></tr><tr><td align="left" valign="top"><p>スキャンデータを使って最初に自動マーク認識を行う際は、個別答案用紙かコピー答案用紙のどちらの方法を使うかAMCに通知します（<a class="xref" href="graphical-interface.html#printing" title="印刷と試験実施">印刷と試験実施</a>参照）。</p></td></tr></table></div><p>そして、「<span class="guilabel">試験実施後のマーク認識</span>」セクションの<span class="guilabel">自動</span>ボタンで開いたダイアログから、スキャンデータファイルをすべて選択したのち、このダイアログの<span class="guibutton">OK</span>ボタンで開始します。AMCは光学マーク認識を開始して、四隅のマーカー位置を検出し、ボックスの位置を決定して、各ボックスの黒ピクセルの量を検出します。</p><p>各ページの解析結果は<span class="guilabel">診断</span>セクションのリストに表示されます:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p><span class="emphasis"><em>用紙ゆがみ</em></span>の値はマーカー（各用紙の四隅の黒い点）位置の認識の妥当性を表します。これが大きすぎるときは、認識結果をチェックする必要があります（ページリストの行の上で右クリックして、<span class="guimenuitem">四隅マーカー確認</span>を選ぶと、スキャンしたページと検出したボックスが表示されます）。</p></li><li class="listitem"><p><span class="emphasis"><em>不確かさ</em></span>の値は、ボックスの黒ピクセル比率と閾値との近さを表します。これが大きすぎる（8から最大値10まで）場合、ボックスのマーク有無判定が正しいかどうかチェックする必要があります（ページリストの行の上で右クリックして<span class="guimenuitem">ボックス拡大</span>を選ぶと、用紙上の全ボックスが表示され、判定結果が正しいか確認し、必要ならボックス画像のドラッグアンドドロップで修正できます）。</p></li></ul></div></div><div class="sect3" title="手動入力"><div class="titlepage"><div><div><h4 class="title"><a id="idp7412928"></a>手動入力</h4></div></div></div><p>スキャナの使用が困難な場合や、いくつかの用紙で自動入力が期待どおりに動作しなかった場合に、手動で入力を行うことができます。このためには、<span class="guilabel">試験実施後のマーク認識</span>のセクションにある<span class="guibutton">手動</span>ボタンによりウィンドウを開きます。このウィンドウでは、目的のページのマークされたボックスを自分で（クリックして）入力することができます。</p><div class="note" title="注記" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[注記]" src="../images/note.png" /></td><th align="left">注記</th></tr><tr><td align="left" valign="top"><p>手動入力を行うと、そのページの自動入力の結果は、以前のものだけでなく以降も含めて上書きされます。</p></td></tr></table></div></div></div><div class="sect2" title="採点"><div class="titlepage"><div><div><h3 class="title"><a id="idp7416832"></a>採点</h3></div></div></div><p>GUIの<span class="guilabel">採点</span>タブでは、<span class="guilabel">採点</span>セクションでスキャンデータから受験者の得点を計算するとともに、受験者が記入したコードを読み取ります（<a class="xref" href="latex.html#latex.codes" title="受験番号取得">「受験番号取得」</a>参照）。</p><div class="sect3" title="採点処理"><div class="titlepage"><div><div><h4 class="title"><a id="idp7419760"></a>採点処理</h4></div></div></div><p>得点の計算は<span class="guibutton">採点</span>ボタンで起動しますが、以下の選択をしておく必要があります:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p><span class="guilabel">採点基準を更新</span>のボックスにチェックすると、採点基準は最初にLaTeXソースファイルから取り出されます。これにより、採点処理において、いろいろな採点基準を試してみることができます。また同時に、どの解答が正解でどれが誤りかも更新されます。したがって、試験実施後でも、問題作成時の正解の誤りを修正することができます。LaTeXファイルで採点基準を設定する方法は<a class="xref" href="graphical-interface.html#bareme" title="採点基準">採点基準</a>の節で説明されます（何も指示しなければデフォルトの採点基準が使用されます）。</p></li></ul></div><p><span class="guibutton">採点</span>ボタンをクリックすると、採点が実行されます（採点基準の更新もする場合は少し時間がかかります）。</p></div><div class="sect3" title="採点基準"><div class="titlepage"><div><div><h4 class="title"><a id="bareme"></a>採点基準</h4></div></div></div><p>採点基準はLaTeXソースファイル内で<span class="command"><strong>scoring</strong></span>コマンドによって指定します。これは<span class="command"><strong>question</strong></span>環境か<span class="command"><strong>questionmult</strong></span>環境で全選択肢の採点基準を設定するのに用いますが、<span class="command"><strong>choices</strong></span>環境においても、各選択肢個別の増減を与えるのに用いることができます。LaTeXのscoringコマンドの引数は、カンマで区切られた<code class="code"><em class="replaceable"><code>parameter</code></em>=<em class="replaceable"><code>value</code></em></code>のような形式から成っています。使用できるパラメータは次のとおりです（各パラメータがどんな文脈で使用できるかも示しています）:</p><div class="informaltable"><table border="1"><colgroup><col width="3pc" align="center" class="param" /><col width="1pc" align="center" class="q" /><col width="1pc" align="center" class="r" /><col width="1pc" align="center" class="qm" /><col width="1pc" align="center" class="rm" /><col align="left" class="valeur" /></colgroup><tbody><tr><td rowspan="2" align="center">parameter</td><td colspan="2" align="center">simple</td><td colspan="2" align="center">multiple</td><td rowspan="2" align="left">value</td></tr><tr><td align="center">Q</td><td align="center">A</td><td align="center">Q</td><td align="center">A</td></tr><tr><td align="center">e</td><td align="center">●</td><td align="center"> </td><td align="center">●</td><td align="center"> </td><td align="left">解答に矛盾があるときに与える素点。単一選択問題で複数のボックスにマークされていたり、複数選択問題で「該当なし」と他のボックスに同時にマークされている場合です。</td></tr><tr><td align="center">v</td><td align="center">●</td><td align="center"> </td><td align="center">●</td><td align="center"> </td><td align="left">解答されていない（どのボックスもマークされていない）ときに与える素点。</td></tr><tr><td align="center">d</td><td align="center"> </td><td align="center"> </td><td align="center">●</td><td align="center"> </td><td align="left">オフセット。eやvのパラメータにかかわらず、素点に加算される値。</td></tr><tr><td align="center">p</td><td align="center"> </td><td align="center"> </td><td align="center">●</td><td align="center"> </td><td align="left">素点の下限。この設問の素点を計算してこの下限を下回ってしまった場合、素点をこの下限値に設定します。</td></tr><tr><td align="center">b</td><td align="center">●</td><td align="center"> </td><td align="center">●</td><td align="center">●</td><td align="left">正解に与える素点。</td></tr><tr><td align="center">m</td><td align="center">●</td><td align="center"> </td><td align="center">●</td><td align="center">●</td><td align="left">誤りに与える素点。</td></tr><tr><td align="center"> </td><td align="center"> </td><td align="center">●</td><td align="center"> </td><td align="center"> </td><td align="left">パラメータはなく（構文: <code class="code">\scoring{2}</code>）、この選択肢にマークした場合に与える素点を示します。</td></tr><tr><td align="center">auto</td><td align="center">●</td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="left">このパラメータを用いると、<em class="replaceable"><code>i</code></em>番目の選択肢の値が<em class="replaceable"><code>auto</code></em>+<em class="replaceable"><code>i</code></em>-1になります。このオプションは主に<code class="code">\QuestionIndicative</code>で用います（<a class="xref" href="latex.html#latex.qr" title="設問と選択肢">設問と選択肢</a>参照）。</td></tr><tr><td align="center">mz</td><td align="center">●</td><td align="center"> </td><td align="center">●</td><td align="center"> </td><td align="left">このパラメータは "満点かゼロか" 方式の採点基準に用いられます。選択がすべて正しければ素点は<em class="replaceable"><code>mz</code></em>になり、そうでなければ0点です。</td></tr><tr><td align="center">haut</td><td align="center"> </td><td align="center"> </td><td align="center">●</td><td align="center"> </td><td align="left">このパラメータに<em class="replaceable"><code>n</code></em>という値を与えると、満点が<em class="replaceable"><code>n</code></em>になり、誤り一つにつき1点減点されます。</td></tr><tr><td align="center">MAX</td><td align="center">●</td><td align="center"> </td><td align="center">●</td><td align="center"> </td><td align="left">この設問の満点を指定します（5点の設問には、MAX=5と書きます）。完答した場合の点数が目的の満点と異なる場合にのみ用います。</td></tr><tr><td align="center">formula</td><td align="center">●</td><td align="center"> </td><td align="center">●</td><td align="center"> </td><td align="left"><code class="code">b</code>や<code class="code">m</code>の値を考慮せず、変数を用いた式（<a class="xref" href="graphical-interface.html#scoring.global" title="全体採点基準">「全体採点基準」</a>参照）などによって、設問に与えられた素点を指定します。</td></tr><tr><td align="center">set.<em class="replaceable"><code>XXX</code></em></td><td align="center">●</td><td align="center">●</td><td align="center">●</td><td align="center">●</td><td align="left"><em class="replaceable"><code>XXX</code></em>という変数に特定の値を指定し、<code class="code">formula</code>で使用できるようにします。選択肢に指定すると、そのボックスがマークされたときだけ値が設定されます。</td></tr><tr><td align="center">default.<em class="replaceable"><code>XXX</code></em></td><td align="center">●</td><td align="center"> </td><td align="center">●</td><td align="center"> </td><td align="left">選択肢によって<em class="replaceable"><code>XXX</code></em>という変数に値が設定されなかった場合の<em class="replaceable"><code>XXX</code></em>の値を指定します。</td></tr><tr><td align="center">requires.<em class="replaceable"><code>XXX</code></em></td><td align="center">●</td><td align="center"> </td><td align="center">●</td><td align="center"> </td><td align="left">解答に矛盾があって設問の得点が<code class="code">e</code>の値に設定される場合を除いて、<em class="replaceable"><code>XXX</code></em>変数が定義されなければならないことを通知します。</td></tr></tbody></table></div><p>単一選択問題でのデフォルトの採点基準は<code class="code">e=0,v=0,b=1,m=0</code>で、正解には1点、そうでなければ0点を与えます。複数選択問題でのデフォルトの採点基準は<code class="code">e=0,v=0,b=1,m=0,p=-100,d=0</code>で、マーク有無の正しい（マークすべきボックスをマークして、マークすべきでないボックスをマークしなかった）選択肢ごとに1点を与えます。</p><p>LaTeXの<span class="command"><strong>\scoring</strong></span>コマンドは、設問定義の外側で用いて、試験全体のパラメータを変更することもできます。</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p><code class="code">SUF=</code><em class="replaceable"><code>x</code></em>は、満点を得るのに十分な素点を定めます。例えば満点を10点とし、<code class="code">SUF=8</code>と設定すると、完答での素点合計にかかわらず、素点合計が6点の受験生は得点として6/8*10=7.5点を得ます。</p></li></ul></div><p>これらのパラメータを組み合わせれば、以下の例のように、様々な種類の採点基準を定義することができます:、</p><p><a id="modeles-scoring.tex"></a></p><pre class="programlisting">\documentclass{article}

\usepackage[utf8x]{inputenc}
\usepackage[T1]{fontenc}

\usepackage[box,completemulti,lang=JA]{automultiplechoice}

\begin{document}

\element{qqs}{
\begin{question}{good choice}
  この設問に何点欲しいですか？
  \begin{choices}
    \correctchoice{満点: 10}\scoring{10}
    \wrongchoice{5点だけ欲しい}\scoring{5}
    \wrongchoice{2点でよい}\scoring{2}
    \wrongchoice{いらない}\scoring{0}
  \end{choices}
\end{question}
}

\element{qqs}{
\begin{questionmult}{added}
  次のボックスをマークしてポイントをゲット:
  \begin{choices}
    \correctchoice{2点}\scoring{b=2}
    \wrongchoice{マイナス1点!}\scoring{b=0,m=-1}
    \correctchoice{3点}\scoring{b=3}
    \correctchoice{1点}
    \correctchoice{0.5点}\scoring{b=0.5}
  \end{choices}
\end{questionmult}
}

\element{qqs}{
\begin{questionmult}{3 or zero}\scoring{mz=3}
  完答なら3点、そうでなければ0点。
  \begin{choices}
    \wrongchoice{誤り}
    \wrongchoice{誤り}
    \correctchoice{正しい}
    \correctchoice{正しい}
  \end{choices}
\end{questionmult}
}

\element{qqs}{
\begin{questionmult}{all for 2}\scoring{haut=2}
  完答なら2点、ミス1件ごとに-1点...
  \begin{choices}
    \correctchoice{正解}
    \correctchoice{これも可}
    \correctchoice{そのとおり!}
    \wrongchoice{ダメ!}
    \wrongchoice{マークするな!}
  \end{choices}
\end{questionmult}
}

\element{qqs}{
\begin{question}{attention}\scoring{b=2}
  ひどい誤りにはマイナス点（-2点）がつきますが、正解なら2点が得られます。
  \begin{choices}
    \correctchoice{正しい!}
    \wrongchoice{正しくない}
    \wrongchoice{正しくない}
    \wrongchoice{正しくない}
    \wrongchoice{ひどい誤り!}\scoring{-2}
  \end{choices}
\end{question}
}

\element{qqs}{
\begin{questionmult}{as you like}
  必要な点数を選んでください:
  \begin{choices}
    \correctchoice{ここなら2点得られます}\scoring{b=2}
    \wrongchoice{マークすると3点あげます}\scoring{b=0,m=3}
    \correctchoice{マークすると1点得ますが、マークしないと1点失います}\scoring{m=-1}
  \end{choices}
\end{questionmult}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\onecopy{20}{

\noindent{\bf QCM  \hfill 採点基準テスト}

\vspace*{.5cm}
\begin{minipage}{.4\linewidth}
\centering\large\bf Test\\ Jan. 2008\end{minipage}
\namefield{\fbox{\begin{minipage}{.5\linewidth}
Name:

\vspace*{.5cm}\dotfill
\vspace*{1mm}
\end{minipage}}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\shufflegroup{qqs}

\insertgroup{qqs}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\clearpage

}

\end{document}</pre></div><div class="sect3" title="全体採点基準"><div class="titlepage"><div><div><h4 class="title"><a id="scoring.global"></a>全体採点基準</h4></div></div></div><p>一つの採点基準をいくつかの設問にまとめて適用したい場合、次の例のようにそれをLaTeXのコマンドに定義することができます:</p><pre class="programlisting">\def\barQmult{haut=3,p=-1}

\begin{questionmult}\scoring{\barQmult}
[...]
\end{questionmult}</pre><p>もう一つの方法はLaTeXの<span class="command"><strong>\scoringDefaultS</strong></span>コマンドと<span class="command"><strong>\scoringDefaultM</strong></span>コマンドを使うことです。これは文書の先頭で（<span class="command"><strong>\onecopy</strong></span>の外側で）用い、それぞれ単一選択問題と複数選択問題のデフォルトの採点基準を与えることができます:</p><pre class="programlisting">\scoringDefaultM{haut=3,p=-1}</pre><p>場合によっては、<span class="emphasis"><em>与えた選択肢の個数に依存して</em></span>全体採点基準が定義できれば、より便利かもしれません。これを行うには、<code class="varname">N</code>という値を用いるだけでできます。例えば、満点を4点とし、ランダムにマークした場合の平均点を1点としたい場合、<code class="code">d=4,b=0,m=-(4-1)*2/N</code>という基準が使えます（すべての選択肢を誤った場合は-2点となります）。これらの式に使用できる演算は、通常の四則演算（<code class="code">+</code> <code class="code">-</code> <code class="code">*</code> <code class="code">/</code>）、条件付演算（ ? : ）、括弧と、任意のperlの演算子です。</p><p>他にも次の変数が使用できます:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p><code class="varname">N</code> は選択肢の個数です。<code class="option">completemulti</code>オプションによる追加分は数えません。</p></li><li class="listitem"><p><code class="varname">NB</code> はマークすべき選択肢の個数です。</p></li><li class="listitem"><p><code class="varname">NBC</code> は正しくマークした選択肢の個数です。</p></li><li class="listitem"><p><code class="varname">NM</code> はマークすべきでない選択肢の個数です。</p></li><li class="listitem"><p><code class="varname">NMC</code> は誤ってマークした選択肢の個数です。</p></li><li class="listitem"><p><code class="varname">IS</code> は、単一選択問題なら1でそうでなければ0です。</p></li><li class="listitem"><p><code class="varname">IMULT</code> は、複数選択問題なら1でそうでなければ0です。</p></li></ul></div></div><div class="sect3" title="採点基準を用いた得点計算"><div class="titlepage"><div><div><h4 class="title"><a id="scoring-result"></a>採点基準を用いた得点計算</h4></div></div></div><p>ここでは受験者の得点の計算方法を説明します。各受験者について:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>各設問に順番に採点基準を適用し、<span class="emphasis"><em>設問別素点</em></span>を求めます。</p></li><li class="listitem"><p>（採点対象外設問を除いて）すべての設問の素点を足し、その受験者の<span class="emphasis"><em>素点合計</em></span>を求めます。</p></li><li class="listitem"><p>（<span class="guimenu">編集</span> → <span class="guimenuitem">設定</span>ウィンドウの<span class="guilabel">プロジェクト</span>タブで）正の<span class="emphasis"><em>満点</em></span>がパラメータとして設定されている場合、受験者の素点合計を<span class="emphasis"><em>素点合計の満点</em></span>（完答での素点合計）で割り、設定されている<span class="emphasis"><em>満点</em></span>を掛けることにより、受験者の<span class="emphasis"><em>得点</em></span>が得られます。これにより、受験者が全問正解していれば、満点を得ることになります。満点を100点に設定した場合、受験者の得点は正解のパーセンテージとみなすことができます。</p></li></ol></div></div></div><div class="sect2" title="受験者の識別"><div class="titlepage"><div><div><h3 class="title"><a id="sec.students.id"></a>受験者の識別</h3></div></div></div><p>このステージは必須ではありません。ここでは、各答案と受験者の結び付け（リンク）をします。受験者の氏名は自動的には読み込まれませんが、現実的な策が2通りあります:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>受験番号を一桁ごとにボックスにマークする方式で、受験者自身に答案用紙に記入してもらうことが可能です。答案用紙にこの方式を用いるためのLaTeXのコマンドが用意されています（<a class="xref" href="latex.html#latex.codes" title="受験番号取得">「受験番号取得」</a>参照）。試験の実施後、受験番号と受験者名を対応づけるリストを用いて、自動的に答案の識別が行われます。</p></li><li class="listitem"><p>受験番号を記入させない場合や、自動識別が（記入ミスなどで）完全にはうまくいかなかった場合には、GUIの補助により手動で受験番号と氏名をリンクすることができます。</p></li></ol></div><p>まず、GUIの<span class="guilabel">採点</span>タブに行きます。</p><div class="sect3" title="受験者名簿"><div class="titlepage"><div><div><h4 class="title"><a id="liste.etudiants"></a>受験者名簿</h4></div></div></div><p>事前に受験者名簿を準備しておかなければなりません。この名簿は、いくつもの試験で再利用することができます。このリストは `<code class="code">#</code>' で始まるコメント行をオプションとしてもつ、次の例のようなCSVファイルです:</p><pre class="programlisting"># STUDENTS / 1ST YEAR
surname:name:id:email
Bienvenüe:Alexis:001:paamc@passoire.fr
Boulix:Jojo:002:jojo.boulix@rien.xx
Noël:Père:003:pere.noel@pole-nord.xx</pre><p>ファイルの冒頭にある `<code class="code">#</code>' で始まる行はコメントです。コメントでない最初の行は（<code class="code">`:'</code> で区切った）カラム名を格納します。その行以降は、受験者1名につき1行で、対応する情報を記入します。必ず<code class="code">name</code>あるいは<code class="code">surname</code>という名前のカラムに受験者名を格納しないと、下で説明する手動リンクでボタン表示ができなくなります。</p><div class="note" title="注記" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[注記]" src="../images/note.png" /></td><th align="left">注記</th></tr><tr><td align="left" valign="top"><p>セパレータの <code class="code">`:'</code> は、カンマ、セミコロン、タブのいずれかに置き換えることができます。しかし、名簿ファイルのすべての箇所で同じセパレータを使わなければなりません。どの文字をセパレータとして（この4種から）選ぶかは、コメントでない最初の行において、どれが最も多く出現するかで決定されます。</p><p>CSVファイルであれば適合するはずです。</p></td></tr></table></div><p>準備した受験者名簿は<span class="guilabel">受験者識別</span>セクションの<span class="guibutton">ファイル登録</span>ボタンにより選択します。そして受験者名簿の中でユニークなキーとなるカラム（一般には、受験番号を格納するカラム）を一つ選ばなければなりません。最後に、自動リンクの準備として、（使用した場合には）LaTeXの<span class="command"><strong>AMCcode</strong></span>コマンドで使用した関連するコード名を選びます。</p></div><div class="sect3" title="リンク"><div class="titlepage"><div><div><h4 class="title"><a id="idp7549136"></a>リンク</h4></div></div></div><div class="sect4" title="自動リンク"><div class="titlepage"><div><div><h5 class="title"><a id="idp7549776"></a>自動リンク</h5></div></div></div><p><span class="guilabel">受験者識別</span>セクションの<span class="guibutton">自動</span>ボタンを押すと、受験者が記入したコードの対応づけが開始します。その結果は、後から（半）手動リンクにより確認したり改善したりできます。</p><div class="warning" title="警告" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Warning"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[警告]" src="../images/warning.png" /></td><th align="left">警告</th></tr><tr><td align="left" valign="top"><p>自動リンクを行うためには、LaTeXソースファイル中に<span class="command"><strong>AMCcode</strong></span>コマンド（<a class="xref" href="latex.html#latex.codes" title="受験番号取得">「受験番号取得」</a>参照）が少なくとも一つ必要です。また、受験者名簿には、<span class="command"><strong>AMCcode</strong></span>が生成したボックスに記入されるはずの参照（一般には受験番号）を格納したカラムが必要です。</p></td></tr></table></div></div><div class="sect4" title="手動リンク"><div class="titlepage"><div><div><h5 class="title"><a id="idp7555088"></a>手動リンク</h5></div></div></div><p>受験者の氏名を読み取るためのウィンドウを開くには、<span class="guilabel">受験者識別</span>セクションの<span class="guibutton">手動</span>ボタンをクリックします。このウィンドウは、上部に受験者が記入した氏名の画像が順番に表示され、下部に名簿にある受験者ごとにボタンが並び、さらに右側には答案用紙の一覧で区別できるようになっています。各ページについて、上部に提示された氏名に対応したボタンをクリックします（デフォルトでは識別できなかった答案だけが表示されますが、「<span class="guilabel">リンク済も表示</span>」ボックスにチェックすれば変更できます）。すべてのページを読み取れたら、氏名の画像のかわりに青い背景が表示され、最後に<span class="guibutton">保存</span>ボタンをクリックしてリンクを終了するだけです。</p></div></div></div><div class="sect2" title="採点表のエクスポート"><div class="titlepage"><div><div><h3 class="title"><a id="idp7560352"></a>採点表のエクスポート</h3></div></div></div><p>このステージでは、<span class="guibutton">エクスポート</span>ボタンを使って、採点表をさまざまな形式（現在のところ、CSVとOpenOffice）で取り出せます。エクスポートすると、それに引き続いて、（可能なら）エクスポートされたファイルが適切なソフトウェアで開かれます。</p><div class="sect3" title="ODS（OpenOffice、LibreOffice）へのエクスポート"><div class="titlepage"><div><div><h4 class="title"><a id="idp7562304"></a>ODS（OpenOffice、LibreOffice）へのエクスポート</h4></div></div></div><p>エクスポートされたファイルでは、以下の色が使われています:</p><div class="variablelist"><dl><dt><span class="term">灰色</span></dt><dd><p>は、<span class="emphasis"><em>適用外</em></span>に使われます。これは例えば、欠席者の得点や、その受験者には表示されなかった設問の素点です。</p></dd><dt><span class="term">黄色</span></dt><dd><p>は、受験者が無回答のままにした設問に使われます。</p></dd><dt><span class="term">赤色</span></dt><dd><p>は、選択が<span class="emphasis"><em>無効</em></span>だった設問に使われます。単一選択問題に複数のマークをした場合や、<span class="emphasis"><em>該当なし</em></span>ボックス<span class="emphasis"><em>と</em></span>それ以外のボックスをマークした場合です。</p></dd><dt><span class="term">紫色</span></dt><dd><p>は、採点対象外の設問に使われます。</p></dd></dl></div></div></div><div class="sect2" title="採点記入"><div class="titlepage"><div><div><h3 class="title"><a id="idp7572304"></a>採点記入</h3></div></div></div><p><span class="guibutton">採点記入</span>ボタンを押すと、答案への採点記入が始まります。各スキャンデータに、次のように記入されます（これらはデフォルトの記入書式で、設定で変更できます）:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>受験者が誤ってマークしたボックスには、赤い円が記入されます。</p></li><li class="listitem"><p>マークすべきボックスにマークされていない場合は、赤いチェック印が記入されます。</p></li><li class="listitem"><p>マークすべきボックスにマークされている場合は、青いチェック印が記入されます。</p></li><li class="listitem"><p>各設問について、取得した素点と満点が記入されます。</p></li><li class="listitem"><p>答案全体の得点が答案の最初のページに記入されます。</p></li></ul></div><p>答案の最初のページに記入されるテキストは設定で変更可能です（<span class="guimenu">編集</span> → <span class="guimenuitem">設定</span> → <span class="guimenuitem">採点記入</span> → <span class="guimenuitem">ヘッダー</span>、または、<span class="guimenu">編集</span> → <span class="guimenuitem">設定</span> → <span class="guimenuitem">プロジェクト</span> → <span class="guimenuitem">答案の採点記入</span> → <span class="guimenuitem">ヘッダーテキスト</span>）。設定されたテキストに対して、次のように置換が行われます（これらの値の意味については<a class="xref" href="graphical-interface.html#scoring-result" title="採点基準を用いた得点計算">「採点基準を用いた得点計算」</a>をご覧ください）:</p><div class="variablelist"><dl><dt><span class="term"><code class="literal">%S</code></span></dt><dd><p>は受験者の<span class="emphasis"><em>素点合計</em></span>に置換されます。</p></dd><dt><span class="term"><code class="literal">%M</code></span></dt><dd><p>は<span class="emphasis"><em>素点合計の満点</em></span>に置換されます。</p></dd><dt><span class="term"><code class="literal">%s</code></span></dt><dd><p>は受験者の<span class="emphasis"><em>得点</em></span>に置換されます。</p></dd><dt><span class="term"><code class="literal">%m</code></span></dt><dd><p>は<span class="emphasis"><em>満点</em></span>に置換されます。</p></dd><dt><span class="term"><code class="literal">%(ID)</code></span></dt><dd><p>は受験者名に置換されます。</p></dd><dt><span class="term"><code class="literal">%(<em class="replaceable"><code>COL</code></em>)</code></span></dt><dd><p>は受験者名簿内の<em class="replaceable"><code>COL</code></em>の値に置換されます。</p></dd></dl></div><p>この処理は各ページに行われ、PDF形式の採点記入済の答案用紙が得られます。受験者の答案を格納するPDFファイル名は、<span class="guilabel">ファイル名テンプレート</span>フィールドで指示したテンプレートによって決められます。テンプレートでは、「(<em class="replaceable"><code>col</code></em>)」は受験者名簿内の<em class="replaceable"><code>COL</code></em>の値に置換されます（<a class="xref" href="graphical-interface.html#liste.etudiants" title="受験者名簿">受験者名簿</a>参照）。このフィールドを空にすると、試験問題番号と受験者名からなるデフォルト値が使用されます。</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="latex.html">戻る</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="ar01s07.html">次へ</a></td></tr><tr><td width="40%" align="left" valign="top">LaTeXソースファイル </td><td width="20%" align="center"><a accesskey="h" href="index.html">ホーム</a></td><td width="40%" align="right" valign="top"> 非標準の使用方法</td></tr></table></div></body></html>
