<html>
<head>
<title>AOLserver</title>
</head>
<body>

<h1>AOLserver Detailed Configuration Reference</h1>

<p>
<small>
$Header: /cvsroot/aolserver/aolserver.com/docs/admin/config-detailed.html,v 1.2 2002/03/20 21:39:02 kriston Exp $
</small>
<p>


<font color=red><b>Please visit the <a
href=config-reference.tcl.txt>Annotated Configuration Reference</a>
first.  Where the documents differ, the Annotated Configuration
Reference always takes precedence.</b></font>

<p>

 The Parameters Section

<p>

 ns/parameters

<p>

This section is used to specify global AOLserver parameters.

<p>

  Parameter

<p>

Default Value

<p>

Description

<p>

AuxConfigDir

<p>

A directory containing additional configuration files whose contents
will be merged with the primary configuration file. After loading the
primary configuration file (the value of the -c parameter on the nsd
command line, usually nsd.ini), any files in the directory specified
by AuxConfigDir with an .ini extension are loaded in alphabetical
order.

<p>

If a configuration file section in an auxiliary configuration file
already exists in the primary configuration file, the key/value pairs
in that section are added to the  end of the existing section from the
primary configuration file. If, as a  result, a specific parameter is
set more than once in a section, the first setting will be used.
Therefore, a parameter set in an auxiliary configuration file cannot
override the same parameter set in the primary configuration file or
in an auxiliary configuration file loaded before it.  Some parameters,
such as the Map parameters in  the CGI section, can have multiple
settings.  In this case, all Map parameter settings will be used.

<p>

CheckExitCode

<p>

off

<p>

Boolean value. If set to on, an error is reported when a child process
exits with a non-zero status.

<p>

CrashCmd

<p>

The name of a Tcl function which, when executed, will crash the
server.

<p>

Debug

<p>

off

<p>

Boolean value. If set to on, debug messages will be printed to the
global server log. Note: Setting Debug on will produce a large amount
of debug output.

<p>

DNSCache

<p>

on

<p>

Boolean. If set to on, enables DNS cache to speed lookup of remote IP
addresses. Since the DNS cache can dramatically speed lookup time,
especially in the case of a busy server with the nslog module set to
resolve host names, it is recommended that DNSCache be left on.

<p>

DNSCacheTimeout

<p>

60

<p>

The number of minutes between cache purges for the DNS cache.

<p>

Gid

<p>

(If neither Gid nor Group is set, the default group of the user
specified by the User parameter is used.)

<p>

Unix group number.

<p>

Group

<p>

(If neither Gid nor Group is set, the default group of the user
specified by the User parameter is used.)

<p>

Unix group name. This parameter is ignored if the gid parameter is
set.

<p>

Home

<p>

The AOLserver home directory (the directory where AOLserver was
installed). This parameter is required.

<p>

ListenBacklog

<p>

32

<p>

The maximum length of the queue of pending connections.

<p>

LogMaxBackup

<p>

10

<p>

The maximum number of server log backup files.

<p>

LogRoll

<p>

on

<p>

Boolean value. If set to on, the server log file will be rolled on a
SIGHUP.

<p>

MailHost

<p>

localhost

<p>

The SMTP server AOLserver should use when sending email using the Tcl
ns_sendmail function.

<p>

PidFile

<p>

serverhome/log

<p>

/nspid.setup-server-port

<p>

The pathname of the file where the server puts its pid.

<p>

ServerLog

<p>

/log/server.log under the AOLserver home directory

<p>

The file to contain any notices, warnings, or errors generated by
AOLserver if AOLserver is run as a background process. If AOLserver is
run in the foreground, messages are written to standard output, and
this parameter is ignored.

<p>

SockNoWarn

<p>

off

<p>

Boolean value. If set to on, errors encountered while making outgoing
tcp connections will be logged.

<p>

StackSize

<p>

SGI and DEC OSF: 32000

<p>

All others: the operating system default

<p>

The thread stack size. You may need to increase this parameter if an
AOLserver request function or Tcl script is deeply nested, exhausting
the stack space of the thread. If AOLserver is configured to use ADPs,
for example, you may want to increase the thread stack size to 128K or
more.

<p>

Uid

<p>

Unix uid which can be set instead of setting the User parameter.

<p>

User

<p>

The user name that AOLserver is to be run as. If you start the
AOLserver as the root user, you must set this parameter. If you have
selected a port number below 1024 (a "privileged" port), you will need
to start the AOLserver as the "root" and specify a Unix user for the
server to change to after it acquires the port. If your port number is
greater than 1024, you can leave this blank.

<p>

 The MIME Types Section

<p>

The ns/mimetypes configuration file section allows you to have global
settings for MIME types.

<p>

 ns/mimetypes

<p>

This section is used to map file name extensions to the content-type
headers returned to browsers. Each parameter specifies an extension
and the type to return. Any extension and content-type pair specified
here will either override the default setting (if the extension is the
same as a default extension) or be added to the default settings (if
the extension does not exist in the default settings).

<p>

Parameter

<p>

Default Value

<p>

Description

<p>

Default

<p>

The default MIME type to use if there is no explicit mapping specified
for a file name extension.

<p>

NoExtension

<p>

The MIME type to use for files with no extension.

<p>

file-extension

<p>

type (default MIME types listed below)

<p>

A content-type to return in the header information for the specified
file extension.

<p>

The default MIME type parameter definitions are:

<pre>
 .ai application/postscript
 .aif audio/aiff
 .aiff audio/aiff
 .ani application/x-navi-animation
 .art image/x-art
 .au audio/basic
 .avi video/x-msvideo
 .bin application/x-macbinary
 .bmp image/bmp
 .dcr application/x-director
 .dir application/x-director
 .dp application/commonground
 .dxr application/x-director
 .elm text/plain
 .exe application/octet-stream
 .gbt text/plain
 .gif image/gif
 .gz application/x-compressed
 .hqx application/mac-binhex40
 .htm text/html
 .html text/html
 .jfif image/jpeg
 .jpe image/jpeg
 .jpg image/jpeg
 .jpeg image/jpeg
 .js application/x-javascript
 .ls application/x-javascript
 .map application/x-navimap
 .mocha application/x-javascript
 .mov video/quicktime
 .mpe video/mpeg
 .mpeg video/mpeg
 .mpg video/mpeg
 .nvd application/x-navidoc
 .nvm application/x-navimap
 .pbm image/x-portable-bitmap
 .pdf application/pdf
 .pgm image/x-portable-graymap
 .pic image/pict
 .pict image/pict
 .pnm image/x-portable-anymap
 .ps application/postscript
 .qt video/quicktime
 .ra audio/x-pn-realaudio
 .ram audio/x-pn-realaudio
 .ras image/x-cmu-raster
 .rgb image/x-rgb
 .rtf application/rtf
 .sit application/x-stuffit
 .snd audio/basic
 .stl application/x-navistyle
 .tar appliation/x-tar
 .text text/plain
 .tgz application/x-compressed
 .tif image/tiff
 .tiff image/tiff
 .txt text/plain
 .vrml x-world/x-vrml
 .wav audio/x-wav
 .wrl x-world/x-vrml
 .xbm image/x-xbitmap
 .xpm image/x-xpixmap
 .z application/x-compressed
 .zip application/x-compressed
</pre>

 The Servers Sections

<p>

 ns/servers

<p>

This section lists (and names) each of the servers that are to be run
within the AOLserver process.

<p>

Parameter

<p>

Possible Values

<p>

Description

<p>

servername

<p>

"description text"

<p>

The name (user-defined) of a server, which must be all lowercase. The
description text can be any user-defined comments.

<p>

 ns/server/servername

<p>

This section configures a server. There should be one of these
sections for each server listed in the ns/servers section if you want
to change any of the default settings for the parameters.

<p>

 Parameter

<p>

Default Value

<p>

Description

<p>

ConnsPerThread

<p>

100

<p>

After the specified number of connections, a connection thread will
exit. This parameter is useful for working around memory leaks in Tcl
code.

<p>

DirectoryFile

<p>

index.htm, index.html

<p>

A comma-separated list of default files to get if the URL specifies
only a directory. For example:

<p>

DirectoryFile "index.htm,index.html"

<p>

This server will try each of the filenames in the list, left to right.

<p>

EnableAOLpress

<p>

on

<p>

If set to on, "NaviServer/2.0 " is prepended to the Server: output
header.

<p>

KeepAliveTimeout

<p>

30

<p>

Number of seconds after which to hang up on clients while waiting for
an HTTP request in a connection: keep-alive situation.

<p>

MaxConnections

<p>

100

<p>

Maximum number of concurrent HTTP connections (should be equal to
MaxThreads).

<p>

MaxThreads

<p>

50

<p>

The maximum number of threads this server can use within the AOLServer
process. If more threads are requested than MaxThreads, the requests
will be forced to wait until the number of waiting requests drops
below MaxThreads.

<p>

MaxKeepAlive

<p>

100

<p>

Maximum number of connections which can use HTTP keep-alive; should be
equal to MaxConnections,

<p>

MinThreads

<p>

0

<p>

The number of threads in the AOLserver process to initialize when this
server is started.

<p>

PageRoot

<p>

/servers/server/pages

<p>

Directory where pages and graphics for this server are stored.

<p>

Realm

<p>

The realm in which to request authentication when returning a "401
Unauthorized" error.

<p>

SockTimeout

<p>

30

<p>

Number of seconds to wait for an HTTP request before closing the
connection.

<p>

ThreadTimeout

<p>

120

<p>

Number of seconds for threads to live with no connection.

<p>

 ns/server/servername/adp

<p>

This section is used to configure AOLserver Dynamic Pages (ADPs).

<p>

Parameter

<p>

Default Value

<p>

Description

<p>

Cache

<p>

on

<p>

Boolean value. If set to on, ADP caching is enabled.

<p>

DebugInit

<p>

"ns_adp_debuginit"

<p>

The procedure to run when debugging begins.

<p>

DefaultParser

<p>

"adp"

<p>

The default parser to use for ADPs with a file extension that is not
associated with a parser in the ns/server/servername/adp/parsers
section. For example:

<pre>
ns_section "ns/server/server1/adp"
ns_param "map" "/*.adp"
ns_param "map" "/*.inc"
ns_param "map" "/*.fadp"
ns_param "DefaultParser" "adp"
</pre>
<p>

EnableExpire

<p>

off

<p>

Boolean value. If set to on, the "Expires: now" header is set on all
outgoing ADPs.

<p>

EnableDebug

<p>

off

<p>

Boolean value. If set to on, appending "?debug" to a URL will enable
TclPro debugging.

<p>

Map

<p>

The Map parameter specifies which pages the server will parse. You can
specify a file extension (such as /*.adp) or a directory (such as
/usr/pages/adp). If no directory is specified, the pages directory is
assumed. The wildcards * ? and [] can be included in the Map
specification. You can specify multiple Map settings.

<p>

The following example specifies that all files in the pages directory
with the extensions .adp or .asp will be parsed, and all files in the
/usr/pages/myadps directory will be parsed.

<pre>
 Map "/*.adp"
 Map "/*.asp"
 Map "/foo/myadps"
</pre>

StartPage

<p>

The file to be run on every connection instead of the requested ADP.
It can be used to perform routine initialization. It would then
usually include the requested ADP by calling:

<p>

ns_adp_include [ns_adp_argv 0]

<p>

TagLocks

<p>

off

<p>

Boolean value. If set to on, ADP tags may be registered after server
startup. Pages will be served less quickly when this is turned on.

<p>

If set to off, ADP tags can only be registered before the first ADP is
served.

<p>

 ns/server/servername/adp/parsers

<p>

This section is used to configure ADP parsers. For more information on
ADP parsers, see the AOLserver Tcl Developer's Guide.

<p>

Parameter

<p>

Valid Value

<p>

Description

<p>

parser-name

<p>

file-extension

<p>

An association between an ADP parser and a file extension. The
specified parser will be used to parse all ADPs with the specified
file extension.

<p>

Two pre-defined parsers, "adp" and "fancy", are already registered.
You can register additional parsers with the Ns_AdpRegisterParser C
API function. For example:

<pre>
 ns_section "ns/server/server1/adp/parsers"
 ns_param "adp" ".adp"
 ns_param "fancy" ".fadp"
</pre>

<p>

 ns/server/servername/db

<p>

This section specifies the database pools that will be accesible by a
server. The available database pools are listed in the ns/db/pools
section. There should be one of these sections for each server if you
want to restrict a server's access to a subset of the available
database pools.

<p>

Parameter

<p>

Default Value

<p>

Description

<p>

DefaultPool

<p>

The default pool for the ns_conn db and ns_db gethandle Tcl functions
to access.

<p>

Pools

<p>

(no database pools are accessible by default)

<p>

A comma-delimited list of pool names specifying the pools that are to
be accessible from this server, or "*" to signify that all pools
should be accessible.

<p>

The available pools are listed in the ns/db/pools section.

<p>

 ns/server/servername/fastpath

<p>

This section configures fastpath for a specific server. There should
be one of these sections for each server if you want to change any of
the default settings for the parameters.

<p>

Parameter

<p>

Default Value

<p>

Description

<p>

DirectoryFile

<p>

index.htm, index.html

<p>

A comma-separated list of default files to get if the URL specifies
only a directory. For example:

<p>

DirectoryFile "index.htm,index.html"

<p>

This server will try each of the filenames in the list, left to right.

<p>

MMap

<p>

off

<p>

If set to on, uses the potentially faster mmap method of sending
files. Not all socket drivers implement this.

<p>

Cache

<p>

on

<p>

If set to on, enables file caching.

<p>

CacheMaxEntry

<p>

8192

<p>

Maximum size of a file to cache. Files larger than this won't be
cached.

<p>

CacheMaxSize

<p>

5120000

<p>

Maximum size for file cache, per thread. The actual maximum memory
usage will be this number times MaxThreads.

<p>

PageRoot

<p>

/servers/server/pages

<p>

Directory where pages and graphics for this server are stored.

<p>

 ns/server/servername/redirects

<p>

This section configures redirects for a specific server. There should
be one of these sections for each server if you want to change any of
the default settings for the parameters.

<p>

Parameter

<p>

Default Value

<p>

Description

<p>

status

<p>

url

<p>

When returning the specified status, send a redirect to the specified
url. You can define multiple status and url pairs.

<p>

 ns/server/servername/tcl

<p>

This section configures Tcl for a specific server. There should be one
of these sections for each server if you want to change any of the
default settings for the parameters.

<p>

Parameter

<p>

Default Value

<p>

Description

<p>

AutoClose

<p>

on

<p>

If AutoClose is on, all non-shared files opened by an individual
interpreter in the group will be closed when Ns_TclDeAllocateInterp is
invoked. (Other interpreters in the group are not affected.)
Ns_TclDeAllocateInterp is called after each Tcl request procedure.

<p>

It is recommended that you leave the AutoClose parameter set to on and
share files between interpreters.

<p>

Debug

<p>

Off

<p>

Boolean value. If set to On, names of files sourced during startup are
written to the server log.

<p>

Library

<p>

/servers/server1/modules/tcl

<p>

Directory for private Tcl script library for this server. Tcl scripts
in this private library will override identically-named Tcl scripts in
the shared Tcl library.

<p>

 ns/server/servername/modules

<p>

This section lists the AOLserver modules that are to be loaded into a
server. There should be one of these sections for each server listed
in the ns/servers section.

<p>

The name of the module can be any name you choose, but it must then be
referenced as the module name in the appropriate
ns/server/servername/module/module-name section. For example, if you
set mylog to nslog.so, you must configure the module in a section
called ns/server/servername/module/mylog instead of
ns/server/servername/module/nslog.

<p>

The file specified as the usual value for each parameter exists in the
bin directory under the AOLserver home directory by default. If it
resides somewhere else, include an absolute path specification along
with the file.

<p>

Parameter

<p>

Usual Value

<p>

Description

<p>

nscgi

<p>

nscgi.so

<p>

If present, enables CGI support for this server. Configure CGI in the
ns/server/servername/module/nscgi section.

<p>

nscp

<p>

nscp.so

<p>

If present, enables the control port administration interface for the
server.

<p>

nslog

<p>

nslog.so

<p>

If present, enables an access log for this server.Configure the access
log in the ns/server/servername/module/nslog section.

<p>

nsperm

<p>

nsperm.so

<p>

If present, enables access control capabilities for this server.
Configure these capabilities in the
ns/server/servername/module/nsperm section.

<p>

nssock

<p>

nssock.so

<p>

If present, allows TCP/IP sockets connection for this server.Configure
the sockets connection in the ns/server/servername/module/nssock
section.

<p>

nsvhr

<p>

nsvhr.so

<p>

If present, enables virtual host redirection, which allows you to
proxy requests to different servers.

<p>

 ns/server/servername/module/nscgi

<p>

This section configures CGI for a server. There should be one of these
sections for each server that includes the nscgi module if you want to
change any of the default settings for the parameters.

<p>

Parameter

<p>

Default Value

<p>

Description

<p>

BufferSize

<p>

8192

<p>

The number of bytes to buffer before sending them out to the browser.

<p>

Debug

<p>

off

<p>

Boolean value. If set to On, extra debugging is enabled.

<p>

Environment

<p>

Specifies a section in the configuration file to be used as the
default environment for CGI scripts run on this server. For example,
if you set Environment to CGIenv, you must include a
ns/environment/CGIenv section in the configuration file containing
environment variable definitions. The environment variables will be in
addition to the standard CGI variables.

<p>

GetHostByAddr

<p>

off

<p>

Boolean value. If set to Off (the default), REMOTE_HOST will be the
same as REMOTE_ADDR, thereby improving performance by eliminating
reverse lookup requests. If set to On, a reverse lookup request is
used to supply the REMOTE_HOST value.

<p>

Interps

<p>

Specifies a section in the configuration file to define mappings
between extensions of CGI script files and programs. For example, if
you set Interp to CGIinterps, you must include a ns/interps/CGIinterps
section in the configuration file containing appropriate mappings. See
below for a description of the format of an Interps section.

<p>

Limit

<p>

0 (unlimited)

<p>

Maximum number of concurrent CGI processes.

<p>

Map

<p>

Method, URL, and directory where CGI programs reside. A trailing slash
on the URL is not allowed. The directory must be an absolute pathname.
A trailing slash on the directory is optional. If the directory is
missing, the pages directory is assumed. Examples:

<p>

Map "GET /cgi /usr/local/cgi"

<p>

Map "POST /*.cgi"

<p>

You may have more than one Map entry. Typically, there are at least
Map entries for the GET and POST methods.

<p>

MaxOutput

<p>

10240

<p>

Maximum number of bytes of output the CGI program can send.

<p>

SystemEnvironment

<p>

off

<p>

Boolean value. If set to on, sets the ??? environment variable.

<p>

 ns/server/servername/module/nscp

<p>

This section configures the control port, through which you can
administer the server. There should be one of these sections for each
server that includes the nscp module if you want to change any of the
default settings for the parameters.

<p>

Parameter

<p>

Default Value

<p>

Description

<p>

Address

<p>

"127.0.0.1"

<p>

The address to bind to.

<p>

Binary

<p>

"bin/nscp"

<p>

The path for the control port executable.

<p>

InitCmds

<p>

Commands to be executed by the control port when it starts. For
example, to automatically view the log when you log into the control
port, set this parameter as follows:
 ns_param initcmds "tail -f
log/server.log&"

<p>

Port

<p>

9999

<p>

The port to listen on. To access the administration interface, telnet
to the specified Port at the specified Address. For example:

<pre>
telnet localhost 9999
</pre>

<p>

 ns/server/servername/module/nscp/users

<p>

This section the users allowed to access the control port for the
server. There should be one of these sections for each server that
includes the nscp module if you want to change any of the default
settings for the parameters.

<p>

ns_param user "username:encrypted-password"

<p>

 ns/server/servername/module/nslog

<p>

This section configures the nslog module for a server. There should be
one of these sections for each server that includes an nslog module if
you want to change any of the default settings for the parameters.

<p>

Parameter

<p>

Default Value

<p>

Description

<p>

File

<p>

access.log

<p>

The name of the file where the access log is to be stored. If no
directory is specified, the file will be created in the
/servers/servername/modules/nslog directory. If you specify only an
absolute or relative directory and no filename, the file access.log
will be created in that directory.

<p>

Accesses are logged in CERN Common Logfile Format.

<p>

FormattedTime

<p>

On

<p>

Boolean value. If set to On, nslog will use the common log format for
the timestamp. When Off, the time will be logged as seconds since Jan
1 1970. That will provide a small speedup in heavily accessed sites
because of locking that occurs in performing timzeone conversions.

<p>

LogCombined

<p>

off

<p>

Boolean value. If set to on, logs will be generated in the NCSA
combined log format. The NCSA combined log format will include the
referring URL and the user agent (so you can turn off LogRefer and
LogUserAgent), and it will not surround them with double quotes.

<p>

MaxBackup

<p>

5

<p>

The maximum number of access logs that will be saved. This amount
includes the current access log. For example, a value of 5 means the
current access log plus 4 backup logs.

<p>

RollHour

<p>

0 (midnight)

<p>

The hour at which the access log will be rolled on the day or days
specified by the RollDay parameter. The hour must be specifed as an
integer from 0 to 23 representing the hour in military time.

<p>

RollLog

<p>

on

<p>

Boolean value. If set to On, the access log is rolled according to the
settings for the RollDay and RollHour parameters. If set to Off, log
entries will be written to the same access log indefinitely. However,
the access log can still be rolled on SIGHUP if the RollOnSignal
parameter is set to On (the default).

<p>

RollOnSignal

<p>

on

<p>

Boolean value. The default, "on", specifies that the access log will
be rolled when a SIGHUP signal is sent to the process id of the
running server. The process id can be found in the file specified by
the PidFile parameter.

<p>

If set to "off", the access log will not be rolled when a signal is
sent.

<p>

 ns/server/servername/module/nsperm

<p>

This section configures the nsperm module for a server. There should
be one of these sections for each server that includes an nsperm
module if you want to change any of the default settings for the
parameters.

<p>

Parameter

<p>

Default Value

<p>

Description

<p>

SkipLocks

<p>

on

<p>

Boolean value. If set to on, permissions lookups will be faster, but
no permissions settings may be added while the server is running.

<p>

 ns/server/servername/module/nssock

<p>

This section configures the nssock module for a server. Each server
must have an nssock module loaded. There should be one of these
sections for each server that includes an nssock module if you want to
change any of the default settings for the parameters.

<p>

Parameter

<p>

Default Value

<p>

Description

<p>

Address

<p>

IP Address or hostname where this server listens for requests. If this
parameter is not set, AOLserver will listen on all interfaces. This
means that if one server does not set an address, no other server may
use the same Port.

<p>

Hostname

<p>

AOLserver queries the DNS (Domain Name Service) for the host name.

<p>

Host name used in response to clients. This may be an alias for your
site, such as www.avalon.com. Make sure the IP address of the Hostname
you set is valid or users will be unable to process redirects from
your site.

<p>

Location

<p>

The URL that redirects come back to. This parameter is useful when the
server machine is part of a group of machines responding to requests
through a DNS rotor. By default, the server will use http://hostname
as the location.

<p>

Port

<p>

80

<p>

Port number where this server listens for requests. If two servers use
the same port, they must use different Addresses.

<p>

 ns/server/servername/module/nsvhr

<p>

This section configures the nsvhr module for a server. There should be
one of these sections for each server that includes an nsvhr module if
you want to change any of the default settings for the parameters.

<p>

  Parameter

<p>

Default Value

<p>

Description

<p>

BusyURL

<p>

An URL to redirect to if a proxy attempt times out.

<p>

ErrorURL

<p>

An URL to redirect to when an unknown host is requested or the host
could not be reached.

<p>

Method

<p>

A method to proxy. Can be GET, POST, or HEAD. This parameter may be
specified multiple times.

<p>

Timeout

<p>

30

<p>

The number of seconds to wait for a back-end host while proxying.

<p>

 ns/server/servername/module/nsvhr/maps

<p>

This section configures the nsvhr module for a server. There should be
one of these sections for each server that includes an nsvhr module if
you want to change any of the default settings for the parameters.

<p>

Parameter

<p>

Default Value

<p>

Description

<p>

hostname

<p>

url

<p>

If a request comes in with Host: hostname, the request will be proxied
to the specified url. For example:

<p>

phony.hosting.com=http://127.0.0.0:2000/

<p>

phony2.hosting.com=unix://phony2

<p>

The phony2 domain is a UNIX domain socket file name defined in the
ns/server/servername/module/nsunix section. The syntax for the UNIX
domain socket file name follows the URL syntax of a host name. The
unix:// prefix is required before the socket file name.

<p>

 ns/server/servername/module/nsunix

<p>

This section configures the nsunix module for a server. This section
is needed if you want the nsvhr module to proxy over a UNIX domain
socket instead of a TCP socket. Initially, this driver accepts a
connection on a Unix domain socket and receives a message sent by
nsvhr.so. The message contains the passed file descriptor of the
connection socket and the initial data from that connection socket.
The rest of the data is read from the passed file descriptor after the
initial data has been consumed from the message. These are the
required parameters:.

<p>

  Parameter

<p>

Default Value

<p>

Description

<p>

Hostname

<p>

Host name used in response to clients. This may be an alias for your
site, such as www.avalon.com. Make sure the IP address of the Hostname
you set is valid or users will be unable to process redirects from
your site.

<p>

Port

<p>

Port number where this server listens for requests.

<p>

SocketFile

<p>

The file name for the UNIX domain socket. It follows the same syntax
of a host name named by the Hostname parameter. No slashes (/) are
permitted in the file name, but the dot (.), dash (-), and underscore
(_) characters are permitted. The socket file is created in the
modules/nsunix/ directory. For example:

<p>

ns_param SocketFile "server2.nsunix"

<p>

There is a comprehensive sample nsd.tcl file in the nsvhr/ directory
that shows how to configure the nsvhr module to proxy to a nsunix
module of a different server. The two servers are started with these
commands:

<pre>
bin/nsd -s server1 -f -t nsd.tcl
bin/nsd -s server2 -f -t nsd.tcl
</pre>

<p>

 Database Drivers and Pools

<p>

 ns/db/drivers

<p>

This section lists the available database drivers to be used with the
database pools. The name of the driver can be any name you choose, but
it must then be referenced as the driver name in the appropriate
ns/db/driver/driver-name section. Note that the driver parameter in
the ns/db/pool/pool-name section must also reference the driver name
to associate a database driver with a particular database pool.

<p>

The file specified as the usual value for each parameter exists in the
bin directory under the AOLserver home directory by default. If it
resides somewhere else, include an absolute path specification along
with the file.

<p>

Parameter

<p>

Usual Value

<p>

Description

<p>

postgres

<p>

nspostgres.so

<p>

If present, enables the Postgres database driver. No configuration is
necessary for the Postgres driver.

<p>

solid

<p>

nssolid.so

<p>

If present, enables the SOLID database driver. No configuration is
necessary for the SOLID driver.

<p>

extname

<p>

nsext.so

<p>

The external database driver name. There can be multiple
(uniquely-named) instances of this parameter, one for each proxy
daemon interface. By convention, the external driver names are
prepended with "ext". For example: extIll or extSyb.

<p>

 ns/db/driver/extname

<p>

This section configures an external database driver. There should be
one of these sections in your configuration file if an external driver
is listed in the ns/db/drivers section and you want to change any of
the default settings for the parameters

<p>

Parameter

<p>

Usual Value

<p>

Description

<p>

LocalDaemon

<p>

Sybase: nssybpd

<p>

The local database proxy daemon.

<p>

Use this parameter only for local database proxy daemons.

<p>

MaxElement-Size

<p>

32K

<p>

An integer value specifying the maximum element size for an external
database driver.

<p>

RemoteHost

<p>

A remote host name. Use this parameter only for remote database proxy
daemons.

<p>

RemotePort

<p>

A remote port number. Use this parameter only for remote database
proxy daemons.

<p>

Param

<p>

/usr/local/miadmin/MiParams

<p>

For Sybase, the value of the SYBASE environment variable.

<p>

TrimData

<p>

off

<p>

Boolean value. For Sybase. If set to On, the external driver will trim
from the right the data returned by the Sybase server. This parameter
is useful when, for example, you don't want all the empty whitespace
from a 32-character char or when "empty" varchars are returning a
non-empty 2-byte value.

<p>

Note that this will probably corrupt image types that are holding
binary data in a BLOB (the "text" type in Sybase), so it is
recommended that you leave this parameter Off if you're working with
BLOBs.

<p>

 ns/db/pools

<p>

This section lists (and names) each of the available database pools
for AOLserver.

<p>

Parameter

<p>

Default Value

<p>

Description

<p>

pool-name

<p>

pool description

<p>

The name (user-defined) of a database pool, which is actually a
collection of connections accessible to AOLserver to the associated
database. The database connection itself is configured in the
ns/db/pool/pool-name section.

<p>

The pool description can be any user-specified comments about the
pool.

<p>

 ns/db/pool/pool-name

<p>

This section configures a database pool. There should be one of these
sections for each database pool listed in the ns/db/pools section.

<p>

  Parameter

<p>

Default Value

<p>

Description

<p>

Connections

<p>

2

<p>

The maximum number of connections that can be established at any one
time. The server automatically makes connections as needed up to this
maximum number. If additional connections are requested during
processing, the requests must wait.

<p>

Note: Some databases do not handle multiple connections very well. In
this case, you should set Connections to 1 (one).

<p>

Datasource

<p>

Postgres: host:port:database

<p>

Solid: TCP/IP hostname port

<p>

The location and name of the database, according to the specifications
of the database being used.

<p>

Driver

<p>

Value can be any driver named in the ns/db/drivers section: postgres
(for Postgres), solid (for SOLID), or an external database driver.

<p>

LogSQLErrors

<p>

off

<p>

Boolean value. If set to On, SQL errors are written to the server log
along with the offending SQL statement(s). If set to Off and Verbose
is also Off, SQL errors are not written to the server log.

<p>

MaxIdle

<p>

600

<p>

The maximum length of time in seconds that a database connection
within this pool can remain open and idle.

<p>

The default setting causes connections that are idle for 10 minutes to
be closed. Note that MaxIdle will not have an effect if it is equal to
MaxOpen.

<p>

Setting MaxIdle to 0 makes it impossible for database handles to
become stale, unless the MaxOpen time expires.

<p>

MaxOpen

<p>

3600

<p>

The maximum length of time in seconds that a database connection
within this pool can remain open. It is recommended that MaxOpen be a
multiple of MaxIdle; otherwise, MaxOpen may be off by as much as
(MaxOpen mod MaxIdle).

<p>

The default setting causes all connections to be closed after one
hour, regardless of activity level. Database pool connections will
then be opened again as needed up to the value of the Connections
parameter.

<p>

Setting MaxOpen to 0 makes it impossible for database handles to
become stale when they are not idle.

<p>

Password

<p>

Password to log into the database.

<p>

User

<p>

Username to log into the database.

<p>

Verbose

<p>

off

<p>

Boolean value. If set to On, all SQL statements executed against this
pool are written to the server log. Errors, connects, and disconnects
are also logged. If set to Off, SQL statements are not written to the
server log.

<p>

At no point is the same SQL statement written to the log twice, even
if Verbose is On, LogSQLErrors is On, and the statement causes an
error.

<p>

Note: Setting Verbose may result in a large amount of output in the
server log file.

<p>

 CGI Interpreters and Environment

<p>

 ns/interps/interps-name

<p>

This section allows you to configure an interps section that can be
used by CGI modules loaded into any of the servers..

<p>

Parameter

<p>

Default Value

<p>

Description

<p>

file-extension

<p>

program(environment)

<p>

A CGI interpreter definition used by a CGI module. The environment is
optional and specifies a section of environment variables to set in
addition to the CGI variables before executing the interpreter
program. For example:

<pre>
.pl "c:\perl\bin\perl.exe"
.sh "c:\mks\mksnt\sh.exe(MKSenv"
</pre>

<p>

In this case, Perl will be invoked to interpret CGI scripts which end
in .pl; the variables in the ns/environment/mksenv section will be set
before the MKS Bourne shell is invoked to interpret CGI scripts which
end in .sh.

<p>

To enable this section to be used by a specific CGI module, use the
Interps parameter of the CGI module.

<p>

 ns/environment/environment-name

<p>

This section allows you to configure an environment section that can
be used by CGI modules loaded into any of the servers..

<p>

Parameter

<p>

Default Value

<p>

Description

<p>

variable

<p>

definition

<p>

An environment variable definition used by a CGI module. To enable
this section to be used by a specific CGI module, use the Environment
parameter of the CGI module or add the optional environment name in
the definition of a CGI interpreter.

<p>

 SGI IRIX Sproc-Based Threads

<p>

 ns/threads

<p>

This section allows you to configure sproc-based threads available on
IRIX 5.3 or 6.2 (not the pthreads-based approach available on IRIX
6.2).

<p>

Note that these parameters are provided for advanced IRIX users who
need to fine-tune their system..

<p>

  Parameter

<p>

Default Value

<p>

Description

<p>

InitSize

<p>

262144

<p>

The SGI arena size in bytes (minimum is 32768).

<p>

InitUsers

<p>

100

<p>

Maximum number of users for the SGI arena (miminum is 10; maximum is
1500).

<p>

MaxTLS

<p>

200

<p>

Maximum number of thread-local storage variables.

<p>

PoolTrace

<p>

File specification where debugging output of memory pools should be
written.

<p>

StackSize

<p>

65536

<p>

Starting stack size for each thread. This value overrides the
StackSize parameter in the ns/parameters section.

<p>



</body>
</html>

