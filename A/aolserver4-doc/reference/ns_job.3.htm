<!-- Creator     : groff version 1.21 -->
<!-- CreationDate: Sat May  5 10:27:42 2012 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>ns_job</title>

</head>
<body>

<h1 align="center">ns_job</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#OPTIONS">OPTIONS</a><br>
<a href="#BUGS">BUGS</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#KEYWORDS">KEYWORDS</a><br>

<hr>



<p style="margin-top: 1em">______________________________________________________________________________</p>

<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">ns_job &minus;
commands</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>ns_job</b>
option ?<i>arg arg ...</i>?</p>

<p style="margin-left:11%; margin-top: 1em"><b>ns_job</b>
create <i>?-desc description? queueId ?maxthreads?</i></p>

<p style="margin-left:11%; margin-top: 1em"><b>ns_job</b>
queue <i>?-detached? queueId script</i></p>

<p style="margin-left:11%; margin-top: 1em"><b>ns_job</b>
wait <i>?-timeout seconds:microseconds? queueId
jobId</i></p>

<p style="margin-left:11%; margin-top: 1em"><b>ns_job</b>
waitany <i>?-timeout seconds:microseconds? queueId</i></p>

<p style="margin-left:11%; margin-top: 1em"><b>ns_job</b>
cancel <i>queueId jobId</i></p>

<p style="margin-left:11%; margin-top: 1em"><b>ns_job</b>
delete <i>queueId</i></p>

<p style="margin-left:11%; margin-top: 1em"><b>ns_job</b>
jobs <i>queueId</i></p>

<p style="margin-left:11%; margin-top: 1em"><b>ns_job</b>
queues</p>

<p style="margin-left:11%; margin-top: 1em"><b>ns_job</b>
threadlist</p>

<p style="margin-left:11%; margin-top: 1em"><b>ns_job</b>
queuelist</p>

<p style="margin-left:11%; margin-top: 1em"><b>ns_job</b>
joblist</p>

<p style="margin-left:11%; margin-top: 1em"><b>ns_job</b>
genid
_________________________________________________________________</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">ns_job manages
a thread pool and a set of named &quot;queues&quot;. Queues
have a max number of threads and when the current number of
running thread reaches &quot;max&quot; then jobs are
queued.</p>

<p style="margin-left:11%; margin-top: 1em">New threads are
created when there are less than <i>maxthread</i> number of
idle threads.</p>

<h2>OPTIONS
<a name="OPTIONS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>create</b></p>

<p style="margin-left:22%; margin-top: 1em">create
<i>?-desc description? queueId ?maxthreads?</i></p>

<p style="margin-left:22%; margin-top: 1em">Create a new
job queue called <i>queueId</i>. If <i>maxthreads</i> is not
specified, then the default of 4 is used.</p>


<p style="margin-left:11%; margin-top: 1em"><b>queue</b></p>

<p style="margin-left:22%; margin-top: 1em">queue
<i>?-detached? queueId script</i></p>

<p style="margin-left:22%; margin-top: 1em">Add a new job
to the queue. If there are less than <i>maxthreads</i>
current running then the job will be started. If there are
<i>maxthreads</i> currently running then this new job will
be queued.</p>

<p style="margin-left:22%; margin-top: 1em">If
<i>detached</i> is true, then the job will be cleaned up
when it completes; no wait will be necessary.</p>

<p style="margin-left:22%; margin-top: 1em">The new
job&rsquo;s ID is returned.</p>


<p style="margin-left:11%; margin-top: 1em"><b>wait</b></p>

<p style="margin-left:22%; margin-top: 1em">wait
<i>?-timeout seconds:microseconds? queueId jobId</i></p>

<p style="margin-left:22%; margin-top: 1em">Wait for the
specified queued or running job to finish. <i>wait</i>
returns the results of the script.</p>

<p style="margin-left:22%; margin-top: 1em">An error is
thrown if the specified timeout period is reached.</p>


<p style="margin-left:11%; margin-top: 1em"><b>waitany</b></p>

<p style="margin-left:22%; margin-top: 1em">waitany
<i>?-timeout seconds:microseconds? queueId</i></p>

<p style="margin-left:22%; margin-top: 1em">Wait for any
job on the queue complete.</p>

<p style="margin-left:22%; margin-top: 1em">An error is
thrown if the specified timeout period is reached.</p>


<p style="margin-left:11%; margin-top: 1em"><b>cancel</b></p>

<p style="margin-left:22%; margin-top: 1em">cancel
<i>queueId jobId</i></p>

<p style="margin-left:22%; margin-top: 1em">Remove the
specified job from the queue. If the job is currently
running, then the job will be removed from the queue when it
completes.</p>

<p style="margin-left:22%; margin-top: 1em"><i>1 (true)</i>
is returned if the job is currently running and can not be
cancelled.</p>


<p style="margin-left:11%; margin-top: 1em"><b>delete</b></p>

<p style="margin-left:22%; margin-top: 1em">delete
<i>queueId</i></p>

<p style="margin-left:22%; margin-top: 1em">Request that
the specified queue be deleted. The queue will only be
deleted when all jobs are removed.</p>


<p style="margin-left:11%; margin-top: 1em"><b>jobs</b></p>

<p style="margin-left:22%; margin-top: 1em">jobs
<i>queueId</i></p>

<p style="margin-left:22%; margin-top: 1em">Return a list
of the job IDs.</p>


<p style="margin-left:11%; margin-top: 1em"><b>queues</b></p>

<p style="margin-left:22%; margin-top: 1em">Returns a list
of the queues IDs.</p>


<p style="margin-left:11%; margin-top: 1em"><b>threadlist</b></p>

<p style="margin-left:22%; margin-top: 1em">Returns a list
of the thread pool&rsquo;s fields.</p>

<p style="margin-left:22%; margin-top: 1em">maxthreads</p>

<p style="margin-left:32%;">Max number of threads for all
the queues in the thread pool.</p>

<p style="margin-left:22%; margin-top: 1em">numthreads</p>

<p style="margin-left:32%;">Number of allocated
threads.</p>

<p style="margin-left:22%; margin-top: 1em">numidle</p>

<p style="margin-left:32%;">Number of currently idle
threads.</p>

<p style="margin-left:22%; margin-top: 1em">req</p>

<p style="margin-left:32%;">stop</p>

<p style="margin-left:43%;">The thread pools is being
stopped. This probably means that the server is shutting
down.</p>


<p style="margin-left:11%; margin-top: 1em"><b>queuelist</b></p>

<p style="margin-left:22%; margin-top: 1em">Returns a list
of the queues. A queue has the following fields:</p>

<p style="margin-left:22%; margin-top: 1em">name</p>

<p style="margin-left:32%;">Name of the queue.</p>

<p style="margin-left:22%; margin-top: 1em">desc</p>

<p style="margin-left:32%;">Description of the queue.</p>

<p style="margin-left:22%; margin-top: 1em">maxthreads</p>

<p style="margin-left:32%;">Max number of threads to run
for this queue.</p>

<p style="margin-left:22%; margin-top: 1em">numrunning</p>

<p style="margin-left:32%;">Number of currently running
jobs in this queue.</p>

<p style="margin-left:22%; margin-top: 1em">REQ</p>

<p style="margin-left:32%;">delete</p>

<p style="margin-left:43%;">Someone requested this queue be
deleted. Queue will not be deleted until all the jobs on the
queue are removed.</p>


<p style="margin-left:11%; margin-top: 1em"><b>joblist</b></p>

<p style="margin-left:22%; margin-top: 1em">Returns a list
the jobs in the specified queue. A job has the following
fields:</p>

<p style="margin-left:22%; margin-top: 1em">id</p>

<p style="margin-left:32%;">Job&rsquo;s ID</p>

<p style="margin-left:22%; margin-top: 1em">state</p>

<p style="margin-left:32%;">scheduled</p>

<p style="margin-left:43%;">The job is schedule to run.</p>

<p style="margin-left:32%;">running</p>

<p style="margin-left:43%;">The job is currently
running.</p>

<p style="margin-left:32%;">done</p>

<p style="margin-left:43%;">The job is has completed.</p>

<p style="margin-left:22%; margin-top: 1em">results</p>

<p style="margin-left:32%;">If the job has completed, then
this field will contain the results. If the job is running
or scheduled to run, then this will contain the script.</p>

<p style="margin-left:22%; margin-top: 1em">code</p>

<p style="margin-left:32%;">When the job is done, this will
contain the return code.</p>

<p style="margin-left:43%;">Codes</p>

<p style="margin-left:54%;">TCL_OK <br>
TCL_ERROR <br>
TCL_RETURN <br>
TCL_BREAK <br>
TCL_CONTINUE</p>

<p style="margin-left:22%; margin-top: 1em">TYPE</p>

<p style="margin-left:32%;">nondetached <br>
detached</p>

<p style="margin-left:22%; margin-top: 1em">REQ</p>

<p style="margin-left:32%;">none <br>
wait <br>
cancel</p>


<p style="margin-left:11%; margin-top: 1em"><b>genid</b></p>

<p style="margin-left:22%; margin-top: 1em">Generate a new
unique ID. This new ID can be used as the queue ID without
conflicting with any other queue ID.</p>

<h2>BUGS
<a name="BUGS"></a>
</h2>


<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">nsd(1),
info(n)</p>

<h2>KEYWORDS
<a name="KEYWORDS"></a>
</h2>

 
<p style="margin-left:11%; margin-top: 1em">ns_job</p>
<hr>
</body>
</html>
