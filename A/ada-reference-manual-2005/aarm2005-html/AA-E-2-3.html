<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<HTML>
<HEAD>
    <TITLE>Remote Call Interface Library Units</TITLE>
    <META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
    <META NAME="Author" CONTENT="JTC1/SC22/WG9/ARG, by Randall Brukardt, ARG Editor">
    <META NAME="GENERATOR" CONTENT="Arm_Form.Exe, Ada Reference Manual generator">
    <STYLE type="text/css">
    H4.centered {text-align: center}
    SPAN.swiss {font-family: Arial, Helvetica, sans-serif; font-size: 92%}
    SPAN.roman {font-family: "Times New Roman", Times, serif}
    DIV.paranum {float: left; font-family: Arial, Helvetica, sans-serif; font-size: 64%; width: 2.8em; margin-left: -0.4em; margin-right: -3.0em; margin-top: 0.2em}
    TT {font-family: "Courier New", monospace}
    DT {display: compact}
    DIV.Normal {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 1.2em; margin-bottom: 0.6em}
    DIV.Indented1 {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 3.2em; margin-bottom: 0.6em}
    DIV.Annotations {font-family: "Times New Roman", Times, serif; font-size: 80%; line-height: 122%; margin-left: 6.2em; margin-bottom: 0.6em}
    DIV.Bulleted-NoPrefix {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 3.2em; margin-right: 2.0em; margin-top: 0em; margin-bottom: 0.5em}
    DIV.Bulleted {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 3.2em; margin-right: 2.0em; margin-top: 0em; margin-bottom: 0.5em; display: list-item; list-style-type: disc}
    </STYLE>
</HEAD>
<BODY TEXT="#000000" BGCOLOR="#FFFFF0" LINK="#000080" VLINK="#330033" ALINK="#0000FF">
<DIV><B><SPAN Style="font-size:200%; color: rgb(0,51,153)">Annotated</SPAN><SPAN Style="font-size:200%; color: rgb(0,0,102)">&nbsp;Ada Reference Manual</SPAN></B> &mdash; <A HREF="AA-TTL.html"><B>Legal Information</B></A></DIV>
<div style="margin-top: 0.6em; margin-bottom: 0.0em"><A HREF="AA-TOC.html"><IMG SRC="cont.gif" ALT="Contents" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-0-5.html"><IMG SRC="index.gif" ALT="Index" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-STDS.html"><IMG SRC="lib.gif" ALT="References" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-SRCH.html"><IMG SRC="find.gif" ALT="Search" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-E-2-2.html"><IMG SRC="prev.gif" ALT="Previous" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-E-3.html"><IMG SRC="next.gif" ALT="Next" BORDER=0></A>&nbsp;
</div>
<HR>
<H1>E.2.3 Remote Call Interface Library Units</H1>
<div class="paranum">1</div>
<div class="Normal">[A remote call interface library unit can be used 
as an interface for remote procedure calls (RPCs) (or remote function 
calls) between active partitions.]&nbsp;</div>

<H4 Class="centered">Language Design Principles</H4>
<div class="paranum">1.a</div>
<div class="Annotations">The restrictions governing a remote call interface 
library unit are intended to ensure that the values of the actual parameters 
in a remote call can be meaningfully sent between two active partitions. 
</div>

<H4 Class="centered">Syntax</H4>
<div class="paranum">2</div>
<div class="Indented1" style="margin-bottom: 0.4em"><SPAN STYLE="font-size: 80%">{<I>categorization 
pragma (Remote_Call_Interface)</I> [partial]}</SPAN> <A NAME="I7569"></A><SPAN STYLE="font-size: 80%">{<I>pragma, 
categorization (Remote_Call_Interface)</I> [partial]}</SPAN> <A NAME="I7570"></A>The 
form of a <SPAN Class="swiss"><A HREF="AA-2-8.html#S0019">pragma</A></SPAN> 
Remote_Call_Interface is as follows:&nbsp;</div>
<div class="paranum">3</div>
<div class="Indented1">&nbsp;&nbsp;<B>pragma</B> <A NAME="I7571"></A><A NAME="I7572"></A>Remote_Call_Interface[(<I>library_unit_</I><A NAME="I7573"></A><SPAN Class="swiss"><A HREF="AA-4-1.html#S0091">name</A></SPAN>)];</div>
<div class="paranum">4</div>
<div class="Indented1" style="margin-bottom: 0.4em">The form of a <SPAN Class="swiss"><A HREF="AA-2-8.html#S0019">pragma</A></SPAN> 
All_Calls_Remote is as follows:&nbsp;</div>
<div class="paranum">5</div>
<div class="Indented1">&nbsp;&nbsp;<B>pragma</B> <A NAME="I7574"></A><A NAME="I7575"></A>All_Calls_Remote[(<I>library_unit_</I><A NAME="I7576"></A><SPAN Class="swiss"><A HREF="AA-4-1.html#S0091">name</A></SPAN>)];</div>
<div class="paranum">6</div>
<div class="Indented1"><SPAN STYLE="font-size: 80%">{<I>library unit 
pragma (All_Calls_Remote)</I> [partial]}</SPAN> <A NAME="I7577"></A><SPAN STYLE="font-size: 80%">{<I>pragma, 
library unit (All_Calls_Remote)</I> [partial]}</SPAN> <A NAME="I7578"></A>A 
<SPAN Class="swiss"><A HREF="AA-2-8.html#S0019">pragma</A></SPAN> All_Calls_Remote 
is a library unit pragma.&nbsp;</div>

<H4 Class="centered">Legality Rules</H4>
<div class="paranum">7/1</div>
<div class="Normal">{<I><A HREF="defect1.html#8652/0078">8652/0078</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00048.TXT">AI95-00048-01</A></I>} 
<SPAN STYLE="font-size: 80%">{<I>remote call interface</I>}</SPAN> <A NAME="I7579"></A><SPAN STYLE="font-size: 80%">{<I>RCI 
(library unit)</I>}</SPAN> <A NAME="I7580"></A><SPAN STYLE="font-size: 80%">{<I>RCI 
(package)</I>}</SPAN> <A NAME="I7581"></A><SPAN STYLE="font-size: 80%">{<I>RCI 
(generic)</I>}</SPAN> <A NAME="I7582"></A><SPAN STYLE="font-size: 80%">{<I>remote 
subprogram</I>}</SPAN> <A NAME="I7583"></A>A <I>remote call interface 
(RCI)</I> is a library unit to which the pragma Remote_Call_Interface 
applies. A subprogram declared in the visible part of such a library 
unit, or declared by such a library unit, is called a <I>remote subprogram</I>.</div>
<div class="paranum">8</div>
<div class="Normal">The declaration of an RCI library unit shall be preelaborable 
(see <A HREF="AA-10-2-1.html">10.2.1</A>), and shall depend semantically 
only upon declared pure, shared passive, remote types, or other remote 
call interface library units.</div>
<div class="paranum">9/1</div>
<div class="Normal" style="margin-bottom: 0.4em">{<I><A HREF="defect1.html#8652/0078">8652/0078</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00048.TXT">AI95-00048-01</A></I>} 
In addition, the following restrictions apply to an RCI library unit: 
</div>
<div class="paranum">10/1</div>
<div class="Bulleted">{<I><A HREF="defect1.html#8652/0078">8652/0078</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00048.TXT">AI95-00048-01</A></I>} 
its visible part shall not contain the declaration of a variable;&nbsp;</div>
<div class="paranum">10.a/1</div>
<div class="Annotations"><B>Reason:&nbsp;</B>{<I><A HREF="defect1.html#8652/0078">8652/0078</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00048.TXT">AI95-00048-01</A></I>} 
Remote call interface units do not provide remote data access. A shared 
passive package has to be used for that.&nbsp;</div>
<div class="paranum">11/1</div>
<div class="Bulleted">{<I><A HREF="defect1.html#8652/0078">8652/0078</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00048.TXT">AI95-00048-01</A></I>} 
its visible part shall not contain the declaration of a limited type; 
</div>
<div class="paranum">11.a/2</div>
<div class="Annotations"><B>Reason:&nbsp;</B>{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00240.TXT">AI95-00240-01</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00366.TXT">AI95-00366-01</A></I>} 
We disallow the declaration of task and protected types, since calling 
an entry or a protected subprogram implicitly passes an object of a limited 
type (the target task or protected object). We disallow other limited 
types since we require that such types have available Read and Write 
attributes, but we certainly don't want the Read and Write attributes 
themselves to involve remote calls (thereby defeating their purpose of 
marshalling the value for remote calls).&nbsp;</div>
<div class="paranum">12/1</div>
<div class="Bulleted">{<I><A HREF="defect1.html#8652/0078">8652/0078</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00048.TXT">AI95-00048-01</A></I>} 
its visible part shall not contain a nested <SPAN Class="swiss"><A HREF="AA-12-1.html#S0252">generic_declaration</A></SPAN>; 
</div>
<div class="paranum">12.a</div>
<div class="Annotations"><B>Reason:&nbsp;</B>This is disallowed because the 
body of the nested generic would presumably have access to data inside 
the body of the RCI package, and if instantiated in a different partition, 
remote data access might result, which is not supported.&nbsp;</div>
<div class="paranum">13/1</div>
<div class="Bulleted">{<I><A HREF="defect1.html#8652/0078">8652/0078</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00048.TXT">AI95-00048-01</A></I>} 
it shall not be, nor shall its visible part contain, the declaration 
of a subprogram to which a pragma Inline applies;</div>
<div class="paranum">14/2</div>
<div class="Bulleted">{<I><A HREF="defect1.html#8652/0078">8652/0078</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00048.TXT">AI95-00048-01</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00240.TXT">AI95-00240-01</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00366.TXT">AI95-00366-01</A></I>} 
it shall not be, nor shall its visible part contain, a subprogram (or 
access-to-subprogram) declaration whose profile has [an access parameter 
or] a parameter of a type that does not support external streaming (see 
<A HREF="AA-13-13-2.html">13.13.2</A>);</div>
<div class="paranum">15</div>
<div class="Bulleted">any public child of the library unit shall be a 
remote call interface library unit.&nbsp;</div>
<div class="paranum">15.a</div>
<div class="Annotations"><B>Reason:&nbsp;</B>No restrictions apply to the 
private part of an RCI package, and since a public child can &ldquo;see&rdquo; 
the private part of its parent, such a child must itself have a Remote_Call_Interface 
pragma, and be assigned to the same partition (see below).&nbsp;</div>
<div class="paranum">15.b</div>
<div class="Annotations"><B>Discussion:&nbsp;</B>We considered making the 
public child of an RCI package implicitly RCI, but it seemed better to 
require an explicit pragma to avoid any confusion.</div>
<div class="paranum">15.c</div>
<div class="Annotations">Note that there is no need for a private child 
to be an RCI package, since it can only be seen from the body of its 
parent or its siblings, all of which are required to be in the same active 
partition.&nbsp;</div>
<div class="paranum">16</div>
<div class="Normal">If a pragma All_Calls_Remote applies to a library 
unit, the library unit shall be a remote call interface.&nbsp;</div>

<H4 Class="centered">Post-Compilation Rules</H4>
<div class="paranum">17</div>
<div class="Normal">A remote call interface library unit shall be assigned 
to at most one partition of a given program. A remote call interface 
library unit whose parent is also an RCI library unit shall be assigned 
only to the same partition as its parent.&nbsp;</div>
<div class="paranum">17.a/1</div>
<div class="Annotations"><B>Implementation Note:&nbsp;</B>{<I><A HREF="defect1.html#8652/0078">8652/0078</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00048.TXT">AI95-00048-01</A></I>} 
The declaration of an RCI unit, with a calling-stub body, is automatically 
included in all active partitions with compilation units that depend 
on it. However the whole RCI library unit, including its (non-stub) body, 
will only be in one of the active partitions.&nbsp;</div>
<div class="paranum">18</div>
<div class="Normal"><SPAN STYLE="font-size: 80%">{<I>compilation units 
needed (remote call interface)</I> [partial]}</SPAN> <A NAME="I7584"></A><SPAN STYLE="font-size: 80%">{<I>needed 
(remote call interface)</I> [partial]}</SPAN> <A NAME="I7585"></A><SPAN STYLE="font-size: 80%">{<I>notwithstanding</I>}</SPAN> 
<A NAME="I7586"></A>Notwithstanding the rule given in <A HREF="AA-10-2.html">10.2</A>, 
a compilation unit in a given partition that semantically depends on 
the declaration of an RCI library unit, <I>needs</I> (in the sense of 
<A HREF="AA-10-2.html">10.2</A>) only the declaration of the RCI library 
unit, not the body, to be included in that same partition. [Therefore, 
the body of an RCI library unit is included only in the partition to 
which the RCI library unit is explicitly assigned.]</div>

<H4 Class="centered">Implementation Requirements</H4>
<div class="paranum">19/1</div>
<div class="Normal">&nbsp;{<I><A HREF="defect1.html#8652/0078">8652/0078</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00048.TXT">AI95-00048-01</A></I>} 
If a pragma All_Calls_Remote applies to a given RCI library unit, then 
the implementation shall route any call to a subprogram of the RCI unit 
from outside the declarative region of the unit through the Partition 
Communication Subsystem (PCS); see <A HREF="AA-E-5.html">E.5</A>. Calls 
to such subprograms from within the declarative region of the unit are 
defined to be local and shall not go through the PCS.&nbsp;</div>
<div class="paranum">19.a/1</div>
<div class="Annotations"><B>Discussion:&nbsp;</B>{<I><A HREF="defect1.html#8652/0078">8652/0078</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00048.TXT">AI95-00048-01</A></I>} 
Without this pragma, it is presumed that most implementations will make 
direct calls if the call originates in the same partition as that of 
the RCI unit. With this pragma, all calls from outside the subsystem 
rooted at the RCI unit are treated like calls from outside the partition, 
ensuring that the PCS is involved in all such calls (for debugging, redundancy, 
etc.).&nbsp;</div>
<div class="paranum">19.b</div>
<div class="Annotations"><B>Reason:&nbsp;</B>There is no point to force local 
calls (or calls from children) to go through the PCS, since on the target 
system, these calls are always local, and all the units are in the same 
active partition.&nbsp;</div>

<H4 Class="centered">Implementation Permissions</H4>
<div class="paranum">20</div>
<div class="Normal">An implementation need not support the Remote_Call_Interface 
pragma nor the All_Calls_Remote pragma. [Explicit message-based communication 
between active partitions can be supported as an alternative to RPC.] 
</div>
<div class="paranum">20.a</div>
<div class="Annotations"><B>Ramification:&nbsp;</B>Of course, it is pointless 
to support the All_Calls_Remote pragma if the Remote_Call_Interface pragma 
(or some approximate equivalent) is not supported.&nbsp;</div>

<H4 Class="centered">Incompatibilities With Ada 95</H4>
<div class="paranum">20.b/2</div>
<div class="Annotations">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00240.TXT">AI95-00240-01</A></I>} 
{<I>incompatibilities with Ada 95</I>} <A NAME="I7587"></A><B>Amendment 
Correction:</B> The wording was changed from &ldquo;user-specified&rdquo; 
to &ldquo;available&rdquo; attributes. (This was then further changed, 
see below.) This means that a type with the attributes specified in the 
private part would originally have been allowed as a formal parameter 
of an RCI subprogram, but that is no longer allowed. This change was 
made so that the rules were consistent with the rules introduced for 
the Corrigendum for stream attributes; moreover, legality should not 
depend on the contents of the private part.&nbsp;</div>

<H4 Class="centered">Wording Changes from Ada 95</H4>
<div class="paranum">20.c/2</div>
<div class="Annotations">{<I><A HREF="defect1.html#8652/0078">8652/0078</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00048.TXT">AI95-00048-01</A></I>} 
<B>Corrigendum:</B> Changed the wording to allow a library subprogram 
to be a remote call interface unit.</div>
<div class="paranum">20.d/2</div>
<div class="Annotations">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00366.TXT">AI95-00366-01</A></I>} 
Changed the wording to use the newly defined term <I>type that supports 
external streaming</I>, so that various issues with access types in pure 
units and implicitly declared attributes for type extensions are properly 
handled.&nbsp;</div>

<HR>
<div style="margin-top: 0.0em; margin-bottom: 0.6em"><A HREF="AA-TOC.html"><IMG SRC="cont.gif" ALT="Contents" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-0-5.html"><IMG SRC="index.gif" ALT="Index" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-STDS.html"><IMG SRC="lib.gif" ALT="References" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-SRCH.html"><IMG SRC="find.gif" ALT="Search" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-E-2-2.html"><IMG SRC="prev.gif" ALT="Previous" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-E-3.html"><IMG SRC="next.gif" ALT="Next" BORDER=0></A>&nbsp;
</div>
<DIV Style="margin-top:0.0em"><IMG SRC="AE_logo.gif" height=100 width=113 align=right ALT="Ada-Europe">
<SPAN Style="font-size: 125%">Sponsored by <SPAN Style="font-size: 125%"><A HREF="http://www.ada-europe.org/"><B>Ada-Europe</B></A></SPAN></SPAN></DIV>
</BODY>
</HTML>
